ogame.chat={socket:null,connected:!1,connecting:!1,timeout:null,retryInterval:5e3,playerId:null,associationId:null,data:{association:{}},playernames:{},playerList:null,isLoadingPlayerList:!1,playerListSelector:new Array,initConnection:function(){console.log("ogame.chat init");var e=ogame.chat;(e.connecting||e.connected||e.isMobile)&&e.socket.disconnect(),e.connecting=!0;try{e.socket=io.connect("/chat",nodeParams),e.socket.on("connect",function(){clearTimeout(this.timeout),e.socket.emit("authorize",session,function(t){e.connecting=!1,t?e.connected=!0:e.socket.disconnect()})}),e.socket.on("chat",function(t){e.messageReceived(t)}),e.socket.on("disconnect",function(){e.connected=!1,e.connecting=!1})}catch{e.connecting=!1}},initialize:function(){var e=ogame.chat;loadScript(nodeUrl,e.initConnection),$(".new_msg_count[data-playerid]").each(function(){e.saveMessageCounter($(this).data("new-messages"),$(this).data("playerid"))}),this.updateTotalNewChatCounter(),$(".js_playerlist").on("click",".playerlist_item",function(){var t=$(this).hasClass("nothingThere");if(!t){var a=$(this).data("msgid");a?e.loadChatLogWithPlayer(this,a):e.loadChatLogWithPlayer(this)}}),$(".js_playerlist").on("click",".openAssociationChat",function(){var t=$(this).data("msgid");t?e.loadChatLogWithAssociation(this,t):e.loadChatLogWithAssociation(this)}),$("#chatMsgList").on("click",".msg",function(){var t=$(this).data("playerid"),a=$(this).data("associationid");if(t!==void 0&&t>0){e.saveMessageCounter(0,t),ogame.messagemarker.setPartnerId(t),ogame.messagemarker.updateNewMarker(),ogame.chat.updateTotalNewChatCounter();var n=$(".playerlist .playerlist_item[data-playerId="+t+"]").data("msgid");n?e.loadChatLogWithPlayer(this,n):e.loadChatLogWithPlayer(this)}else{var n=$(".playerlist .playerlist_item[data-associationId="+a+"]").data("msgid");e.saveMessageCounterAssociation(0,a),n?e.loadChatLogWithAssociation(this,n):e.loadChatLogWithAssociation(this)}}),$(".chat").on("click",".sys_msg",function(t){var a=$(this).data("foreign-player-id"),n=$(this).data("foreign-association-id"),r={playerId:a,associationId:n,ajax:1};console.log("chatLoadMoreMessages()"),$.ajax({url:chatUrlLoadMoreMessages,type:"POST",dataType:"html",data:r,success:function(s){$(".chat").each(function(d,c){(a!==void 0&&a==$(c).data("foreign-player-id")||n!==void 0&&n==$(c).data("foreign-association-id"))&&$(c).html(s)})},error:function(s,d,c){}})}),$("body").on("click",".js_openChat",function(){e.loadChatLogWithPlayer(this)}),(typeof $.cookie("maximizeId")=="string"||typeof $.cookie("maximizeId")=="number")&&($('#chatMsgList .msg[data-playerid="'+$.cookie("maximizeId")+'"]').trigger("click"),$.cookie("maximizeId",null))},getTotalNewChatCounter:function(){return ogame.messagecounter.sumNewChatMessages},updateTotalNewChatCounter:function(){var e=0;return $(".msg .new_msg_count").length>0?$(".msg .new_msg_count").each(function(){e+=Number($(this).data("new-messages"))}):$("#chatBarPlayerList .new_msg_count").length>0&&$("#chatBarPlayerList .new_msg_count").each(function(){e+=Number($(this).data("new-messages"))}),ogame.messagecounter.initialize(ogame.messagecounter.type_chat,ogame.chat.playerId),ogame.messagecounter.sumNewChatMessages!==e&&(ogame.messagecounter.initChatCounter(e),ogame.messagecounter.sumNewChatMessages=e,ogame.messagecounter.update()),e},retryConnection:function(){var e=ogame.chat;setTimeout(function(){e.initConnection()},5e3)},sendMessage:function(e,t,a,n){var r=ogame.chat;if($.trim(a).length==0){o("TEXT_EMPTY");return}if(e>0)var s={playerId:e,text:a,mode:1,ajax:1};else var s={associationId:t,text:a,mode:3,ajax:1};typeof n<"u"&&typeof n.id<"u"&&(s.msg2reply=n.id);function d(){console.log("v()"),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:s,success:function(f){l(f)},error:function(f,h,u){}})}function c(f){typeof f.refAuthor<"u"&&typeof f.refContent<"u"?$refData={author:f.refAuthor,text:f.refContent}:$refData=0,f.targetId!==void 0?r.addChatItem(f.targetId,0,f.text,f.id,!1,$refData,f.date):r.addChatItem(e,f.targetAssociationId,f.text,f.id,!1,$refData,f.date)}function o(f){chatLoca[f]!==void 0?errorBoxNotify(LocalizationStrings.error,chatLoca[f],LocalizationStrings.ok):errorBoxNotify(LocalizationStrings.error,f,LocalizationStrings.ok)}function l(f){switch(f.status){case"NOT_AUTHORIZED":d();break;case"OK":c(f),ogame.chat.cleanupUrl();break;default:o(f.status)}}d()},messageReceived:function(e){var t=ogame.chat;if(typeof e.refAuthor<"u"&&typeof e.refText<"u"?$refData={author:e.refAuhtor,text:e.refText}:$refData=0,e.senderName!==void 0&&e.senderId!==void 0&&(t.playernames[e.senderId]=e.senderName),$(".chat_bar_list").length&&(e.associationId!==void 0&&e.associationId>0?t.data.association[e.associationId]===void 0?t.loadChatLogWithAssociation(e.associationId,null,function(){t.addChatItem(e.senderId,e.associationId,e.text,e.id,!0,$refData,e.date)},!1):t.addChatItem(e.senderId,e.associationId,e.text,e.id,!0,$refData,e.date):t.data[e.senderId]===void 0?t.loadChatLogWithPlayer(e.senderId,null,function(){t.addChatItem(e.senderId,0,e.text,e.id,!0,$refData,e.date)},!1):t.addChatItem(e.senderId,0,e.text,e.id,!0,$refData,e.date)),e.associationId!==void 0&&e.associationId>0)if($('.chat_bar_list_item.open[data-associationid="'+e.associationId+'"]').length<=0){var a=$('.new_msg_count[data-associationid="'+e.associationId+'"]').data("new-messages");isNaN(a)&&(a=0),a++,t.saveMessageCounterAssociation(a,e.associationId),t.updateTotalNewChatCounter()}else{var n={associationId:e.associationId,mode:4,ajax:1,updateUnread:1};console.log("chatUrl()"),$.ajax({url:chatUrl,type:"POST",data:n,success:function(r){},error:function(r,s,d){}})}else if(e.senderId!==void 0&&e.senderId>0)if(ogame.messagemarker.setPartnerId(e.senderId),t.isOpen(e.senderId))t.saveMessageCounter(0,$(this).data("playerid")),ogame.messagemarker.updateNewMarker();else{ogame.messagecounter.initialize(ogame.messagecounter.type_chat,e.senderId);var a=parseInt(ogame.messagecounter.newChats[e.senderId]);isNaN(a)&&(a=0),a++,t.saveMessageCounter(a,e.senderId),ogame.messagemarker.updateNewMarker()}},cleanupUrl:function(){var e=window.location.href,t=e.indexOf("&");if(t>0){var a=e.indexOf("?"),n=e.substring(0,a),r=n+"?page=chat";window.history.pushState({},"",r)}},saveMessageCounter:function(e,t){if(isNaN(t)||t===0)return!1;$('.new_msg_count[data-playerid="'+t+'"]').data("new-messages",e),ogame.messagecounter.newChats[t]=e},saveMessageCounterAssociation:function(e,t){if(isNaN(t)||t===0)return!1;$('.new_msg_count[data-associationid="'+t+'"]').data("new-messages",e),$('.new_msg_count[data-associationid="'+t+'"]').text(e),ogame.messagemarker.updateNewMarker()},isOpen:function(e){var t=!1,a=$(".chatContent").data("chatplayerid");return a!="undefined"&&a==e?t=!0:$(".chat_box").each(function(){$(this).attr("data-playerid")==e&&$(this).css("display")=="block"&&(t=!0)}),t},loadChatLogWithPlayer:function(e,t,a,n){var r=ogame.chat,s;typeof n>"u"&&(n=!0),typeof e=="number"?s=e:s=$(e).attr("data-playerId");var d={playerId:s,mode:2,ajax:1,updateUnread:n?1:0};typeof t=="number"&&(d.msg2reply=t),console.log("chatUrl POST()"),$.ajax({url:chatUrl,type:"POST",data:d,success:function(c){c=JSON.parse(c),r.data[c.playerId]={playerstatus:c.playerstatus,playerName:c.playerName,playerId:c.playerId,chatItems:c.chatItems,chatItemsByDateAsc:c.chatItemsByDateAsc},typeof a=="function"?a():$(e).parents("#chatBarPlayerList").length||$("body")[0].id!="chat"?r.showChat(c):r.showChatHistory(c);var o=$(".chat_bar_list").find("[data-playerid='"+c.playerId+"']");r.updateCustomScrollbar(o.find(".chat_box_ctn"))},error:function(c,o,l){}})},loadChatLogWithAssociation:function(e,t,a,n){var r=ogame.chat,s;typeof n>"u"&&(n=!0),typeof e=="number"?s=e:s=$(e).attr("data-associationid");var d={associationId:s,mode:4,ajax:1,updateUnread:n?1:0};typeof t=="number"&&(d.msg2reply=t),console.log("chaturl POST()"),$.ajax({url:chatUrl,type:"POST",data:d,success:function(c){c=JSON.parse(c),r.data.association[c.associationId]={playerstatus:c.playerstatus,associationName:c.associationName,associationId:c.associationId,chatItems:c.chatItems,chatItemsByDateAsc:c.chatItemsByDateAsc},typeof a=="function"?a():$(e).parents("#chatBarPlayerList").length||$("body")[0].id!="chat"?r.showChat(c):r.showChatHistory(c);var o=$(".chat_bar_list").find("[data-associationid='"+c.associationId+"']");r.updateCustomScrollbar(o.find(".chat_box_ctn"))},error:function(c,o,l){}})},initChat:function(e,t){ogame.chat.playerId=e,ogame.chat.isMobile=t,ogame.chat.initPlayerlist(),ogame.chat.initialize(),ogame.chat.toggleVisibility(),ogame.chat.setVisibilityState(),ogame.chat.initMaximize(),ogame.chat.getInMaxChat()},getLastChatItemData:function(){ogame.chat;var e=null;if($(".chat_box_ctn .mCustomScrollBox .mCSB_container").each(function(){var r=$(this).children("ul.chat").children("li:last");(e===null||r.attr("data-chat-id")>e.attr("data-chat-id"))&&(e=r)}),e===null&&$("ul.largeChat").each(function(){var r=$(this).children("li:last");(e===null||r.attr("data-chat-id")>e.attr("data-chat-id"))&&(e=r)}),e===null)return null;var t=e.children(".msg_head").find(".msg_date").html(),a=e.find(".msg_content").html(),n={date:t,text:a};return n},addChatItem:function(e,t,a,n,r,s,d){var c=ogame.chat,o;t>0?o=$(".chat_bar_list").find("[data-associationid='"+t+"']"):o=$(".chat_bar_list").find("[data-playerid='"+e+"']");var l={};if(l.date=d,l.newClass="new",r?(c.data[e]!==void 0?l.playerName=c.data[e].playerName:l.playerName=c.playernames[e],l.altClass=""):(l.playerName=playerName,l.altClass="odd"),l.chatID=n,l.chatContent=a,typeof s=="object"&&(l.refData=s),!o.length){var f=c.createChatBarContainer(e);c.updateChatBar(f),o=$(".chat_bar_list").find("[data-playerid='"+e+"']")}var h=c.createChatItem(l),u=c.getLastChatItemData();if(u!==null&&(l.date!=u.date||l.chatContent!=u.text)){o.find(".chat").append(h),c.updateCustomScrollbar(o.find(".chat_box_ctn"));var p=$(".js_chatHistory");p.length&&(p.data("chatplayerid")==e||p.data("associationid")==t)&&(p.find(".chat.clearfix").append(h.clone()),c.updateCustomScrollbar($(".largeChatContainer")))}},addToMoreBox:function(e){var t=ogame.chat,a=e.length;a&&$(".more_chat_bar_items").length<1&&$(".chat_bar_list").append(t.createMoreBox("more_chat_bar_items"));for(var n=$(".more_chat_bar_items .more_items"),r=$(".more_chat_bar_items .chat_box"),s=0;s<=a;s++)n.append(e.pop());t.updateCustomScrollbar(r)},createChatBarContainer:function(e){var t=ogame.chat;if(e){var a=t.data[e];t.data.playerId=e;var n=$('<li class="chat_bar_list_item open" data-playerid="'+e+'"></li>');return n.append('<span class="playerstatus '+a.playerstatus+'"></span>'),n.append('<span class="cb_playername">'+a.playerName+"</span>"),n.append('<span class="icon icon_close fright"></span>'),n.prepend(t.createChatBox(e)),n}},createChatBarContainerForAssociations:function(e){var t=ogame.chat;if(e){var a=t.data.association[e];t.data.associationId=e;var n=$('<li class="chat_bar_list_item open" data-associationId="'+e+'"></li>');return n.append('<span class="playerstatus '+a.playerstatus+'"></span>'),n.append('<span class="cb_playername">'+a.associationName+"</span>"),n.append('<span class="icon icon_close fright"></span>'),n.prepend(t.createChatBoxForAssociations(e)),n}},closeChatBox:function(e,t){var a=$(".chat_bar_list_item");$.each(a,function(n,r){(e!==void 0&&$(r).data("playerid")==e||t!==void 0&&$(r).data("associationid")==t)&&($(r).addClass("outOfChatbar"),$(r).removeClass("open"))})},getVisibleChats:function(){return typeof visibleChats>"u"&&(visibleChats={chatbar:!1,players:[],associations:[]}),visibleChats},getVisibleChatPlayerIds:function(){for(var e=ogame.chat,t=e.getVisibleChats(),a={},n=0,r=0;r<t.players.length;r++)$.inArray(t.players[r].partnerId,a)==-1&&(a[n]=t.players[r].partnerId,n++);return a},getVisibleChatAssociationIds:function(){for(var e=ogame.chat,t=e.getVisibleChats(),a={},n=0,r=0;r<t.associations.length;r++)$.inArray(t.associations[r].partnerId,a)==-1&&(a[n]=t.associations[r],n++);return a},setVisibilityState:function(){for(var e=ogame.chat,t=e.getVisibleChatPlayerIds(),a=e.getVisibleChatAssociationIds(),n=$("#chatBar .chat_bar_list .chat_bar_list_item"),r=0;r<n.length;r++){var s=n.get(r),d=$(s).data("playerid"),c=$(s).data("associationid");if(d!==void 0&&!e.isInJson(d,t))e.closeChatBox(d,0);else if(c!==void 0&&!e.isInJson(c,a))e.closeChatBox(0,c);else if(s.style.display="inline",$(s).hasClass("open")){var o=$(s).find("div.chat_box")[0];o.style.display="inline",e.updateCustomScrollbar($(s).find(".chat_box_ctn"),1)}}},isInJson:function(e,t){var a=null;return $.isEmptyObject(t)&&(a=!1),a!==!1&&$.each(t,function(n,r){r==e&&(a=!0)}),a},toggleVisibility:function(){$(".chat_bar_list_item .icon_close").on("click",function(e){var t=$(this).parent().data("playerid"),a=$(this).closest(".chat_box");a.length||(a=$(this).parent()[0],a.style.display="none"),t>0&&(console.log("toggleVisibilityChat()"),$.ajax({type:"POST",url:"/game/index.php?page=ajaxChatToggleVisibility",data:{from:playerId,to:t,showState:0},success:function(n){},error:function(n,r,s){}}))}),$(".cb_playerlist_box .playerlist_item").on("click",function(){var e=$(this).data("playerid");e&&(console.log("cb_playerlist_box()"),$.ajax({type:"POST",url:"/game/index.php?page=ajaxChatToggleVisibility",data:{from:playerId,to:e,showState:1},success:function(t){},error:function(t,a,n){}}))})},initMaximize:function(){$(".chat_bar_list").on("click.chatBar",".chat_box .chat_box_title .icon_maximize",function(){var e=$(this).parent(),t=$(e).parent().data("playerid");$.cookie("maximizeId",t),$(".chat_bar_list_item.open .chat_box_title .icon_close").trigger("click"),window.location=bigChatLink+"&playerId="+t})},getInMaxChat:function(){var e=location.href;typeof bigChatLink>"u"&&(bigChatLink=""),bigChatLink==e&&$.cookie("maximizeId")!==null&&$("#chatMsgList .msg[data-playerId="+$.cookie("maximizeId")+"]").trigger("click"),$.cookie("maximizeId",null)},createChatBox:function(e){var t=ogame.chat;if(e){var a=t.data[e],n=$('<div class="chat_box_title"></div>');n.append('<span class="icon icon_close fright"></span>'),n.append('<span class="icon icon_maximize fright"></span>');for(var r=$('<div class="chat_box_ctn"><ul class="chat clearfix"></ul></div>'),s={},d=0;d<a.chatItemsByDateAsc.length;d++)s=a.chatItems[a.chatItemsByDateAsc[d]],r.find(".chat").append(t.createChatItem(s));var c=$('<div class="chat_box" data-playerid="'+e+'"></div>');return c.append(n),c.append(r),c.append('<textarea name="text" class="chat_box_textarea"></textarea>'),c}},createChatBoxForAssociations:function(e){var t=ogame.chat;if(e){var a=t.data.association[e],n=$('<div class="chat_box_title"></div>');n.append('<span class="icon icon_close fright"></span>'),n.append('<span class="icon icon_maximize fright"></span>');for(var r=$('<div class="chat_box_ctn"><ul class="chat clearfix"></ul></div>'),s={},d=0;d<a.chatItemsByDateAsc.length;d++)s=a.chatItems[a.chatItemsByDateAsc[d]],r.find(".chat").append(t.createChatItem(s));var c=$('<div class="chat_box" data-associationId="'+e+'"></div>');return c.append(n),c.append(r),c.append('<textarea name="text" class="chat_box_textarea"></textarea>'),c}},createChatItem:function(e){if(!e){console.warn("no chatItem given");return}var t=$('<div class="msg_head"></div>');t.append('<span class="msg_date fright">'+getFormatedDate(e.date,"[d].[m].[Y] <span>[H]:[i]:[s]</span>")+"</span>"),t.append('<span class="msg_title blue_txt '+e.newClass+'">'+e.playerName+"</span>");var a=$('<li class="chat_msg '+e.altClass+'" data-chat-id="'+e.chatID+'"></li>');if(a.append(t),typeof e.refData<"u"){var n=$('<div class="referenceMsg"></div>'),r='<div class="refAuthor">'+e.refData.author+"</div>",s='<div class="refText new">'+e.refData.text+"</div>";n.append(r),n.append(s),a.append(n)}return a.append('<span class="msg_content">'+e.chatContent+"</span>"),a.append('<div class="speechbubble_arrow"></div>'),a},createMoreBox:function(e){var t=$('<li class="chat_bar_list_item '+e+'">'+chatLoca.MORE_USERS+'<span class="icon icon_close fright"></span></li>');return t.prepend($('<div class="chat_box"><ul class="more_items clearfix"></ul></div>')),t},filterPlayerlist:function(){var e=[],t,a=$("#playerlistFilters").find('input[type="checkbox"]');if(a.each(function(){e.push($(this).attr("id"))}),$(".playerlist_item").show(),t=!1,a.each(function(){$(this).prop("checked")&&(t=!0)}),!!t){var n,r;$(".playerlist_item").filter(function(){n=!1,r=$(this),$.each(e,function(s,d){r.data(d)==="off"&&$("#"+d).prop("checked")&&(n=!0)}),n===!0?r.hide():r.show()})}},initChatBar:function(e){var t=ogame.chat;ogame.chat.playerId=e,$("html").off(".chatBar"),$(window).resize(function(){t.updateChatBar()}),$(".chat_bar_list").on("click.chatBar","#chatBarPlayerList",function(a){$(a.target).attr("id")!=="chatBarPlayerList"&&!$(a.target).hasClass("onlineCount")||($(".cb_playerlist_box").toggle(),t.updateCustomScrollbar($(".scrollContainer"),!0),console.log("initChatBar()"),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:{action:"toggleChatBar"},success:function(n){},error:function(n,r,s){}}))}).on("click.chatBar",".chat_bar_list_item",function(a){a.stopPropagation(),isNaN($(this).data("playerid"))?isNaN($(this).data("associationid")>0)||t.saveMessageCounterAssociation(0,$(this).data("associationid")):(ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chattab,$(this).data("playerid")),ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chatbar,$(this).data("playerid")),t.saveMessageCounter(0,$(this).data("playerid")),ogame.messagemarker.setPartnerId($(this).data("playerid")),ogame.messagemarker.updateNewMarker(),ogame.chat.updateTotalNewChatCounter()),console.log("chatUrl POST chatBarListRead()"),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:{playerId:$(this).data("playerid"),action:"chatBarListRead"},success:function(n){},error:function(n,r,s){}}),$(this).closest(".more_items").length?t.swapChatBarItem($(this)):t.toggleChatBox($(a.target),$(this)),t.updateVisibleState()}).on("click.chatBar",".chat_bar_list_item > .icon_close",function(a){a.stopPropagation();var n=$(this).closest(".chat_bar_list_item");ogame.chat.closeChatBox(n.attr("data-playerid"),n.attr("data-associationid")),n.remove("open"),t.updateChatBar()}).on("keyup.chatBar",".chat_box_textarea",function(a){if((a.ctrlKey||a.keyCode==10)&&a.keyCode==13){a.preventDefault();var n=$(this).val();$(this).val(n+`
`)}else $.trim($(this).val().length>0)&&(a.preventDefault(),t.submitChatBarMsg($(a.currentTarget),a.which,a.shiftKey,a.delegateTarget.scrollHeight))}).on("click.chatBar",".chat_box_textarea",function(a){ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chattab,$(this).parent().parent().parent().data("playerid")),ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chatbar,$(this).parent().parent().parent().data("playerid")),$(this).data("playerid")>0?t.saveMessageCounter(0,$(this).data("playerid")):$(this).data("associationid")>0&&t.saveMessageCounterAssociation(0,$(this).data("associationid"))})},initPlayerlist:function(){var e=ogame.chat,t=ogame.tools;$(".js_accordion").accordion({collapsible:!0,heightStyle:"content"}),$(".playerlist_item:odd").addClass("odd"),t.addHover(".playerlist_item, .msg, .playerlist_top_box .playerlist"),$(".js_playerlist").on("click.playerList",".pl_filter_set",function(){e.filterPlayerlist()}),e.filterPlayerlist()},showChat:function(e){var t=!1,a=ogame.chat;if($(".chat_bar_list_item").each(function(){var r=$(this);(e.playerId!==void 0&&r.data("playerid")===e.playerId||e.associationId!==void 0&&r.data("associationid")===e.associationId)&&(t=!0,r.hasClass("outOfChatbar")&&r.removeClass("outOfChatbar"),r.hasClass("open")?r.fadeTo("400",.3).fadeTo("400",1):(r.click(),r[0].style.display="inline"),r.find("textarea").focus())}),!t){var n;e.playerId!==void 0?n=a.createChatBarContainer(e.playerId):n=a.createChatBarContainerForAssociations(e.associationId),a.updateChatBar(n)}},showChatHistory:function(e){var t=$(".js_chatHistory"),a=e.data;t.length&&t.remove(),$("#chatList").remove(),$(a).insertAfter("#planet"),$("li.playerlist_item").removeClass("active"),$("li.playerlist_item[data-playerid='"+e.playerId+"']").addClass("active"),initBBCodeEditor(locaKeys,itemNames,!1,".new_msg_textarea",2e3,!0)},submitChatBarMsg:function(e,t,a,n){var r=ogame.chat,s=parseInt($(".chat_box_textarea").css("max-height")),d=parseInt($(".chat_box_textarea").css("padding-top"))+parseInt($(".chat_box_textarea").css("padding-bottom"));if(t===13&&a){n<=s+d&&e.css("height",n-d);return}t===13&&(e.parent(".chat_box").data("playerid")!==void 0?r.sendMessage(e.parent(".chat_box").data("playerid"),0,e.val()):e.parent(".chat_box").data("associationid")!==void 0&&r.sendMessage(0,e.parent(".chat_box").data("associationid"),e.val()),e.val(""))},swapChatBarItem:function(e){var t=ogame.chat,a=$(".more_chat_bar_items").prev();a.removeClass("open").find(".icon_close").hide().end().find(".chat_box").hide(),a.remove(),e.addClass("open").find(".icon_close").show().end().find(".chat_box").show().end().insertBefore(".more_chat_bar_items"),t.addToMoreBox([a]),t.updateChatBar(),t.updateCustomScrollbar(e.find(".chat_box_ctn"))},toggleChatBox:function(e,t){var a=ogame.chat;if(!(e.parents(".chat_box").length&&!e.hasClass("icon_close"))){var n=t.children(".chat_box");if(n.is(":visible"))n.hide(),t.removeClass("open");else{t.hasClass("more_chat_bar_items")||(t.addClass("open"),a.updateChatBar()),n.show();var r=n.find(".chat_box_ctn");t.hasClass("more_chat_bar_items")&&(r=n),a.updateCustomScrollbar(r),n.find("textarea").focus()}ogame.messagecounter.resetCounterByType(ogame.messagecounter.type_chat)}},handleTooMuchWindows:function(e,t,a,n,r,s){var d=ogame.chat,c=!0,o=[];$($(".chat_bar_list > .chat_bar_list_item").get().reverse()).each(function(){var l=$(this);if(c){if(l.hasClass("more_chat_bar_items")||l.attr("id")==="chatBarPlayerList")return;l.hasClass("open")?e--:t--,l.removeClass("open").find(".icon_close").hide().end().find(".chat_box").hide(),o.push(l),l.remove(),widthTotal=n*t+a*e+r,c=widthTotal>=s}}),d.addToMoreBox(o)},getItemFromMorelist2Chatbar:function(){var e=$(".more_items .chat_bar_list_item").first().remove(),t=ogame.chat;e.addClass("open").find(".icon_close").show().end().find(".chat_box").show().end().insertBefore(".more_chat_bar_items"),$(".more_items .chat_bar_list_item").length<=0&&$(".more_chat_bar_items").remove(),t.updateCustomScrollbar($(".more_chat_bar_items>.chat_box")),t.updateCustomScrollbar(e.find(".chat_box_ctn"))},updateChatBar:function(e){var t=ogame.chat,a=$(".chat_bar_list > .chat_bar_list_item.open").length,n=$(".more_chat_bar_items").length,r=$(".chat_bar_list").children().length-a-n,s=190,d=270,c=190,o=$("body").innerWidth();e&&a++;var l=s*r+d*a+c*n;l>=o?t.handleTooMuchWindows(a,r,d,s,c,o):l+d<=o&&$(".more_chat_bar_items").length>0&&t.getItemFromMorelist2Chatbar(),e&&(e.insertAfter("#chatBarPlayerList"),t.updateCustomScrollbar(e.find(".chat_box_ctn")))},updateCustomScrollbar:function(e,t){!e||e.length==0||(e.hasClass("mCustomScrollbar")?e.mCustomScrollbar("update"):e.mCustomScrollbar({theme:"ogame"}),t!==!0&&e.mCustomScrollbar("scrollTo","bottom",{scrollInertia:0}),e.each(function(){$(this).height()+"px"==$(this).css("max-height")&&$(this).addClass("scrollbarPresent")}))},updateVisibleState:function(){var e={chatbar:!1,players:[],associations:[]};$(".chat_bar_list>.chat_bar_list_item").each(function(){var t=$(this);t.attr("id")==="chatBarPlayerList"&&t.children(".cb_playerlist_box").is(":visible")?e.chatbar=!0:t.data("playerid")&&t.children(".chat_box").is(":visible")?e.players.push(t.data("playerid")):t.data("associationid")&&t.children(".chat_box").is(":visible")&&e.associations.push(t.data("associationid"))}),$.cookie("visibleChats",JSON.stringify(e),{expires:7})},showPlayerList:function(e){},_showPlayerList:function(){var e=ogame.chat;$.each(e.playerListSelector,function(t,a){$(a).html(e.playerList)})}};inventoryObj={currentPage:null,currentItems:null,currentItem:null,currentCategory:null,initalizeSlider:function(e,t,a,n,r,s,d,c,o){if(!(inventoryObj.currentItems==e&&typeof s>"u"||s==!1)){inventoryObj.currentItems=e,r=r||"slideIn",d=d||"tooltipHTML js_hideTipOnMobile",typeof c>"u"&&(c=!0),typeof o>"u"&&(o=!0),$("#"+t+"Box").remove(".anythingSlider");var l=[],f=0;for(var h in e){var u=e[h];if(!(typeof u.hide<"u"&&u.hide)){if(inventoryObj.currentPage=="shop"||inventoryObj.currentPage=="inventory"){var p=f%inventoryObj.itemsPerSlide;l[f+2*(p%3)-2*Math.floor(p/3)]=u}else l[f]=u;f++}}for(var m=0,g=0,b=$('<ul id="'+t+'" />'),v=l.length;g<v;g++){if(typeof l[g]>"u"){_.append('<div class="item_img"><div class="empty border5px"></div></div>');continue}var u=l[g];if(g%inventoryObj.itemsPerSlide==0){var _=$('<li class="slide_'+m+'" />').appendTo(b);m++}var C,j,A;inventoryObj.currentPage=="shop"?(C=getNumberFormatShort(u.costs,null)+" "+loca.currency[u.currency],j="price"):(C=getNumberFormatShort(u.amount),j="amount");var S;c?S=u.imageLarge+"-75x.png":S=u.imageLarge+"-100x.png";var k;u.canBeActivated||u.canBeBoughtAndActivated?k="enabled":k="disabled",u.isReduced?A='<div class="sale_badge '+k+'"></div>':A="";var E=u.timeLeft!=null?" js_is_active ":"",B="",I=u.title;t.indexOf("js_activeItemSlider")!=-1&&(I="",B=u.timeLeft!=null?'<span class="js_duration undermark" data-total-duration="'+u.totalTime+'">'+u.timeLeft+"</span>":"");var T="";u.timeLeft!=null&&t.indexOf("js_activeItemSlider")!=-1&&(T='<div class="pusher"></div>');var P="";$.inArray(birthdayCategory,u.category)!=-1&&(P='<div class="event_active_hint"></div>'),_.append('<div class="item_img r_'+u.rarity+'" style="background-image: url(/img/icons/items/'+S+');"><div class="item_img_box">'+P+'<div class="activation '+k+E+'"></div><a href="javascript:void(0);" tabindex="1" title="'+I+'" class="detail_button '+d+" "+r+'" ref="'+u.ref+'">'+A+'<span class="ecke"><span class="level '+j+'">'+C+"</span></span></a></div>"+B+T+"</div>")}if($("#"+t+"Box").prepend(b),g%inventoryObj.itemsPerSlide!=0)for(var z=g%inventoryObj.itemsPerSlide;z<inventoryObj.itemsPerSlide;z++)$("#"+t+" li:last").append('<div class="item_img"><div class="empty border5px"></div></div>');return mySlider=$("#"+t).anythingSlider({startStopped:!0,buildStartStop:!1,expand:!0,resizeContents:!1,theme:"default",infiniteSlides:!1,autoPlay:!1,easing:"swing",resizeContents:!0,stopAtEnd:!0,playRtl:isRTLEnabled,hashTags:!0,buildNavigation:o,onInitialized:function(U,D){if(isMobile){var L=1e3,V=50,x=0,w=0,O="ontouchend"in document,K=O?"touchstart":"mousedown",R=O?"touchmove":"mousemove",N=O?"touchend":"mouseup";D.$window.bind(K,function(y){w=new Date().getTime(),x=y.originalEvent.touches?y.originalEvent.touches[0].pageX:y.pageX}).bind(N,function(y){w=0,x=0}).bind(R,function(y){var M=y.originalEvent.touches?y.originalEvent.touches[0].pageX:y.pageX,q=x===0?0:Math.abs(M-x),F=new Date().getTime();w!==0&&F-w<L&&q>V&&(M<x&&D.goForward(),M>x&&D.goBack(),w=0,x=0)})}}})}},initShop:function(){var e=this;$(window).unbind(".shop"),$(document).undelegate(".slideIn","click.shop").delegate(".slideIn","click.shop",function(){e.currentItem==$(this).attr("ref")?(e.currentItem=null,$.bbq.pushState({item:""})):(e.currentItem=$(this).attr("ref"),$.bbq.pushState({item:$(this).attr("ref")}))}),$("button.to_shop").bind("click.shop",function(){$.bbq.pushState({page:"shop"})}),$("button.to_inventory").bind("click.shop",function(){$.bbq.pushState({page:"inventory"})}),$("button.buyResourcesLink").bind("click",function(){reload_page($(this).data("link"))}),$(".to_shop, .to_inventory").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$(".categoryFilter li a").bind("click.shop",function(){$.bbq.pushState({category:$(this).attr("rel")})}),$(window).unbind("hashchange.shop").bind("hashchange.shop",function(t){e.onHashChange($.deparam.fragment(t.fragment))}),e.onHashChange($.deparam.fragment()),inventoryObj.refreshResources()},onHashChange:function(e){if(typeof e.page>"u"){var t={page:"shop",category:$(".categoryFilter a:first").attr("rel")};if(typeof e.item<"u"&&e.item!=""){var a=inventoryObj.items_shop[e.item];a.category.length>0&&(t.category=a.category[a.category.length-1])}$.bbq.pushState(t);return}var n=this.currentPage!=e.page;if(n&&(e.page=="inventory"?(this.openInventory(),$(".planetlink, .moonlink").fragment({page:e.inventory})):(this.openShop(),$(".planetlink, .moonlink").fragment({page:e.shop})),this.updateCategoryAmount()),typeof e.category>"u"){$.bbq.pushState({category:$(".categoryFilter a:first").attr("rel")});return}else(e.category!=this.currentCategory||n)&&this.changeCategory(e.category);if(typeof e.item>"u"||e.item==""&&this.currentItem!=null)$("#itemDetails a.close_details").click(),$(".planetlink, .moonlink").fragment({item:""});else if(this.currentItem!=e.item){var r=$(".slideIn[ref='"+e.item+"']");r.length?r.click():gfSlider.slideIn(getElementByIdWithCache("detail"),e.item),$(".planetlink, .moonlink").fragment({item:e.item})}},initShopDetails:function(){var e=$.deparam.querystring().page;$(document).undelegate("#itemDetails .close_details","click").delegate("#itemDetails .close_details","click",function(){$("a.slideIn[ref="+$(this).attr("ref")+"]:first").click()}).undelegate("#itemDetails a.item.build-it","click").delegate("#itemDetails a.item.build-it","click",function(){return $.ajax({url:$(this).attr("rel"),data:{ajax:1,token:buyToken},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0)},success:function(t){buyToken=t.newToken,t.error?fadeBox(t.message,!0):(fadeBox(t.message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item))}}),!1}).undelegate("#itemDetails a.item.build-it_disabled.dm","click").delegate("#itemDetails a.item.build-it_disabled.dm","click",function(){errorBoxDecision(LocalizationStrings.error,loca.buyDMDecision,LocalizationStrings.yes,LocalizationStrings.no,function(){$("a.dm_button").length>0?$("a.dm_button").click():window.location.href=$("#darkmatter_box a").attr("href")})}).undelegate("#itemDetails a.activateItem.build-it","click").delegate("#itemDetails a.activateItem.build-it","click",function(){var t=$(this);function a(){$.ajax({url:t.attr("rel"),data:{ajax:1,token:activateToken,referrerPage:e},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled")},success:function(n){if(activateToken=n.newToken,n.error)fadeBox(n.message,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled");else{if(n.message.reload){location.href=getRedirectLink();return}n=n.message,fadeBox(n.message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(n.item)}}})}return t.hasClass("isUpgrade")?errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,a):a(),!1}).undelegate("#itemDetails a.buyAndActivate.build-it","click").delegate("#itemDetails a.buyAndActivate.build-it","click",function(){var t=$(this);function a(){$.ajax({url:t.attr("rel"),data:{ajax:1,token:activateToken,referrerPage:e},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled")},success:function(n){if(activateToken=n.newToken,n.error)fadeBox(n.message,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled");else{if(n.message.reload){location.href=getRedirectLink();return}n=n.message,fadeBox(n.message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(n.item)}}})}return t.hasClass("isUpgrade")?errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,a):a(),!1})},refreshResources:function(){getAjaxResourcebox(function(e){$(".to_dark_matter .level").text(e.darkmatter.resources.actualFormat)})},refreshItemData:function(e){var t=e.ref;if(changeTooltip($(".detail_button[ref='"+t+"']"),e.title),$(".detail_button[ref='"+t+"'] span.amount, #itemDetails[data-uuid='"+t+"'] span.amount").html(tsdpkt(e.amount)),typeof inventoryObj.items_inventory<"u"&&(inventoryObj.items_inventory.length==0?inventoryObj.items_inventory={}:e.amount<=0?delete inventoryObj.items_inventory[t]:inventoryObj.items_inventory[t]=e),typeof inventoryObj.items_shop<"u"&&(inventoryObj.items_shop.length==0&&(inventoryObj.items_shop={}),inventoryObj.items_shop[t]=e),changeTooltip($('#itemDetails[data-uuid="'+t+'"] a.activateItem, #itemDetails[data-uuid="'+t+'"] a.buyAndActivate'),e.activationTitle),e.hasEnoughCurrency?$('#itemDetails[data-uuid="'+t+'"] a.item').addClass("build-it").removeClass("build-it_disabled"):$('#itemDetails[data-uuid="'+t+'"] a.item').removeClass("build-it").addClass("build-it_disabled"),e.amount>0?($('#itemDetails[data-uuid="'+t+'"] a.activateItem').show(),$('#itemDetails[data-uuid="'+t+'"] a.buyAndActivate').hide(),e.canBeActivated?$('#itemDetails[data-uuid="'+t+'"] a.activateItem').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+t+'"] a.activateItem').addClass("build-it_disabled").removeClass("build-it")):($('#itemDetails[data-uuid="'+t+'"] a.activateItem').hide(),$('#itemDetails[data-uuid="'+t+'"] a.buyAndActivate').show(),e.canBeBoughtAndActivated&&e.hasEnoughCurrency?$('#itemDetails[data-uuid="'+t+'"] a.buyAndActivate').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+t+'"] a.buyAndActivate').addClass("build-it_disabled").removeClass("build-it")),isMobile){var a="";$('#itemDetails[data-uuid="'+t+'"] a.activateItem:visible,#itemDetails[data-uuid="'+t+'"] a.buyAndActivate:visible').hasClass("build-it_disabled")&&(a+=e.activationTitle),e.buyTitle.length&&e.buyTitle!=e.activationTitle&&(a+=e.buyTitle),$('#itemDetails[data-uuid="'+t+'"] .info_txt').text(a)}e.timeLeft>0&&e.extendable?($('#itemDetails[data-uuid="'+t+'"] a.activateItem span').html(loca.extend),$('#itemDetails[data-uuid="'+t+'"] a.buyAndActivate span').html(loca.buyAndExtend)):($('#itemDetails[data-uuid="'+t+'"] a.activateItem span').html(loca.activate),$('#itemDetails[data-uuid="'+t+'"] a.buyAndActivate span').html(loca.buyAndActivate)),e.isAnUpgrade?$('#itemDetails[data-uuid="'+t+'"] a.activateItem, #itemDetails[data-uuid="'+t+'"] a.buyAndActivate').addClass("isUpgrade"):$('#itemDetails[data-uuid="'+t+'"] a.activateItem, #itemDetails[data-uuid="'+t+'"] a.buyAndActivate').removeClass("isUpgrade"),this.inShop===!0&&this.changeCategory($(".categoryFilter a.active").attr("rel")),this.updateCategoryAmount()},boughtItemHint:function(){$(".to_inventory .bought_item_notice").show().fadeOut(1e3)},openShop:function(){this.currentPage="shop",$("#js_inventorySliderBox").hide(),$("#js_shopSliderBox").show(),$(".to_inventory").removeClass("active"),$(".to_shop").addClass("active"),$("#buttonz h2").text(loca.LOCA_PREMIUM_SHOP),isMobile&&$(".js_shopCurrentPage").html(loca.shopText)},openInventory:function(){this.currentPage="inventory",$("#js_shopSliderBox").hide(),$("#js_inventorySliderBox").show(),$(".to_shop").removeClass("active"),$(".to_inventory").addClass("active"),$("#buttonz h2").text(loca.LOCA_PREMIUM_INVENTORY),isMobile&&$(".js_shopCurrentPage").html(loca.inventoryText)},changeCategory:function(e){inventoryObj.currentCategory=e,$(".planetlink, .moonlink").fragment({category:e}),$(".categoryFilter li, .categoryFilter li a").removeClass("active"),$('.categoryFilter li a[rel="'+e+'"]').addClass("active").parent().addClass("active"),$(".anythingSlider").remove();var t=function(a,n){var r=[],s=[],d=0;$.each(a,function(o){if(this.category!=null){var l="$"+this.category.join("$")+"$";l.toLowerCase().indexOf("$"+e+"$")!=-1&&(r[inventoryObj.item_orders[e][this.ref]]=this,inventoryObj.item_orders[e][this.ref]>d&&(d=inventoryObj.item_orders[e][this.ref]))}});for(var c=0;c<=d;++c)r[c]&&(s[c]=r[c]);inventoryObj.initalizeSlider(s,n,340,340,null,null,null,!1)};inventoryObj.currentPage=="shop"?t(inventoryObj.items_shop,"js_shopSlider"):inventoryObj.currentPage=="inventory"&&t(inventoryObj.items_inventory,"js_inventorySlider")},updateCategoryAmount:function(){var e;if(inventoryObj.currentPage=="shop")e=inventoryObj.items_shop;else if(inventoryObj.currentPage=="inventory")e=inventoryObj.items_inventory;else return;var t=$(".categoryFilter");t.find(".amount").text(0),$.each(e,function(a){if(this.category!=null)for(var n in this.category){var r=this.category[n],s=t.find('a[rel="'+r+'"] .amount'),d;inventoryObj.currentPage=="shop"?d=1:inventoryObj.currentPage=="inventory"&&(d=this.amount),s.text(tsdpkt(getValue(s.text())+d))}}),$.each(t.find("li"),function(a){var n=inventoryObj.currentPage.slice(0,1).toUpperCase()+inventoryObj.currentPage.slice(1);$(this).hasClass("in"+n)?$(this).show():($(this).hide(),t.find("li:visible .active").length||t.find("li:visible:first a").click())})}};var Spinners={version:"3.0.0"};(function(e){function t(o){return o*Math.PI/180}function a(o){this.element=o}function n(o,l){o&&(this.element=o,c.remove(o),c.removeDetached(),this._position=0,this._state="stopped",this.setOptions(e.extend({color:"#000",dashes:12,radius:5,height:5,width:1.8,opacity:1,padding:3,rotation:700},l||{})),this.drawPosition(0),c.add(this))}var r={scroll:function(o,l){if(!l)return o;var f=o.slice(0,l);return o.slice(l,o.length).concat(f)},isElement:function(o){return o&&o.nodeType==1},element:{isAttached:function(){return function(o){for(;o&&o.parentNode;)o=o.parentNode;return!!o&&!!o.body}}()}},s={drawRoundedRectangle:function(o,l){var m=e.extend({top:0,left:0,width:0,height:0,radius:0},l||{}),f=m.left,h=m.top,u=m.width,p=m.height,m=m.radius;o.beginPath(),o.moveTo(f+m,h),o.arc(f+u-m,h+m,m,t(-90),t(0),!1),o.arc(f+u-m,h+p-m,m,t(0),t(90),!1),o.arc(f+m,h+p-m,m,t(90),t(180),!1),o.arc(f+m,h+m,m,t(-180),t(-90),!1),o.closePath(),o.fill()}},d=function(){function o(h){var u=[];if(h.indexOf("#")==0&&(h=h.substring(1)),h=h.toLowerCase(),h.replace(l,"")!="")return null;for(h.length==3?(u[0]=h.charAt(0)+h.charAt(0),u[1]=h.charAt(1)+h.charAt(1),u[2]=h.charAt(2)+h.charAt(2)):(u[0]=h.substring(0,2),u[1]=h.substring(2,4),u[2]=h.substring(4)),h=0;h<u.length;h++)u[h]=parseInt(u[h],16);return u.red=u[0],u.green=u[1],u.blue=u[2],u}var l=RegExp("[0123456789abcdef]","g"),f=function(){function h(u,p,m){return u=u.toString(m||10),Array(p-u.length).join("0")+u}return function(u,p,m){return"#"+h(u,2,16)+h(p,2,16)+h(m,2,16)}}();return{hex2rgb:o,hex2fill:function(h,u){typeof u>"u"&&(u=1);var p=u,m=o(h);return m[3]=p,m.opacity=p,"rgba("+m.join()+")"},rgb2hex:f}}();e.extend(Spinners,{enabled:!1,support:{canvas:function(){var o=e("<canvas>")[0];return!!o.getContext&&!!o.getContext("2d")}()},init:function(){(this.support.canvas||window.G_vmlCanvasManager&&window.attachEvent&&navigator.userAgent.indexOf("Opera")===-1)&&(window.G_vmlCanvasManager&&window.G_vmlCanvasManager.init_(document),this.enabled=!0)},create:function(o,l){return a.create(o,l),this.get(o)},get:function(o){return new a(o)},play:function(o){return this.get(o).play(),this},pause:function(o){return this.get(o).pause(),this},toggle:function(o){return this.get(o).toggle(),this},stop:function(o){return this.get(o).stop(),this},remove:function(o){return this.get(o).remove(),this},removeDetached:function(){return c.removeDetached(),this},center:function(o){return this.get(o).center(),this},setOptions:function(o,l){return this.get(o).setOptions(l),this},getDimensions:function(o){return o=2*c.get(o)[0].getLayout().workspace.radius,{width:o,height:o}}});var c={spinners:[],get:function(o){if(o){var l=[];return e.each(this.spinners,function(f,h){h&&(r.isElement(o)?h.element==o:e(h.element).is(o))&&l.push(h)}),l}},add:function(o){this.spinners.push(o)},remove:function(o){e(e.map(this.spinners,function(l){if(r.isElement(o)?l.element==o:e(l.element).is(o))return l.element})).each(e.proxy(function(l,f){this.removeByElement(f)},this))},removeByElement:function(o){var l=this.get(o)[0];l&&(l.remove(),this.spinners=e.grep(this.spinners,function(f){return f.element!=o}))},removeDetached:function(){e.each(this.spinners,e.proxy(function(o,l){l&&l.element&&!r.element.isAttached(l.element)&&this.remove(l.element)},this))}};e.extend(a,{create:function(o,l){if(o){var f=l||{},h=[];return r.isElement(o)?h.push(new n(o,f)):e(o).each(function(u,p){h.push(new n(p,f))}),h}}}),e.extend(a.prototype,{items:function(){return c.get(this.element)},play:function(){return e.each(this.items(),function(o,l){l.play()}),this},stop:function(){return e.each(this.items(),function(o,l){l.stop()}),this},pause:function(){return e.each(this.items(),function(o,l){l.pause()}),this},toggle:function(){return e.each(this.items(),function(o,l){l.toggle()}),this},center:function(){return e.each(this.items(),function(o,l){l.center()}),this},setOptions:function(o){return e.each(this.items(),function(l,f){f.setOptions(o)}),this},remove:function(){return c.remove(this.element),this}}),e.extend(n.prototype,{setOptions:function(l){this.options=e.extend({},this.options,l||{}),this.options.radii&&(l=this.options.radii,this.options.radius=Math.min(l[0],l[1]),this.options.height=Math.max(l[0],l[1])-this.options.radius),this.options.dashWidth&&(this.options.width=this.options.dashWidth),this.options.speed&&(this.options.duration=1e3*this.options.speed);var l=this._state,f=this._position;switch(this._layout=null,this.build(),f&&f>=this.options.dashes-1&&(this._position=this.options.dashes-1),l){case"playing":this.play();break;case"paused":case"stopped":this.drawPosition(this._position)}this._centered&&this.center()},remove:function(){this.canvas&&(this.pause(),e(this.canvas).remove(),this.ctx=this.canvas=null)},build:function(){this.remove();var o=this.getLayout().workspace.radius;return e(document.body).append(this.canvas=e("<canvas>").attr({width:2*o,height:2*o}).css({zoom:1})),window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas[0]),this.ctx=this.canvas[0].getContext("2d"),this.ctx.globalAlpha=this.options.opacity,e(this.element).append(this.canvas),this.ctx.translate(o,o),this},drawPosition:function(l){var h=this.getLayout().workspace,l=r.scroll(h.opacities,-1*l),f=h.radius,h=this.options.dashes,u=t(360/h);for(this.ctx.clearRect(-1*f,-1*f,2*f,2*f),f=0;f<h;f++)this.drawDash(l[f],this.options.color),this.ctx.rotate(u)},drawDash:function(o,l){this.ctx.fillStyle=d.hex2fill(l,o);var u=this.getLayout(),f=u.workspace.radius,h=u.dash.position,u=u.dash.dimensions;s.drawRoundedRectangle(this.ctx,{top:h.top-f,left:h.left-f,width:u.width,height:u.height,radius:Math.min(u.height,u.width)/2})},_nextPosition:function(){var o=this.options.rotation/this.options.dashes;this.nextPosition(),this._playTimer=window.setTimeout(e.proxy(this._nextPosition,this),o)},nextPosition:function(){this._position==this.options.dashes-1&&(this._position=-1),this._position++,this.drawPosition(this._position)},play:function(){if(this._state!="playing"){this._state="playing";var o=this.options.rotation/this.options.dashes;return this._playTimer=window.setTimeout(e.proxy(this._nextPosition,this),o),this}},pause:function(){if(this._state!="paused")return this._pause(),this._state="paused",this},_pause:function(){this._playTimer&&(window.clearTimeout(this._playTimer),this._playTimer=null)},stop:function(){if(this._state!="stopped")return this._pause(),this._position=0,this.drawPosition(0),this._state="stopped",this},toggle:function(){return this[this._state=="playing"?"pause":"play"](),this},getLayout:function(){if(this._layout)return this._layout;for(var p=this.options,o=p.dashes,l=p.width,f=p.radius,h=p.radius+p.height,u=Math.max(l,h),u=Math.ceil(Math.max(u,Math.sqrt(h*h+l/2*(l/2)))),p=u+=p.padding,m=1/o,g=[],b=0;b<o;b++)g.push((b+1)*m);return this._layout=o={workspace:{radius:p,opacities:g},dash:{position:{top:u-h,left:u-l/2},dimensions:{width:l,height:h-f}}}},center:function(){var o=2*this.getLayout().workspace.radius;e(this.element.parentNode).css({position:"relative"}),e(this.element).css({position:"absolute",height:o+"px",width:o+"px",top:"50%",left:"50%",marginLeft:-.5*o+"px",marginTop:-.5*o+"px"}),this._centered=!0}}),Spinners.init(),Spinners.enabled||(a.create=function(){return[]})})(jQuery);var Tipped$1={version:"3.1.8"};Tipped$1.Skins={base:{afterUpdate:!1,ajax:{cache:!0,type:"get"},background:{color:"#f2f2f2",opacity:1},border:{size:1,color:"#000",opacity:1},closeButtonSkin:"default",containment:{selector:"viewport"},fadeIn:180,fadeOut:220,showDelay:75,hideDelay:25,radius:{size:5,position:"background"},hideAfter:!1,hideOn:{element:"self",event:"mouseleave"},hideOthers:!1,hook:"topleft",inline:!1,offset:{x:0,y:0},onHide:!1,onShow:!1,shadow:{blur:2,color:"#000",offset:{x:0,y:0},opacity:.12},showOn:"mousemove",spinner:!0,stem:{height:9,width:18,offset:{x:9,y:9},spacing:2},target:"self"},reset:{ajax:!1,closeButton:!1,hideOn:[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseleave"}],hook:"topmiddle",stem:!0},dark:{background:{color:"#282828"},border:{color:"#9b9b9b",opacity:.4,size:1},shadow:{opacity:.02},spinner:{color:"#fff"}},light:{background:{color:"#fff"},border:{color:"#646464",opacity:.4,size:1},shadow:{opacity:.04}},gray:{background:{color:[{position:0,color:"#8f8f8f"},{position:1,color:"#808080"}]},border:{color:"#131313",size:1,opacity:.6}},tiny:{background:{color:"#161616"},border:{color:"#969696",opacity:.35,size:1},fadeIn:0,fadeOut:0,radius:4,stem:{width:11,height:6,offset:{x:6,y:6}},shadow:!1,spinner:{color:"#fff"}},yellow:{background:"#ffffaa",border:{size:1,color:"#6d5208",opacity:.4}},red:{background:{color:[{position:0,color:"#e13c37"},{position:1,color:"#e13c37"}]},border:{size:1,color:"#150201",opacity:.6},spinner:{color:"#fff"}},green:{background:{color:[{position:0,color:"#4bb638"},{position:1,color:"#4aab3a"}]},border:{size:1,color:"#122703",opacity:.6},spinner:{color:"#fff"}},blue:{background:{color:[{position:0,color:"#4588c8"},{position:1,color:"#3d7cb9"}]},border:{color:"#020b17",opacity:.6},spinner:{color:"#fff"}}};(function(e){e.extend(Tipped$1.Skins,{black:e.extend(!0,{},Tipped$1.Skins.dark,{radius:0}),white:e.extend(!0,{},Tipped$1.Skins.light,{radius:0})})})(jQuery);Tipped$1.Skins.CloseButtons={base:{diameter:17,border:2,x:{diameter:10,size:2,opacity:1},states:{default:{background:{color:[{position:0,color:"#1a1a1a"},{position:.46,color:"#171717"},{position:.53,color:"#121212"},{position:.54,color:"#101010"},{position:1,color:"#000"}],opacity:1},x:{color:"#fafafa",opacity:1},border:{color:"#fff",opacity:1}},hover:{background:{color:"#333",opacity:1},x:{color:"#e6e6e6",opacity:1},border:{color:"#fff",opacity:1}}},shadow:{blur:1,color:"#000",offset:{x:0,y:0},opacity:.5}},reset:{},default:{},light:{diameter:17,border:2,x:{diameter:10,size:2,opacity:1},states:{default:{background:{color:[{position:0,color:"#797979"},{position:.48,color:"#717171"},{position:.52,color:"#666"},{position:1,color:"#666"}],opacity:1},x:{color:"#fff",opacity:.95},border:{color:"#676767",opacity:1}},hover:{background:{color:[{position:0,color:"#868686"},{position:.48,color:"#7f7f7f"},{position:.52,color:"#757575"},{position:1,color:"#757575"}],opacity:1},x:{color:"#fff",opacity:1},border:{color:"#767676",opacity:1}}}}};eval(function(e,t,a,n,r,s){if(r=function(d){return(d<t?"":r(parseInt(d/t)))+((d=d%t)>35?String.fromCharCode(d+29):d.toString(36))},!"".replace(/^/,String)){for(;a--;)s[r(a)]=n[a]||r(a);n=[function(d){return s[d]}],r=function(){return"\\w+"},a=1}for(;a--;)n[a]&&(e=e.replace(new RegExp("\\b"+r(a)+"\\b","g"),n[a]));return e}(`(12(a){12 c(a,b){13 c=[a,b];1a c.15=a,c.17=b,c}12 f(a){1N.5v&&5v[5v.6z?"6z":"8c"](a)}12 j(a){11.1g=a}12 k(a){13 b={};28(13 c 5w a)b[c]=a[c]+"2w";1a b}12 l(a,b){1a 1b.8d(a*a+b*b)}12 m(a){1a 2E*a/1b.2Z}12 n(a){1a a*1b.2Z/2E}12 o(a){1a 1/1b.4A(a)}12 v(b){1f(b){11.1g=b,u.1z(b);13 c=11.2e();11.19=a.1k({},c.19),11.2x=1,11.1o={},11.1V=a(b).1X("2p-1V"),u.30(11),11.29=11.19.1u.1D,11.6A=11.19.1l&&11.29,11.3a={x:0,y:0},11.3l={17:0,15:0},11.1P()}}12 x(b,c){11.1g=b,11.1g&&c&&(11.19=a.1k({31:3,1A:{x:0,y:0},1Q:"#4B",1K:.5,2L:1},20[2]||{}),11.2x=11.19.2L,11.1o={},11.1V=a(b).1X("2p-1V"),w.30(11),11.1P())}12 z(b){11.1g=b,11.1g&&(11.19=a.1k({31:5,1A:{x:0,y:0},1Q:"#4B",1K:.5,2L:1},20[1]||{}),11.2x=11.19.2L,11.1V=a(b).1X("2p-1V"),y.30(11),11.1P())}12 A(b,c){28(13 d 5w c)c[d]&&c[d].3D&&c[d].3D===5x?(b[d]=a.1k({},b[d])||{},A(b[d],c[d])):b[d]=c[d];1a b}12 C(b,c){1f(11.1g=b,11.1g){13 e=a(b).1X("2p-1V");e&&B.1z(b),e=h(),a(b).1X("2p-1V",e),11.1V=e;13 f;"8e"!=a.1p(c)||d.2j(c)?f=20[2]||{}:(f=c,c=1r),11.19=B.6B(f);13 g=b.6C("5y");1f(!c){13 i=b.6C("1X-2p");i?c=i:g&&(c=g)}g&&(a(b).1X("5z",g),b.8f("5y","")),11.2F=c,11.2k=11.19.2k||+B.19.4C,11.1o={2G:{14:1,18:1},5A:[],3b:[],2q:{4D:!1,2l:!1,1L:!1,3c:!1,1P:!1,4E:!1,5B:!1,3E:!1},5C:""};13 j=11.19.1C;11.1C="2M"==j?"2M":"4F"!=j&&j?d.2j(j)?j:j&&1x.6D(j)||11.1g:11.1g,11.6E(),B.30(11)}}13 b=6F.3F.8g,d={8h:12(c,d){13 e=c;1a 12(){13 c=[a.1v(e,11)].6G(b.5D(20));1a d.5E(11,c)}},2j:12(a){1a a&&1==a.8i},4G:12(a,c){13 d=b.5D(20,2);1a 8j(12(){1a a.5E(a,d)},c)},44:12(a){1a d.4G.5E(11,[a,1].6G(b.5D(20,1)))},5F:12(a){1a{x:a.5G,y:a.6H}},1g:{4H:12(a){13 b=0,d=0;8k b+=a.4I||0,d+=a.4J||0,a=a.4K;8l(a);1a c(d,b)},4L:12(b){13 e=a(b).1A(),f=d.1g.4H(b),g={17:a(1N).4I(),15:a(1N).4J()};1a e.15+=f.15-g.15,e.17+=f.17-g.17,c(e.15,e.17)},5H:12(){12 a(a){28(13 b=a;b&&b.4K;)b=b.4K;1a b}1a 12(b){13 c=a(b);1a!(!c||!c.3d)}}()}},e=12(a){12 b(b){13 c=5I(b+"([\\\\d.]+)").8m(a);1a c?5J(c[1]):!0}1a{3m:!(!1N.8n||-1!==a.3n("5K"))&&b("8o "),5K:a.3n("5K")>-1&&(!!1N.5L&&5L.6I&&5J(5L.6I())||7.55),5M:a.3n("6J/")>-1&&b("6J/"),4M:a.3n("4M")>-1&&-1===a.3n("8p")&&b("8q:"),6K:!!a.3e(/8r.*8s.*8t/),4N:a.3n("4N")>-1&&b("4N/")}}(8u.8v),g={32:{46:{5N:"1.4.4",5O:1N.46&&46.8w.8x}},6L:12(){12 b(b){28(13 c=b.3e(a),d=c&&c[1]&&c[1].2N(".")||[],e=0,f=0,g=d.2a;g>f;f++)e+=2O(d[f]*1b.6M(10,6-2*f));1a c&&c[3]?e-1:e}13 a=/^(\\d+(\\.?\\d+){0,3})([A-6N-8y-]+[A-6N-8z-9]+)?/;1a 12(a){11.32[a].6O||(11.32[a].6O=!0,(!11.32[a].5O||b(11.32[a].5O)<b(11.32[a].5N)&&!11.32[a].6P)&&(11.32[a].6P=!0,f("1S 8A "+a+" >= "+11.32[a].5N)))}}()},h=12(){13 a=0,b="8B";1a 12(c){28(c=c||b,a++;1x.6D(c+a);)a++;1a c+a}}(),i=12(){13 b=[];1a{1t:12(c){28(13 d=1r,e=0;b.2a>e;e++)b[e]&&b[e].47==c.47&&b[e].1p.6Q()==c.1p.6Q()&&a.6R(b[e].1X||{})==a.6R(c.1X||{})&&(d=b[e].4O);1a d},4P:12(c,d){11.1z(c.47),b.2n(a.1k({},c,{4O:d}))},1z:12(a){28(13 c=0;b.2a>c;c++)b[c]&&b[c].47==a&&3G b[c]},6S:12(){b=[]}}}();a.1k(1S,12(){1a{2H:{3f:12(){13 a=1x.22("3f");1a!(!a.3o||!a.3o("2d"))}(),3H:12(){6T{1a!!("8C"5w 1N||1N.6U&&1x 8D 6U)}6V(a){1a!1}}(),48:12(){13 b=["8E","8F","8G"],c=!1;1a a.1w(b,12(a,b){6T{1x.8H(b),c=!0}6V(d){}}),c}()},3p:12(){(11.2H.3f||e.3m)&&(g.6L("46"),a(1x).6W(12(){B.6X()}))},4Q:12(a,b,c){1a j.4Q(a,b,c),11.1t(a)},1t:12(a){1a 3q j(a)},5P:12(a){1a B.5P(a)},1W:12(a){1a 11.1t(a).1W(),11},1I:12(a){1a 11.1t(a).1I(),11},33:12(a){1a 11.1t(a).33(),11},2P:12(a){1a 11.1t(a).2P(),11},1z:12(a){1a 11.1t(a).1z(),11},4R:12(){1a B.4R(),11},5Q:12(a){1a B.5Q(a),11},5R:12(a){1a B.5R(a),11},1L:12(b){1f(d.2j(b))1a B.5S(b);1f("5T"!=a.1p(b)){13 c=a(b),e=0;1a a.1w(c,12(a,b){B.5S(b)&&e++}),e}1a B.3I().2a},5U:12(){1a B.5U(),11}}}()),a.1k(j,{4Q:12(b,c){1f(b){13 e=20[2]||{},f=[];1a B.6Y(),d.2j(b)?f.2n(3q C(b,c,e)):a(b).1w(12(a,b){f.2n(3q C(b,c,e))}),f}}}),a.1k(j.3F,{49:12(){1a B.2r.4S={x:0,y:0},B.1t(11.1g)},1W:12(){1a a.1w(11.49(),12(a,b){b.1W()}),11},1I:12(){1a a.1w(11.49(),12(a,b){b.1I()}),11},33:12(){1a a.1w(11.49(),12(a,b){b.33()}),11},2P:12(){1a a.1w(11.49(),12(a,b){b.2P()}),11},1z:12(){1a B.1z(11.1g),11}});13 p={4T:12(){13 b;1a b=e.6K?{14:1N.5V,18:1N.5W}:{18:a(1N).18(),14:a(1N).14()}}},q={3r:1b.1E(1b.4U(1N.3r?5J(1N.3r)||1:1,2)),3p:12(){12 a(a){13 b=a.3o("2d");b.8I(q.3r,q.3r)}1a 1N.4V&&!1S.2H.3f&&e.3m?12(b){4V.8J(b),a(b)}:12(b){a(b)}}(),3J:12(b,c){a(b).3g({14:c.14*11.3r,18:c.18*11.3r}).1q(k(c))},6Z:12(b){13 c=a.1k({17:0,15:0,14:0,18:0,1n:0},20[1]||{}),d=c,e=d.15,f=d.17,g=d.14,h=d.18,i=d.1n;1a i?(b.2f(),b.3s(e+i,f),b.26(e+g-i,f+i,i,n(-90),n(0),!1),b.26(e+g-i,f+h-i,i,n(0),n(90),!1),b.26(e+i,f+h-i,i,n(90),n(2E),!1),b.26(e+i,f+i,i,n(-2E),n(-90),!1),b.2g(),b.34(),3t 0):(b.70(e,f,g,h),3t 0)},8K:12(b,c){28(13 d=a.1k({x:0,y:0,1Q:"#4B"},20[2]||{}),e=0,f=c.2a;f>e;e++)28(13 g=0,h=c[e].2a;h>g;g++){13 i=2O(c[e].3u(g))*(1/9);b.2Q=t.2R(d.1Q,i),i&&b.70(d.x+g,d.y+e,1,1)}},4a:12(b,c){13 d;1f("2s"==a.1p(c))d=t.2R(c);1G 1f("2s"==a.1p(c.1Q))d=t.2R(c.1Q,"2y"==a.1p(c.1K)?c.1K:1);1G 1f(a.71(c.1Q)){13 e=a.1k({3K:0,3L:0,3M:0,3N:0},20[2]||{});d=q.72.73(b.8L(e.3K,e.3L,e.3M,e.3N),c.1Q,c.1K)}1a d}};q.72={73:12(b,c){28(13 d="2y"==a.1p(20[2])?20[2]:1,e=0,f=c.2a;f>e;e++){13 g=c[e];("5T"==a.1p(g.1K)||"2y"!=a.1p(g.1K))&&(g.1K=1),b.8M(g.1e,t.2R(g.1Q,g.1K*d))}1a b}};13 r={74:["3O","4b","3P","3Q","4c","4d","4e","4f","4g","4h","4i","3R"],4j:{75:/^(17|15|1R|1O)(17|15|1R|1O|2t|2S)$/,1J:/^(17|1R)/,35:/(2t|2S)/,76:/^(17|1R|15|1O)/},77:12(){13 a={17:"18",15:"14",1R:"18",1O:"14"};1a 12(b){1a a[b]}}(),35:12(a){1a!!a.3v().3e(11.4j.35)},78:12(a){1a!11.35(a)},2I:12(a){1a a.3v().3e(11.4j.1J)?"1J":"2b"},5X:12(a){13 b=1r,c=a.3v().3e(11.4j.76);1a c&&c[1]&&(b=c[1]),b},2N:12(a){1a a.3v().3e(11.4j.75)}},s={5Y:12(a){13 b=a.19.1l;1a{14:b.14,18:b.18}},4k:12(b,c){13 d=a.1k({3S:"1E"},20[2]||{}),e=b.19.1l,f=e.14,g=e.18,h=11.4W(f,g,c);1a d.3S&&(h.14=1b[d.3S](h.14),h.18=1b[d.3S](h.18)),{14:h.14,18:h.18}},4W:12(a,b,c){13 d=m(1b.79(.5*(b/a))),e=2E-d,f=1b.4A(n(e-90))*c,g=a+2*f,h=g*b/a;1a{14:g,18:h}},3T:12(a,b){13 c=11.4k(a,b),d=11.5Y(a),f=(r.35(a.29),1b.1E(c.18+b));1a a.19.1l.1A||0,a.19.1n&&a.19.1n.2u||0,{2z:{1c:{14:1b.1E(c.14),18:1b.1E(f)}},1i:{1c:c},1l:{1c:{14:d.14,18:d.18}}}},5Z:12(b,c,d){13 f=b.19,g={17:0,15:0},h={17:0,15:0},i=a.1k({},c),j=b.1i,k=k||11.3T(b,b.1i),l=k.2z.1c;d&&(l.18=d,j=0);13 m=r.2N(b.29),n=r.2I(b.29);1f(b.19.1l){13 o=r.5X(b.29);1f("17"==o?g.17=l.18-j:"15"==o&&(g.15=l.18-j),"1J"==n){1T(m[2]){1h"2t":1h"2S":h.15=.5*i.14;1B;1h"1O":h.15=i.14}"1R"==m[1]&&(h.17=i.18-j+l.18)}1G{1T(m[2]){1h"2t":1h"2S":h.17=.5*i.18;1B;1h"1R":h.17=i.18}"1O"==m[1]&&(h.15=i.14-j+l.18)}i[r.77(o)]+=l.18-j}1G 1f("1J"==n){1T(m[2]){1h"2t":1h"2S":h.15=.5*i.14;1B;1h"1O":h.15=i.14}"1R"==m[1]&&(h.17=i.18)}1G{1T(m[2]){1h"2t":1h"2S":h.17=.5*i.18;1B;1h"1R":h.17=i.18}"1O"==m[1]&&(h.15=i.14)}13 p=f.1n&&f.1n.2u||0,q=f.1i&&f.1i.2u||0;1f(b.19.1l){13 t=p&&"1m"==f.1n.1e?p:0,u=p&&"1i"==f.1n.1e?p:p+q,v=q+t+.5*k.1l.1c.14-.5*k.1i.1c.14,w=u>v?u-v:0,x=1b.1E(q+t+.5*k.1l.1c.14+w);1f("1J"==n)1T(m[2]){1h"15":h.15+=x;1B;1h"1O":h.15-=x}1G 1T(m[2]){1h"17":h.17+=x;1B;1h"1R":h.17-=x}}13 y;1f(f.1l&&(y=f.1l.1A)){13 z=s.60(y,b.6A,c,k.1i.1c,q,p);1f(y=z.1A,z.4l,"1J"==n)1T(m[2]){1h"15":h.15+=y.x;1B;1h"1O":h.15-=y.x}1G 1T(m[2]){1h"17":h.17+=y.y;1B;1h"1R":h.17-=y.y}}13 B;1f(f.1l&&(B=f.1l.8N))1f("1J"==n)1T(m[1]){1h"17":h.17-=B;1B;1h"1R":h.17+=B}1G 1T(m[1]){1h"15":h.15-=B;1B;1h"1O":h.15+=B}1a{1c:i,1e:{17:0,15:0},1m:{1e:g,1c:c},1l:{1c:l},2J:h}},60:12(b,c,d,e,f,g){13 h=r.2I(c),i=a.1k({},b),j={x:0,y:0},k=0;1a"1J"==h&&(k=d.14-e.14-2*f-2*g)<2*b.x&&(j.x=i.x,/(1O)$/.3h(c)&&(j.x*=-1),i.x=0),"2b"==h&&(k=d.18-e.18-2*f-2*g)<2*b.y&&(j.y=i.y,/(1R)$/.3h(c)&&(j.y*=-1),i.y=0),{1A:i,4l:j}}},t=12(){12 d(a){13 b=a;1a b.7a=a[0],b.7b=a[1],b.7c=a[2],b}12 e(a){1a 2O(a,16)}12 f(a){13 b=6F(3);1f(0==a.3n("#")&&(a=a.4X(1)),a=a.3v(),""!=a.61(c,""))1a 1r;3==a.2a?(b[0]=a.3u(0)+a.3u(0),b[1]=a.3u(1)+a.3u(1),b[2]=a.3u(2)+a.3u(2)):(b[0]=a.4X(0,2),b[1]=a.4X(2,4),b[2]=a.4X(4));28(13 f=0;b.2a>f;f++)b[f]=e(b[f]);1a d(b)}12 g(a,b){13 c=f(a);1a c[3]=b,c.1K=b,c}12 h(b,c){1a"5T"==a.1p(c)&&(c=1),"8O("+g(b,c).8P()+")"}12 i(a){1a"#"+(j(a)[2]>50?"4B":"8Q")}12 j(a){1a k(f(a))}12 k(a){13 f,g,h,a=d(a),b=a.7a,c=a.7b,e=a.7c,i=b>c?b:c;e>i&&(i=e);13 j=c>b?b:c;1f(j>e&&(j=e),h=i/8R,g=0!=i?(i-j)/i:0,0==g)f=0;1G{13 k=(i-b)/(i-j),l=(i-c)/(i-j),m=(i-e)/(i-j);f=b==i?m-l:c==i?2+k-m:4+l-k,f/=6,0>f&&(f+=1)}f=1b.23(7d*f),g=1b.23(62*g),h=1b.23(62*h);13 n=[];1a n[0]=f,n[1]=g,n[2]=h,n.8S=f,n.8T=g,n.8U=h,n}13 b="8V",c=5I("["+b+"]","g");1a{8W:f,2R:h,8X:i}}(),u={4Y:{},1t:12(b){1f(!b)1a 1r;13 c=1r,d=a(b).1X("2p-1V");1a d&&(c=11.4Y[d]),c},30:12(a){11.4Y[a.1V]=a},1z:12(a){13 b=11.1t(a);b&&(3G 11.4Y[b.1V],b.1z())}};a.1k(v.3F,12(){12 b(){11.1o.1u={};13 b=11.29;a.1w(r.74,a.1v(12(b,c){13 d,e=11.1o.1u[c]={};11.29=c;13 f=11.2o();d=f,e.2J=d.2J;13 g=d.1H.1c,h={17:d.1H.1e.17,15:d.1H.1e.15};1f(e.1H={1c:g,1e:h},e.1D={1c:d.21.1c},11.1s){13 i=11.1s.2o(),j=i.21.1e,k=e.1H.1e;a.1k(!0,e,{2J:i.2J,1H:{1e:{17:k.17+j.17,15:k.15+j.15}},1D:{1c:i.1D.1c}})}},11)),11.29=b}12 c(){11.36(),11.19.1s&&(w.1z(11.1g),11.19.1y&&11.19.1y.1s&&y.1z(11.1g)),11.2T&&(11.2T.1z(),11.2T=1r),11.1j&&(a(11.1j).1z(),11.1j=1r)}12 d(){11.1H&&(11.1y&&(a(11.1y).1z(),11.1y=1r,11.63=1r,11.64=1r),a(11.1H).1z(),11.1l=1r,11.1m=1r,11.1H=1r,11.1o={})}12 f(){13 a=11.2e();11.2G=a.1o.2G;13 b=a.19;11.1n=b.1n&&b.1n.2u||0,11.1i=b.1i&&b.1i.2u||0,11.2m=b.2m;13 c=1b.4U(11.2G.18,11.2G.14);11.1n>c/2&&(11.1n=1b.65(c/2)),"1i"==11.19.1n.1e&&11.1n>11.1i&&(11.1i=11.1n),11.1o={19:{1n:11.1n,1i:11.1i,2m:11.2m}}}12 g(){11.36(),1N.4V&&1N.4V.8Y(1x);13 b=11.2e(),c=11.19;11.1H=a("<2h>").1Y("8Z")[0],a(b.4Z).1Z(11.1H),11.51(),11.7e(b),c.1y&&(11.7f(b),c.1y.1s&&(11.2U?(11.2U.19=c.1y.1s,11.2U.1P()):11.2U=3q z(11.1g,a.1k({2L:11.2x},c.1y.1s)))),e.3m&&7>e.3m&&a(b.1j).66(11.2T=a("<91>").1Y("92").3g({93:0,4m:"94:'';"})),11.52(),c.1s&&(11.1s?(11.1s.19=c.1s,11.1s.1P()):11.1s=3q x(11.1g,11,a.1k({2L:11.2x},c.1s))),11.7g()}12 h(){13 b=11.2e(),c=a(b.1j),d=a(b.1j).67(".7h").7i()[0];1f(d){a(d).1q({14:"68",18:"68"});13 e=2O(c.1q("17")),f=2O(c.1q("15")),g=2O(c.1q("14"));c.1q({15:"-7j",17:"-7j",14:"95",18:"68"}),b.1F("1L")||a(b.1j).1W();13 h=B.53.69(d);b.19.3i&&"2y"==a.1p(b.19.3i)&&h.14>b.19.3i&&(a(d).1q({14:b.19.3i+"2w"}),h=B.53.69(d)),b.1F("1L")||a(b.1j).1I(),b.1o.2G=h,c.1q({15:f+"2w",17:e+"2w",14:g+"2w"}),11.1P()}}12 i(a,b,c){13 d=!1;11.4n(a)&&(d=!0),11.7k(b)&&(d=!0),c&&11.7l(c)&&(d=!0),d&&11.1P()}12 j(a){13 b=!1;1a(11.3l.15!=a.15||11.3l.17!=a.17)&&(b=!0,11.3l=a),b}12 l(a){13 b=!1;1a(11.3a.x!=a.x||11.3a.y!=a.y)&&(b=!0,11.3a=a),b}12 m(a){13 c=!1;1a 11.29!=a&&(c=!0,11.29=a),c}12 o(){1a B.1t(11.1g)[0]}12 p(){1a s.3T(11,11.1i)}12 u(){13 b=11.2e().19.1y,c=b.3w+2*b.1i;a(11.63).1q({15:-1*c+"2w"}),a(11.64).1q({15:0})}12 v(){13 b=11.2e().19.1y,c=b.3w+2*b.1i;a(11.63).1q({15:0}),a(11.64).1q({15:c+"2w"})}12 A(b){13 c=b.19.1y,d={14:c.3w+2*c.1i,18:c.3w+2*c.1i};a(b.1j).1Z(a(11.1y=1x.22("2h")).1Y("7m").1q(k(d)).1Z(a(11.7n=1x.22("2h")).1Y("96").1q(k(d)))),11.6a(b,"6b"),11.6a(b,"6c"),1S.2H.3H||e.4N||a(11.1y).3U("4o",a.1v(11.7o,11)).3U("54",a.1v(11.7p,11))}12 C(b,c){13 d=b.19.1y,e=d.3w,f=d.1i||0,g=d.x.3w,h=d.x.2u,j=(d.x.97,d.2q[c||"6b"]),l={14:e+2*f,18:e+2*f};g>=e&&(g=e-2);13 m;a(11.7n).1Z(a(11[c+"7q"]=1x.22("2h")).1Y("98").1q(a.1k(k(l),{15:("6c"==c?l.14:0)+"2w"}))),a(1x.3d).1Z(a(m=1x.22("3f"))),q.3J(m,l),q.3p(m);13 o=m.3o("2d");o.2L=11.2x,a(11[c+"7q"]).1Z(m),o.99(l.14/2,l.18/2),o.2Q=q.4a(o,j.1m,{3K:0,3L:0-e/2,3M:0,3N:0+e/2}),o.2f(),o.26(0,0,e/2,0,2*1b.2Z,!0),o.2g(),o.34(),f&&(o.2Q=q.4a(o,j.1i,{3K:0,3L:0-e/2-f,3M:0,3N:0+e/2+f}),o.2f(),o.26(0,0,e/2,1b.2Z,0,!1),o.1d((e+f)/2,0),o.26(0,0,e/2+f,0,1b.2Z,!0),o.26(0,0,e/2+f,1b.2Z,0,!0),o.1d(e/2,0),o.26(0,0,e/2,0,1b.2Z,!1),o.2g(),o.34());13 p=g/2,r=h/2;1f(r>p){13 s=r;r=p,p=s}o.2Q=t.2R(j.x.1Q||j.x,j.x.1K||1),o.56(n(45)),o.2f(),o.3s(0,0),o.1d(0,p);28(13 u=0;4>u;u++)o.1d(0,p),o.1d(r,p),o.1d(r,p-(p-r)),o.1d(p,r),o.1d(p,0),o.56(n(90));o.2g(),o.34()}12 D(b){13 l,m,o,p,q,c=a.1k({1l:!1,3x:1r,9a:1r,2f:!1,2g:!1,3y:1r,3z:1r,1n:0,1i:0,57:0,37:{x:0,y:0}},20[1]||{}),d=c.3y,e=c.3z,f=c.37,g=c.1i,h=c.1n,i=c.3x,j=d.1m.1e,k=d.1m.1c,t={x:1b.2V(11.3a.x),y:1b.2V(11.3a.y)},u={x:0,y:0},v={x:0,y:0};1f(e){l=e.1l.1c,m=e.2z.1e,o=e.2z.1c,p=o.14-l.14;13 w=c.57,x=g+h+.5*l.14-.5*e.1i.1c.14;q=1b.1E(w>x?w-x:0);13 y=s.60(f,i,k,e.1i.1c,g,h);f=y.1A,v=y.4l,u={x:1b.1U(k.14-2*1b.1U(q,f.x||0)-e.1i.1c.14-(2*h||0),0),y:1b.1U(k.18-2*1b.1U(q,f.y||0)-e.1i.1c.18-(2*h||0),0)},r.35(i)&&(u.x*=.5,u.y*=.5),t.x=1b.4U(t.x,u.x),t.y=1b.4U(t.y,u.y),r.35(i)&&(0>11.3a.x&&t.x>0&&(t.x*=-1),0>11.3a.y&&t.y>0&&(t.y*=-1)),11.3l&&11.3l.3A&&a.1w(11.3l.3A,12(b,c){a.1w("17 1O 1R 15".2N(" "),12(a,b){c==b&&5I("("+b+")$").3h(i)&&(t[/^(15|1O)$/.3h(b)?"x":"y"]=0)})})}13 z,A;1f(h?(z=j.15+g+h,A=j.17+g):(z=j.15+g,A=j.17+g),f&&f.x&&/^(3O|3R)$/.3h(i)&&(z+=f.x),c.2f&&b.2f(),b.3s(z,A),c.1l)1T(i){1h"3O":z=j.15+g,h&&(z+=h),z+=1b.1U(q,f.x||0),z+=t.x,b.1d(z,A),A-=l.18,z+=.5*l.14,b.1d(z,A),A+=l.18,z+=.5*l.14,b.1d(z,A);1B;1h"4b":1h"58":z=j.15+.5*k.14-.5*l.14,z+=t.x,b.1d(z,A),A-=l.18,z+=.5*l.14,b.1d(z,A),A+=l.18,z+=.5*l.14,b.1d(z,A),z=j.15+.5*k.14-.5*o.14,b.1d(z,A);1B;1h"3P":z=j.15+k.14-g-l.14,h&&(z-=h),z-=1b.1U(q,f.x||0),z-=t.x,b.1d(z,A),A-=l.18,z+=.5*l.14,b.1d(z,A),A+=l.18,z+=.5*l.14,b.1d(z,A)}1f(h?h&&(b.26(j.15+k.14-g-h,j.17+g+h,h,n(-90),n(0),!1),z=j.15+k.14-g,A=j.17+g+h):(z=j.15+k.14-g,A=j.17+g,b.1d(z,A)),c.1l)1T(i){1h"3Q":A=j.17+g,h&&(A+=h),A+=1b.1U(q,f.y||0),A+=t.y,b.1d(z,A),z+=l.18,A+=.5*l.14,b.1d(z,A),z-=l.18,A+=.5*l.14,b.1d(z,A);1B;1h"4c":1h"59":A=j.17+.5*k.18-.5*l.14,A+=t.y,b.1d(z,A),z+=l.18,A+=.5*l.14,b.1d(z,A),z-=l.18,A+=.5*l.14,b.1d(z,A);1B;1h"4d":A=j.17+k.18-g,h&&(A-=h),A-=l.14,A-=1b.1U(q,f.y||0),A-=t.y,b.1d(z,A),z+=l.18,A+=.5*l.14,b.1d(z,A),z-=l.18,A+=.5*l.14,b.1d(z,A)}1f(h?h&&(b.26(j.15+k.14-g-h,j.17+k.18-g-h,h,n(0),n(90),!1),z=j.15+k.14-g-h,A=j.17+k.18-g):(z=j.15+k.14-g,A=j.17+k.18-g,b.1d(z,A)),c.1l)1T(i){1h"4e":z=j.15+k.14-g,h&&(z-=h),z-=1b.1U(q,f.x||0),z-=t.x,b.1d(z,A),z-=.5*l.14,A+=l.18,b.1d(z,A),z-=.5*l.14,A-=l.18,b.1d(z,A);1B;1h"4f":1h"5a":z=j.15+.5*k.14+.5*l.14,z+=t.x,b.1d(z,A),z-=.5*l.14,A+=l.18,b.1d(z,A),z-=.5*l.14,A-=l.18,b.1d(z,A);1B;1h"4g":z=j.15+g+l.14,h&&(z+=h),z+=1b.1U(q,f.x||0),z+=t.x,b.1d(z,A),z-=.5*l.14,A+=l.18,b.1d(z,A),z-=.5*l.14,A-=l.18,b.1d(z,A)}1f(h?h&&(b.26(j.15+g+h,j.17+k.18-g-h,h,n(90),n(2E),!1),z=j.15+g,A=j.17+k.18-g-h):(z=j.15+g,A=j.17+k.18-g,b.1d(z,A)),c.1l)1T(i){1h"4h":A=j.17+k.18-g,h&&(A-=h),A-=1b.1U(q,f.y||0),A-=t.y,b.1d(z,A),z-=l.18,A-=.5*l.14,b.1d(z,A),z+=l.18,A-=.5*l.14,b.1d(z,A);1B;1h"4i":1h"5b":A=j.17+.5*k.18+.5*l.14,A+=t.y,b.1d(z,A),z-=l.18,A-=.5*l.14,b.1d(z,A),z+=l.18,A-=.5*l.14,b.1d(z,A);1B;1h"3R":A=j.17+g+l.14,h&&(A+=h),A+=1b.1U(q,f.y||0),A+=t.y,b.1d(z,A),z-=l.18,A-=.5*l.14,b.1d(z,A),z+=l.18,A-=.5*l.14,b.1d(z,A)}1a h?h&&(b.26(j.15+g+h,j.17+g+h,h,n(-2E),n(-90),!1),z=j.15+g+h,A=j.17+g,z+=1,b.1d(z,A)):(z=j.15+g,A=j.17+g,b.1d(z,A)),c.2g&&b.2g(),{x:z,y:A,1l:t,5c:v,37:f}}12 E(b){13 o,p,q,r,s,t,c=a.1k({1l:!1,3x:1r,2f:!1,2g:!1,3y:1r,3z:1r,1n:0,1i:0,7r:0,37:{x:0,y:0},5d:1r},20[1]||{}),d=c.3y,e=c.3z,g=(c.7r,c.37),h=c.1i,i=c.1n&&c.1n.2u||0,j=c.7s,k=c.3x,l=d.1m.1e,m=d.1m.1c,u=c.5d&&c.5d.1l||{x:0,y:0};1f(e){o=e.1l.1c,p=e.2z.1e,q=e.2z.1c,r=e.1i.1c,s=q.14-o.14;13 v=h+j+.5*o.14-.5*r.14;t=1b.1E(i>v?i-v:0)}13 w=l.15+h+j,x=l.17+h;j&&(w+=1),a.1k({},{x:w,y:x}),c.2f&&b.2f();13 z=a.1k({},{x:w,y:x});1f(x-=h,b.1d(w,x),i?i&&(b.26(l.15+i,l.17+i,i,n(-90),n(-2E),!0),w=l.15,x=l.17+i):(w=l.15,x=l.17,b.1d(w,x)),c.1l)1T(k){1h"3R":x=l.17+h,j&&(x+=j),x-=.5*r.14,x+=.5*o.14,x+=1b.1U(t,g.y||0),x+=u.y,b.1d(w,x),w-=r.18,x+=.5*r.14,b.1d(w,x),w+=r.18,x+=.5*r.14,b.1d(w,x);1B;1h"4i":1h"5b":x=l.17+.5*m.18-.5*r.14,x+=u.y,b.1d(w,x),w-=r.18,x+=.5*r.14,b.1d(w,x),w+=r.18,x+=.5*r.14,b.1d(w,x);1B;1h"4h":x=l.17+m.18-h-r.14,j&&(x-=j),x+=.5*r.14,x-=.5*o.14,x-=1b.1U(t,g.y||0),x-=u.y,b.1d(w,x),w-=r.18,x+=.5*r.14,b.1d(w,x),w+=r.18,x+=.5*r.14,b.1d(w,x)}1f(i?i&&(b.26(l.15+i,l.17+m.18-i,i,n(-2E),n(-9b),!0),w=l.15+i,x=l.17+m.18):(w=l.15,x=l.17+m.18,b.1d(w,x)),c.1l)1T(k){1h"4g":w=l.15+h,j&&(w+=j),w-=.5*r.14,w+=.5*o.14,w+=1b.1U(t,g.x||0),w+=u.x,b.1d(w,x),x+=r.18,w+=.5*r.14,b.1d(w,x),x-=r.18,w+=.5*r.14,b.1d(w,x);1B;1h"4f":1h"5a":w=l.15+.5*m.14-.5*r.14,w+=u.x,b.1d(w,x),x+=r.18,w+=.5*r.14,b.1d(w,x),x-=r.18,w+=.5*r.14,b.1d(w,x),w=l.15+.5*m.14+r.14,b.1d(w,x);1B;1h"4e":w=l.15+m.14-h-r.14,j&&(w-=j),w+=.5*r.14,w-=.5*o.14,w-=1b.1U(t,g.x||0),w-=u.x,b.1d(w,x),x+=r.18,w+=.5*r.14,b.1d(w,x),x-=r.18,w+=.5*r.14,b.1d(w,x)}1f(i?i&&(b.26(l.15+m.14-i,l.17+m.18-i,i,n(90),n(0),!0),w=l.15+m.14,x=l.17+m.14+i):(w=l.15+m.14,x=l.17+m.18,b.1d(w,x)),c.1l)1T(k){1h"4d":x=l.17+m.18-h,x+=.5*r.14,x-=.5*o.14,j&&(x-=j),x-=1b.1U(t,g.y||0),x-=u.y,b.1d(w,x),w+=r.18,x-=.5*r.14,b.1d(w,x),w-=r.18,x-=.5*r.14,b.1d(w,x);1B;1h"4c":1h"59":x=l.17+.5*m.18+.5*r.14,x+=u.y,b.1d(w,x),w+=r.18,x-=.5*r.14,b.1d(w,x),w-=r.18,x-=.5*r.14,b.1d(w,x);1B;1h"3Q":x=l.17+h,j&&(x+=j),x+=r.14,x-=.5*r.14-.5*o.14,x+=1b.1U(t,g.y||0),x+=u.y,b.1d(w,x),w+=r.18,x-=.5*r.14,b.1d(w,x),w-=r.18,x-=.5*r.14,b.1d(w,x)}1f(i?i&&(b.26(l.15+m.14-i,l.17+i,i,n(0),n(-90),!0),w=l.15+m.14-i,x=l.17):(w=l.15+m.14,x=l.17,b.1d(w,x)),c.1l)1T(k){1h"3P":w=l.15+m.14-h,w+=.5*r.14-.5*o.14,j&&(w-=j),w-=1b.1U(t,g.x||0),w-=u.x,b.1d(w,x),x-=r.18,w-=.5*r.14,b.1d(w,x),x+=r.18,w-=.5*r.14,b.1d(w,x);1B;1h"4b":1h"58":w=l.15+.5*m.14+.5*r.14,w+=u.x,b.1d(w,x),x-=r.18,w-=.5*r.14,b.1d(w,x),x+=r.18,w-=.5*r.14,b.1d(w,x),w=l.15+.5*m.14-r.14,b.1d(w,x),b.1d(w,x);1B;1h"3O":w=l.15+h+r.14,w-=.5*r.14,w+=.5*o.14,j&&(w+=j),w+=1b.1U(t,g.x||0),w+=u.x,b.1d(w,x),x-=r.18,w-=.5*r.14,b.1d(w,x),x+=r.18,w-=.5*r.14,b.1d(w,x)}b.1d(z.x,z.y-h),b.1d(z.x,z.y),c.2g&&b.2g()}12 F(b){13 c=11.2o(),d=11.19.1l&&11.4p(),e=11.29&&11.29.3v(),f=11.1n,h=11.1i,i=11.2m,k=({14:2*h+2*i+11.2G.14,18:2*h+2*i+11.2G.18},b.19.1l&&b.19.1l.1A||{x:0,y:0}),l=0,m=0;f&&(l="1m"==11.19.1n.1e?f:0,m="1i"==11.19.1n.1e?f:l+h),a(1x.3d).1Z(11.2W=1x.22("3f")),q.3J(11.2W,c.1H.1c),q.3p(11.2W);13 n=11.2W.3o("2d");n.2L=11.2x,a(11.1H).1Z(11.2W),n.2Q=q.4a(n,11.19.1m,{3K:0,3L:c.1m.1e.17+h,3M:0,3N:c.1m.1e.17+c.1m.1c.18-h}),n.9c=0;13 o;1f(o=11.6d(n,{2f:!0,2g:!0,1i:h,1n:l,57:m,3y:c,3z:d,1l:11.19.1l,3x:e,37:k}),n.34(),h){13 p=q.4a(n,11.19.1i,{3K:0,3L:c.1m.1e.17,3M:0,3N:c.1m.1e.17+c.1m.1c.18});n.2Q=p,o=11.6d(n,{2f:!0,2g:!1,1i:h,1n:l,57:m,3y:c,3z:d,1l:11.19.1l,3x:e,37:k}),11.7t(n,{2f:!1,2g:!0,1i:h,7s:l,1n:{2u:m,1e:11.19.1n.1e},3y:c,3z:d,1l:11.19.1l,3x:e,37:o.37,5d:o}),n.34()}11.3B=o}12 G(){13 i,a=11.2e(),b=11.2G,c=a.19,d=11.1n,f=11.1i,g=11.2m,h={14:2*f+2*g+b.14,18:2*f+2*g+b.18};1f(11.19.1l){13 j=11.4p();i=j.2z.1c}13 k=s.5Z(11,h),l=k.1c,m=k.1e,h=k.1m.1c,o=k.1m.1e;k.1l.1c;13 r,t,u,q={17:0,15:0},v={14:l.14,18:l.18};1f(c.1y){13 w=d;"1m"==c.1n.1e&&(w+=f);13 x=w-1b.9d(n(45))*w,y="1O";11.29.3v().3e(/^(3P|3Q)$/)&&(y="15");13 z=c.1y.3w+2*c.1y.1i,r={14:z,18:z};1f(q.15=o.15-z/2+("15"==y?x:h.14-x),q.17=o.17-z/2+x,"15"==y){1f(0>q.15){13 A=1b.2V(q.15);v.14+=A,m.15+=A,q.15=0}}1G{13 B=q.15+z-v.14;B>0&&(v.14+=B)}1f(0>q.17){13 C=1b.2V(q.17);v.18+=C,m.17+=C,q.17=0}1f(11.19.1y.1s){13 D=11.19.1y.1s,E=D.31,F=D.1A;1f(t={14:r.14+2*E,18:r.18+2*E},u={17:q.17-E+F.y,15:q.15-E+F.x},"15"==y){1f(0>u.15){13 A=1b.2V(u.15);v.14+=A,m.15+=A,q.15+=A,u.15=0}}1G{13 B=u.15+t.14-v.14;B>0&&(v.14+=B)}1f(0>u.17){13 C=1b.2V(u.17);v.18+=C,m.17+=C,q.17+=C,u.17=0}}}13 G=k.2J;G.17+=m.17,G.15+=m.15;13 H={15:1b.1E(m.15+o.15+11.1i+11.19.2m),17:1b.1E(m.17+o.17+11.1i+11.19.2m)},I={1D:{1c:{14:1b.1E(v.14),18:1b.1E(v.18)}},21:{1c:{14:1b.1E(v.14),18:1b.1E(v.18)}},1H:{1c:l,1e:{17:1b.23(m.17),15:1b.23(m.15)}},1m:{1c:{14:1b.1E(h.14),18:1b.1E(h.18)},1e:{17:1b.23(o.17),15:1b.23(o.15)}},2J:{17:1b.23(G.17),15:1b.23(G.15)},2F:{1e:H}};1a 11.19.1y&&(I.1y={1c:{14:1b.1E(r.14),18:1b.1E(r.18)},1e:{17:1b.23(q.17),15:1b.23(q.15)}},11.19.1y.1s&&(I.2U={1c:{14:1b.1E(t.14),18:1b.1E(t.18)},1e:{17:1b.23(u.17),15:1b.23(u.15)}})),I}12 H(){13 b=11.2o(),c=11.2e();a(c.1j).1q(k(b.1D.1c)),a(c.4Z).1q(k(b.21.1c)),11.2T&&11.2T.1q(k(b.1D.1c)),a(11.1H).1q(a.1k(k(b.1H.1c),k(b.1H.1e))),11.1y&&(a(11.1y).1q(k(b.1y.1e)),b.2U&&a(11.2U.1j).1q(k(b.2U.1e))),a(c.38).1q(k(b.2F.1e))}12 I(a){11.2x=a||0,11.1s&&(11.1s.2x=11.2x)}12 J(a){11.7u(a),11.1P()}1a{51:f,7g:b,1P:g,1z:c,36:d,2e:o,2P:h,5e:i,7l:j,7k:l,4n:m,7f:A,6a:C,7e:F,6d:D,7t:E,7o:u,7p:v,4p:p,2o:G,52:H,7u:I,9e:J}}());13 w={3j:{},1t:12(b){1f(!b)1a 1r;13 c=1r,d=a(b).1X("2p-1V");1a d&&(c=11.3j[d]),c},30:12(a){11.3j[a.1V]=a},1z:12(a){13 b=11.1t(a);b&&(3G 11.3j[b.1V],b.1z())},4q:12(a){1a 1b.2Z/2-1b.6M(a,1b.4A(a)*1b.2Z)}};w.4r={4k:12(a,b){13 c=u.1t(a.1g),d=c.4p().1i.1c,e=11.4W(d.14,d.18,b,{3S:!1});1a{14:e.14,18:e.18}},9f:12(a,b,c){13 d=.5*a,e=m(1b.9g(d/l(d,b))),f=2E-e-90,g=o(n(f))*c,h=2*(d+g),i=h/a*b;1a{14:h,18:i}},4W:12(a,b,c){13 d=m(1b.79(.5*(b/a))),e=2E-d,f=1b.4A(n(e-90))*c,g=a+2*f,h=g*b/a;1a{14:g,18:h}},3T:12(b){13 c=u.1t(b.1g),d=b.19.31,e=r.78(c.29),g=(r.2I(c.29),w.4r.4k(b,d)),h={2z:{1c:{14:1b.1E(g.14),18:1b.1E(g.18)},1e:{17:0,15:0}}};1f(d){h.2X=[];28(13 i=0;d>=i;i++){13 j=w.4r.4k(b,i,{3S:!1}),k={1e:{17:h.2z.1c.18-j.18,15:e?d-i:(h.2z.1c.14-j.14)/2},1c:j};h.2X.2n(k)}}1G h.2X=[a.1k({},h.2z)];1a h},56:12(a,b,c){s.56(a,b.3k(),c)}},a.1k(x.3F,12(){12 b(){1a B.1t(11.1g)[0]}12 c(){1a u.1t(11.1g)}12 d(){11.36()}12 e(){11.1j&&(a(11.1j).1z(),11.1l=1r,11.1m=1r,11.1H=1r,11.1j=1r,11.1o={})}12 f(){}12 g(){11.36(),11.51();13 b=11.2e(),c=11.3k();11.1j=a("<2h>").1Y("9h")[0],a(b.1j).66(11.1j),c.2T&&a(b.1j).66(c.2T),c.2o(),a(11.1j).1q({17:0,15:0}),11.7v(),11.52()}12 h(){1a 11.19.1K/(11.19.31+1)}12 i(){13 b=11.3k(),c=b.2o(),d=11.2e(),e=11.2o(),f=11.19.31,g=w.4r.3T(11),h=b.29,i=r.5X(h),j={17:f,15:f};1f(d.19.1l){13 l=g.2X[g.2X.2a-1];"15"==i&&(j.15+=1b.1E(l.1c.18)),"17"==i&&(j.17+=1b.1E(l.1c.18))}13 m=b.1o.19,n=m.1n,o=m.1i;"1m"==d.19.1n.1e&&n&&(n+=o);13 p=e.1H.1c;a(11.1j).1Z(a(11.1H=1x.22("2h")).1Y("9i").1q(k(p))).1q(k(p)),a(1x.3d).1Z(a(11.2W=1x.22("3f"))),q.3J(11.2W,e.1H.1c),q.3p(11.2W);13 s=11.2W.3o("2d");s.2L=11.2x,a(11.1H).1Z(11.2W);28(13 u=f+1,v=0;f>=v;v++)s.2Q=t.2R(11.19.1Q,w.4q(v*(1/u))*(11.19.1K/u)),q.6Z(s,{14:c.1m.1c.14+2*v,18:c.1m.1c.18+2*v,17:j.17-v,15:j.15-v,1n:n+v});1f(b.19.1l){13 x={x:j.15,y:j.17},y=g.2X[0].1c,z=b.19.1l,A=o;A+=.5*z.14;13 B=b.19.1n&&"1m"==b.19.1n.1e?b.19.1n.2u||0:0;B&&(A+=B);13 C=o+B+.5*z.14-.5*y.14,D=1b.1E(n>C?n-C:0),E=b.3B&&b.3B.1l||{x:0,y:0},F=b.3B&&b.3B.5c||{x:0,y:0};1f(A+=1b.1U(D,b.19.1l.1A&&b.19.1l.1A[i&&/^(15|1O)$/.3h(i)?"y":"x"]||0),"17"==i||"1R"==i){1T(h){1h"3O":1h"4g":x.x+=A+E.x-F.x;1B;1h"4b":1h"58":1h"4f":1h"5a":x.x+=.5*c.1m.1c.14+E.x;1B;1h"3P":1h"4e":x.x+=c.1m.1c.14-(A-E.x+F.x)}"1R"==i&&(x.y+=c.1m.1c.18);28(13 v=0,G=g.2X.2a;G>v;v++){s.2Q=t.2R(11.19.1Q,w.4q(v*(1/u))*(11.19.1K/u));13 f=g.2X[v];s.2f(),"17"==i?(s.3s(x.x,x.y-v),s.1d(x.x-.5*f.1c.14,x.y-v),s.1d(x.x,x.y-v-f.1c.18),s.1d(x.x+.5*f.1c.14,x.y-v)):(s.3s(x.x,x.y+v),s.1d(x.x-.5*f.1c.14,x.y+v),s.1d(x.x,x.y+v+f.1c.18),s.1d(x.x+.5*f.1c.14,x.y+v)),s.2g(),s.34()}}1G{1T(h){1h"3R":1h"3Q":x.y+=A+E.y-F.y;1B;1h"4i":1h"5b":1h"4c":1h"59":x.y+=.5*c.1m.1c.18+E.y;1B;1h"4h":1h"4d":x.y+=c.1m.1c.18-(A-E.y+F.y)}"1O"==i&&(x.x+=c.1m.1c.14);28(13 v=0,G=g.2X.2a;G>v;v++){s.2Q=t.2R(11.19.1Q,w.4q(v*(1/u))*(11.19.1K/u));13 f=g.2X[v];s.2f(),"15"==i?(s.3s(x.x-v,x.y),s.1d(x.x-v,x.y-.5*f.1c.14),s.1d(x.x-v-f.1c.18,x.y),s.1d(x.x-v,x.y+.5*f.1c.14)):(s.3s(x.x+v,x.y),s.1d(x.x+v,x.y-.5*f.1c.14),s.1d(x.x+v+f.1c.18,x.y),s.1d(x.x+v,x.y+.5*f.1c.14)),s.2g(),s.34()}}}}12 j(){13 b=11.3k();b.2G,b.1n;13 e=b.2o(),g=(11.2e(),11.19.31),h=a.1k({},e.1m.1c);h.14+=2*g,h.18+=2*g;13 i,k;1f(b.19.1l){13 l=w.4r.3T(11);i=l.2z.1c,k=i.18}13 m=s.5Z(b,h,k),n=m.1c,o=m.1e,h=m.1m.1c,p=m.1m.1e,r=e.1H.1e,t=e.1m.1e,u={17:r.17+t.17-(p.17+g)+11.19.1A.y,15:r.15+t.15-(p.15+g)+11.19.1A.x},v=e.2J,x=e.21.1c,y={17:0,15:0};1f(0>u.17){13 z=1b.2V(u.17);y.17+=z,u.17=0,v.17+=z}1f(0>u.15){13 A=1b.2V(u.15);y.15+=A,u.15=0,v.15+=A}13 B={18:1b.1U(n.18+u.17,x.18+y.17),14:1b.1U(n.14+u.15,x.14+y.15)},C={15:1b.1E(y.15+e.1H.1e.15+e.1m.1e.15+b.1i+b.2m),17:1b.1E(y.17+e.1H.1e.17+e.1m.1e.17+b.1i+b.2m)},D={1D:{1c:B},21:{1c:x,1e:y},1j:{1c:n,1e:u},1H:{1c:n,1e:{17:1b.23(o.17),15:1b.23(o.15)}},1m:{1c:{14:1b.1E(h.14),18:1b.1E(h.18)},1e:{17:1b.23(p.17),15:1b.23(p.15)}},2J:v,2F:{1e:C}};1a D}12 l(){13 b=11.2o(),c=11.3k(),d=11.2e();1f(a(d.1j).1q(k(b.1D.1c)),a(d.4Z).1q(a.1k(k(b.21.1e),k(b.21.1c))),c.2T&&c.2T.1q(k(b.1D.1c)),d.19.1y){13 e=c.2o(),f=b.21.1e,g=e.1y.1e;1f(a(c.1y).1q(k({17:f.17+g.17,15:f.15+g.15})),d.19.1y.1s){13 h=e.2U.1e;a(c.2U.1j).1q(k({17:f.17+h.17,15:f.15+h.15}))}}a(11.1j).1q(a.1k(k(b.1j.1c),k(b.1j.1e))),a(11.1H).1q(k(b.1H.1c)),a(d.38).1q(k(b.2F.1e))}1a{51:f,1z:d,36:e,1P:g,2e:b,3k:c,2o:j,7w:h,7v:i,52:l}}());13 y={3j:{},1t:12(b){1f(!b)1a 1r;13 c=a(b).1X("2p-1V");1a c?11.3j[c]:1r},30:12(a){11.3j[a.1V]=a},1z:12(a){13 b=11.1t(a);b&&(3G 11.3j[b.1V],b.1z())}};a.1k(z.3F,12(){12 b(){1a B.1t(11.1g)[0]}12 c(){1a u.1t(11.1g)}12 d(){1a 11.19.1K/(11.19.31+1)}12 e(){11.36()}12 f(){11.1j&&(a(11.1j).1z(),11.1j=1r)}12 g(){11.36();13 c=(11.2e(),11.3k()),d=c.2o().1y.1c,e=a.1k({},d),f=11.19.31;e.14+=2*f,e.18+=2*f,a(c.1y).6e(a(11.1j=1x.22("2h")).1Y("9j")),a(1x.3d).1Z(a(11.4s=1x.22("3f"))),q.3J(11.4s,e),q.3p(11.4s);13 g=11.4s.3o("2d");g.2L=11.2x,a(11.1j).1Z(11.4s);28(13 h=e.14/2,i=e.18/2,j=d.18/2,k=f+1,l=0;f>=l;l++)g.2Q=t.2R(11.19.1Q,w.4q(l*(1/k))*(11.19.1K/k)),g.2f(),g.26(h,i,j+l,n(0),n(7d),!0),g.2g(),g.34()}1a{1P:g,1z:e,36:f,2e:b,3k:c,7w:d}}());13 B={2A:{},19:{3V:"6f",4C:9k},6X:12(){12 b(){13 b=["2B"];1S.2H.3H&&(b.2n("9l"),a(1x.3d).3U("2B",12(){1a 3t 0})),a.1w(b,12(b,c){a(1x.7x).9m(".3C .7m, .3C .9n-1D",c,12(b){b.9o(),b.9p(),B.6g(a(b.1C).5f(".3C")[0]).1I()})}),a(1N).3U("3J",a.1v(11.7y,11))}1a b}(),7y:12(){11.5g&&(1N.6h(11.5g),11.5g=1r),11.5g=d.4G(a.1v(12(){13 b=11.3I();a.1w(b,12(a,b){b.1e()})},11),9q)},5h:12(b){13 d,c=a(b).1X("2p-1V");1f(!c){13 e=11.6g(a(b).5f(".3C")[0]);e&&e.1g&&(c=a(e.1g).1X("2p-1V"))}1a c&&(d=11.2A[c])?d:3t 0},5P:12(a){13 b;1a d.2j(a)&&(b=11.5h(a)),b&&b.1g},1t:12(b){13 c=[];1f(d.2j(b)){13 e=11.5h(b);e&&(c=[e])}1G a.1w(11.2A,12(d,e){e.1g&&a(e.1g).7z(b)&&c.2n(e)});1a c},6g:12(b){1f(!b)1a 1r;13 c=1r;1a a.1w(11.2A,12(a,d){d.1F("1P")&&d.1j===b&&(c=d)}),c},9r:12(b){13 c=[];1a a.1w(11.2A,12(d,e){e.1g&&a(e.1g).7z(b)&&c.2n(e)}),c},1W:12(b){1f(d.2j(b)){13 c=b,e=11.1t(c)[0];e&&e.1W()}1G a(b).1w(a.1v(12(a,b){13 c=11.1t(b)[0];c&&c.1W()},11))},1I:12(b){1f(d.2j(b)){13 c=11.1t(b)[0];c&&c.1I()}1G a(b).1w(a.1v(12(a,b){13 c=11.1t(b)[0];c&&c.1I()},11))},33:12(b){1f(d.2j(b)){13 c=b,e=11.1t(c)[0];e&&e.33()}1G a(b).1w(a.1v(12(a,b){13 c=11.1t(b)[0];c&&c.33()},11))},4R:12(){a.1w(11.3I(),12(a,b){b.1I()})},2P:12(b){1f(d.2j(b)){13 c=b,e=11.1t(c)[0];e&&e.2P()}1G a(b).1w(a.1v(12(a,b){13 c=11.1t(b)[0];c&&c.2P()},11))},3I:12(){13 b=[];1a a.1w(11.2A,12(a,c){c.1L()&&b.2n(c)}),b},5S:12(b){13 c=!1;1a d.2j(b)&&a.1w(11.3I()||[],12(a,d){1a d.1g==b?(c=!0,!1):3t 0}),c},7A:12(){13 c,b=0;1a a.1w(11.2A,12(a,d){d.2k>b&&(b=d.2k,c=d)}),c},7B:12(){1>=11.3I().2a&&a.1w(11.2A,12(b,c){c.1F("1P")&&!c.19.2k&&a(c.1j).1q({2k:c.2k=+B.19.4C})})},30:12(a){11.2A[a.1V]=a},5i:12(b){13 c=11.5h(b);1f(c){13 d=a(c.1g).1X("2p-1V");3G 11.2A[d],c.1I(),c.1z()}},1z:12(b){d.2j(b)?11.5i(b):a(b).1w(a.1v(12(a,b){11.5i(b)},11))},6Y:12(){a.1w(11.2A,a.1v(12(a,b){b.1g&&!d.1g.5H(b.1g)&&11.5i(b.1g)},11))},5Q:12(a){11.19.3V=a||"6f"},5R:12(a){11.19.4C=a||0},5U:12(){a.1w(11.2A,a.1v(12(a,b){b.1o&&b.1o.2l&&(b.1o.2l.6i(),b.1o.2l=1r),b.27("3c",!1)},11)),i.6S()},6B:12(){12 f(d){13 e;1a e="2s"==a.1p(d)?{1g:c.25&&c.25.1g||b.25.1g,2v:d}:A(a.1k({},b.25),d)}12 g(f){1a b=1S.2C.7C,c=A(a.1k({},b),1S.2C.6j),d=1S.2C.6k.7C,e=A(a.1k({},d),1S.2C.6k.6j),g=h,h(f)}12 h(g){g.21=g.21&&1S.2C[g.21]?g.21:1S.2C[B.19.3V]?B.19.3V:"6f";13 h=g.21?a.1k({},1S.2C[g.21]||1S.2C[B.19.3V]):{},i=A(a.1k({},c),h),j=A(a.1k({},i),g);1f(j.2c){13 k=c.2c||{},l=b.2c;"4t"==a.1p(j.2c)&&(j.2c={3W:k.3W||l.3W,1p:k.1p||l.1p}),j.2c=A(a.1k({},l),j.2c)}1f(j.1m&&"2s"==a.1p(j.1m)&&(j.1m={1Q:j.1m,1K:1}),j.1i){13 m,n=c.1i||{},o=b.1i;m="2y"==a.1p(j.1i)?{2u:j.1i,1Q:n.1Q||o.1Q,1K:n.1K||o.1K}:A(a.1k({},o),j.1i),j.1i=0===m.2u?!1:m}1f(j.1n){13 p;p="2y"==a.1p(j.1n)?{2u:j.1n,1e:c.1n&&c.1n.1e||b.1n.1e}:A(a.1k({},b.1n),j.1n),j.1n=0===p.2u?!1:p}13 q,s=s=j.1u&&j.1u.1C||"2s"==a.1p(j.1u)&&j.1u||c.1u&&c.1u.1C||"2s"==a.1p(c.1u)&&c.1u||b.1u&&b.1u.1C||b.1u,t=j.1u&&j.1u.1D||c.1u&&c.1u.1D||b.1u&&b.1u.1D||B.2r.6l(s);1f(j.1u?"2s"==a.1p(j.1u)?q={1C:j.1u,1D:B.2r.7D(j.1u)}:(q={1D:t,1C:s},j.1u.1D&&(q.1D=j.1u.1D),j.1u.1C&&(q.1C=j.1u.1C)):q={1D:t,1C:s},"2M"==j.1C){13 u=r.2I(q.1C);q.1C="1J"==u?q.1C.61(/(15|1O)/,"2t"):q.1C.61(/(17|1R)/,"2t")}j.1u=q;13 v;1f("2M"==j.1C?(v=a.1k({},b.1A),a.1k(v,1S.2C.6j.1A||{}),g.21&&a.1k(v,(1S.2C[g.21]||1S.2C[B.19.3V]).1A||{}),v=B.2r.7E(b.1A,b.1u,q.1C,!0),g.1A&&(v=a.1k(v,g.1A||{})),j.3X=0):v={x:j.1A.x,y:j.1A.y},j.1A=v,j.1y&&j.7F){13 w=a.1k({},1S.2C.6k[j.7F]),x=A(a.1k({},e),w);1f(x.2q&&a.1w(["6b","6c"],12(b,c){13 f=x.2q[c],g=e.2q&&e.2q[c];1f(f.1m){13 h=g&&g.1m;1f("2y"==a.1p(f.1m))f.1m={1Q:h&&h.1Q||d.2q[c].1m.1Q,1K:f.1m};1G 1f("2s"==a.1p(f.1m)){13 i=h&&"2y"==a.1p(h.1K)&&h.1K||d.2q[c].1m.1K;f.1m={1Q:f.1m,1K:i}}1G f.1m=A(a.1k({},d.2q[c].1m),f.1m)}1f(f.1i){13 j=g&&g.1i;f.1i="2y"==a.1p(f.1i)?{1Q:j&&j.1Q||d.2q[c].1i.1Q,1K:f.1i}:A(a.1k({},d.2q[c].1i),f.1i)}}),x.1s){13 z=e.1s&&e.1s.3D&&e.1s.3D==5x?e.1s:d.1s;x.1s.3D&&x.1s.3D==5x&&(z=A(z,x.1s)),x.1s=z}j.1y=x}1f(j.1s){13 C;C="4t"==a.1p(j.1s)?c.1s&&"4t"==a.1p(c.1s)?b.1s:c.1s?c.1s:b.1s:A(a.1k({},b.1s),j.1s||{}),"2y"==a.1p(C.1A)&&(C.1A={x:C.1A,y:C.1A}),j.1s=C}1f(j.1l){13 D={};D="4t"==a.1p(j.1l)?A({},b.1l):A(A({},b.1l),a.1k({},j.1l)),"2y"==a.1p(D.1A)&&(D.1A={x:D.1A,y:D.1A}),j.1l=D}1f(j.2Y&&("2s"==a.1p(j.2Y)?j.2Y={5j:j.2Y,7G:!0}:"4t"==a.1p(j.2Y)&&(j.2Y=j.2Y?{5j:"4T",7G:!0}:!1)),j.25&&"2B-9s"==j.25&&(j.7H=!0,j.25=!1),j.25)1f(a.71(j.25)){13 E=[];a.1w(j.25,12(a,b){E.2n(f(b))}),j.25=E}1G j.25=[f(j.25)];1a j.2K&&"2s"==a.1p(j.2K)&&(j.2K=[""+j.2K]),j.2m=0,j.1M&&(1N.6m||(j.1M=!1)),j}13 b,c,d,e;1a g}()};B.2r=12(){12 c(c){13 d=r.2N(c),e=d[1],f=d[2],g=r.2I(c),h=a.1k({1J:!0,2b:!0},20[1]||{});1a"1J"==g?(h.2b&&(e=b[e]),h.1J&&(f=b[f])):(h.2b&&(f=b[f]),h.1J&&(e=b[e])),e+f}12 f(a){13 d=r.2N(a);1a c(d[1]+b[d[2]])}12 h(b,c){a(b.1j).1q({17:c.17+"2w",15:c.15+"2w"})}12 j(a,b,d,e){13 g=y(a,b,d,e),h=d&&"2s"==7I d.1p?d.1p:"";1f(/9t$/.3h(h),1===g.3Y.3Z)1a l(a,g),g;13 m=b,n=e,o={1J:!g.3Y.1J,2b:!g.3Y.2b},p={1J:!1,2b:!1},q=r.2I(b);1a((p.2b="1J"==q&&o.2b)||(p.1J="2b"==q&&o.1J))&&(m=c(b,p),n=c(e,p),g=y(a,m,d,n),1===g.3Y.3Z)?(l(a,g),g):(g=k(g,a),l(a,g),g)}12 k(a,b){13 c=z(b),d=c.1c,e=c.1e,f=u.1t(b.1g).1o.1u[a.1u.1D].1D.1c,g=a.1e,h={17:0,15:0,3A:[]};1a e.15>g.15&&(h.15=e.15-g.15,h.3A.2n("15"),a.1e.15=e.15),e.17>g.17&&(h.17=g.17-e.17,h.3A.2n("17"),a.1e.17=e.17),e.15+d.14<g.15+f.14&&(h.15=e.15+d.14-(g.15+f.14),h.3A.2n("1O"),a.1e.15=e.15+d.14-f.14),e.17+d.18<g.17+f.18&&(h.17=e.17+d.18-(g.17+f.18),h.3A.2n("1R"),a.1e.17=e.17+d.18-f.18),a.7J=h,a}12 l(a,b){a.5e(b.1u.1D,b.3Y.4l,b.7J),h(a,b.1e)}12 m(a){1a a&&(/^2M|2B|3H$/.3h("2s"==7I a.1p&&a.1p||"")||a.5G>=0)}12 n(a,b,c){1a a>=b&&c>=a}12 o(a,b,c,d){13 e=n(a,c,d),f=n(b,c,d);1f(e&&f)1a b-a;1f(e&&!f)1a d-a;1f(!e&&f)1a b-c;13 g=n(c,a,b),h=n(d,a,b);1a g&&h?d-c:g&&!h?b-c:!g&&h?d-a:0}12 q(a,b){1a o(a.1e.15,a.1e.15+a.1c.14,b.1e.15,b.1e.15+b.1c.14)*o(a.1e.17,a.1e.17+a.1c.18,b.1e.17,b.1e.17+b.1c.18)}12 s(a,b){13 c=a.1c.14*a.1c.18;1a c?q(a,b)/c:0}12 t(a,b){13 c=r.2N(b),d=r.2I(b),e={15:0,17:0};1f("1J"==d){1T(c[2]){1h"2t":1h"2S":e.15=.5*a.14;1B;1h"1O":e.15=a.14}"1R"==c[1]&&(e.17=a.18)}1G{1T(c[2]){1h"2t":1h"2S":e.17=.5*a.18;1B;1h"1R":e.17=a.18}"1O"==c[1]&&(e.15=a.14)}1a e}12 v(b){13 c=d.1g.4L(b),e=d.1g.4H(b),f={17:a(1N).4I(),15:a(1N).4J()};1a c.15+=-1*(e.15-f.15),c.17+=-1*(e.17-f.17),c}12 y(b,e,f,g){13 h,i,j,k=u.1t(b.1g),l=k.19,n=l.1A,o=m(f);1f(o||!f){1f(j={14:24,18:24},o){13 p=d.5F(f);h={17:p.y-.5*j.18+6,15:p.x-.5*j.14+6}}1G{13 q=b.1o.2v;h={17:(q?q.y:0)-.5*j.18+6,15:(q?q.x:0)-.5*j.14+6}}b.1o.2v={x:h.15,y:h.17}}1G h=v(f),j={14:a(f).7K(),18:a(f).7L()};1f(l.1l&&"2M"!=l.1C){13 y=r.2N(g),A=r.2N(e),C=r.2I(g),D=k.1o.19,E=k.4p().1i.1c,F=D.1n,G=D.1i,H=F&&"1m"==l.1n.1e?F:0,I=F&&"1i"==l.1n.1e?F:F+G,J=G+H+.5*l.1l.14-.5*E.14,K=I>J?I-J:0;4u=1b.1E(G+H+.5*l.1l.14+K+l.1l.1A["1J"==C?"x":"y"]),"1J"==C&&"15"==y[2]&&"15"==A[2]||"1O"==y[2]&&"1O"==A[2]?(j.14-=2*4u,h.15+=4u):("2b"==C&&"17"==y[2]&&"17"==A[2]||"1R"==y[2]&&"1R"==A[2])&&(j.18-=2*4u,h.17+=4u)}i=a.1k({},h);13 L=o?c(l.1u.1D):l.1u.1C,M=t(j,L),N=t(j,g);({17:h.17+M.17+n.y,15:h.15+M.15+n.x}),h={15:h.15+N.15,17:h.17+N.17};13 P=a.1k({},n);P=x(P,L,g,"2M"==k.19.1C),h.17+=P.y,h.15+=P.x;13 k=u.1t(b.1g),Q=k.1o.1u,R=a.1k({},Q[e]),S={x:0,y:0},y=r.2N(g);1f("2t"!=y[2]){13 C=C=r.2I(g),T=B.2r.6l(g,"2b"==C?{1J:!0,2b:!1}:{1J:!1,2b:!0});e==T&&(S.y=k.3B.5c.y,S.x=k.3B.5c.x)}13 U={17:h.17-R.2J.17-S.y,15:h.15-R.2J.15-S.x};R.1D.1e=U;13 V={1J:!0,2b:!0},W={x:0,y:0};1f(b.19.2Y){13 X=z(b),Y=b.19.1s?w.1t(b.1g):k,Z=Y.2o().1D.1c;V.3Z=s({1c:Z,1e:U},X),1>V.3Z&&((U.15<X.1e.15||U.15+Z.14>X.1e.15+X.1c.14)&&(V.1J=!1,W.x=U.15<X.1e.15?U.15-X.1e.15:U.15+Z.14-(X.1e.15+X.1c.14)),(U.17<X.1e.17||U.17+Z.18>X.1e.17+X.1c.18)&&(V.2b=!1,W.y=U.17<X.1e.17?U.17-X.1e.17:U.17+Z.18-(X.1e.17+X.1c.18)))}1G V.3Z=1;V.4l=W;13 $=Q[e].1H,7M=s({1c:j,1e:i},{1c:$.1c,1e:{17:U.17+$.1e.17,15:U.15+$.1e.15}});1a{1e:U,3Z:{1C:7M},3Y:V,1u:{1D:e,1C:g}}}12 z(b){13 c={17:a(1N).4I(),15:a(1N).4J()},e=b.19,f=e.1C;("2M"==f||"4F"==f)&&(f=b.1g);13 g=a(f).5f(e.2Y.5j).7i()[0];1f(!g||"4T"==e.2Y.5j)1a{1c:p.4T(),1e:c};13 h=d.1g.4L(g),i=d.1g.4H(g);1a h.15+=-1*(i.15-c.15),h.17+=-1*(i.17-c.17),{1c:{14:a(g).5V(),18:a(g).5W()},1e:h}}13 b={15:"1O",1O:"15",17:"1R",1R:"17",2t:"2t",2S:"2S"};e.3m&&9>e.3m||e.4M&&2>e.4M||e.5M&&9u>e.5M;13 x=12(){13 a=[[-1,-1],[0,-1],[1,-1],[-1,0],[0,0],[1,0],[-1,1],[0,1],[1,1]],b={3R:0,3O:0,4b:1,58:1,3P:2,3Q:2,4c:5,59:5,4d:8,4e:8,4f:7,5a:7,4g:6,4h:6,4i:3,5b:3};1a 12(c,d,e,f){13 g=a[b[d]],h=a[b[e]],i=[1b.65(.5*1b.2V(g[0]-h[0]))?-1:1,1b.65(.5*1b.2V(g[1]-h[1]))?-1:1];1a r.35(d)||!r.35(e)||f||("1J"==r.2I(e)?i[0]=0:i[1]=0),{x:i[0]*c.x,y:i[1]*c.y}}}();1a{1t:y,4P:j,6l:c,7D:f,7N:v,7E:x,6n:m}}(),B.2r.4S={x:0,y:0},a(1x).6W(12(){13 b=B.2r;a(1x).3U("5k",12(a){b.4S={x:a.5G,y:a.6H}})}),B.53=12(){12 b(){a(1x.3d).1Z(a(1x.22("2h")).1Y("9v").1Z(a(1x.22("2h")).1Y("3C").1Z(a(11.1j=1x.22("2h")).1Y("7O"))))}12 c(b){1a{14:a(b).5V(),18:a(b).5W()}}12 e(b){13 d=c(b),e=b.4K;1a e&&a(e).1q({14:d.14+"2w"})&&c(b).18>d.18&&d.14++,a(e).1q({14:"62%"}),d}12 f(b,c,e){11.1j||11.1P();13 f=b.19,g=a.1k({1M:!1},20[3]||{});!f.7P&&!d.2j(c)||a(c).1X("7Q")||(f.7P&&"2s"==a.1p(c)&&(b.39=a("#"+c)[0],c=b.39),!b.40&&c&&d.1g.5H(c)&&(a(b.39).1X("7R",a(b.39).1q("7S")),b.40=1x.22("2h"),a(b.39).6e(a(b.40).1I())));13 h=1x.22("2h");a(11.1j).1Z(a(h).1Y("7h 9w").1Z(c)),d.2j(c)&&a(c).1W(),f.21&&a(h).1Y("9x"+b.19.21);13 i=a(h).67("7T[4m]").9y(12(){1a!(a(11).3g("18")&&a(11).3g("14"))});1f(i.2a>0&&!b.1F("3E")){b.27("3E",!0),f.1M&&(g.1M||b.1M||(b.1M=b.6o(f.1M)),b.1F("1L")&&(b.1e(),a(b.1j).1W()),b.1M.6p());13 j=0,k=1b.1U(9z,9A*(i.2a||0));b.2i("3E"),b.41("3E",a.1v(12(){i.1w(12(){11.6q=12(){}}),j>=i.2a||(11.5l(b,h),e&&e())},11),k),a.1w(i,a.1v(12(c,d){13 f=3q 9B;f.6q=a.1v(12(){f.6q=12(){};13 c=f.14,g=f.18,k=a(d).3g("14"),l=a(d).3g("18");k&&l||(!k&&l?(c=1b.23(l*c/g),g=l):!l&&k&&(g=1b.23(k*g/c),c=k),a(d).3g({14:c,18:g}),j++),j==i.2a&&(b.2i("3E"),b.1M&&(b.1M.1z(),b.1M=1r),b.1F("1L")&&a(b.1j).1I(),11.5l(b,h),e&&e())},11),f.4m=d.4m},11))}1G 11.5l(b,h),e&&e()}12 g(b,c){13 d=e(c),f={14:d.14-(2O(a(c).1q("2m-15"))||0)-(2O(a(c).1q("2m-1O"))||0),18:d.18-(2O(a(c).1q("2m-17"))||0)-(2O(a(c).1q("2m-1R"))||0)};b.19.3i&&"2y"==a.1p(b.19.3i)&&f.14>b.19.3i&&(a(c).1q({14:b.19.3i+"2w"}),d=e(c)),b.1o.2G=d,a(b.38).7U(c)}1a{1P:b,42:f,5l:g,69:e}}(),a.1k(C.3F,12(){12 b(a,b,c){11.1o.3b[a]=d.4G(b,c)}12 c(a){1a 11.1o.3b[a]}12 e(a){11.1o.3b[a]&&(1N.6h(11.1o.3b[a]),3G 11.1o.3b[a])}12 f(){a.1w(11.1o.3b,12(a,b){1N.6h(b)}),11.1o.3b=[]}12 g(b,c,d,e){c=c;13 f=a.1v(d,e||11);11.1o.5A.2n({1g:b,7V:c,7W:f}),a(b).3U(c,f)}12 h(){a.1w(11.1o.5A,12(b,c){a(c.1g).7X(c.7V,c.7W)})}12 j(a,b){11.1o.2q[a]=b}12 l(a){1a 11.1o.2q[a]}12 m(){11.2D(11.1g,"4o",11.5m),11.2D(11.1g,"54",a.1v(12(a){11.6r(a)},11)),11.19.2K&&a.1w(11.19.2K,a.1v(12(b,c){13 d=!1;"2B"==c&&(11.19.25&&a.1w(11.19.25,12(a,b){1a"4F"==b.1g&&"2B"==b.2v?(d=!0,!1):3t 0}),11.27("5B",d)),11.2D(11.1g,c,"2B"==c?d?11.33:11.1W:a.1v(12(){11.7Y()},11))},11)),11.19.25?a.1w(11.19.25,a.1v(12(b,c){13 d;1T(c.1g){1h"4F":1f(11.1F("5B")&&"2B"==c.2v)1a;d=11.1g;1B;1h"1C":d=11.1C}d&&11.2D(d,c.2v,"2B"==c.2v?11.1I:a.1v(12(){11.6s()},11))},11)):11.19.7Z&&11.19.2K&&!a.6t("2B",11.19.2K)>-1&&11.2D(11.1g,"54",a.1v(12(){11.2i("1W")},11));13 b=!1;!11.19.9C&&11.19.2K&&((b=a.6t("5k",11.19.2K)>-1)||a.6t("5n",11.19.2K)>-1)&&"2M"==11.1C&&11.2D(11.1g,b?"5k":"5n",12(a){11.1F("4E")&&11.1e(a)})}12 n(){11.2D(11.1j,1S.2H.3H?"5n":"4o",11.5m),11.2D(11.1j,"54",11.6r),11.2D(11.1j,1S.2H.3H?"5n":"4o",a.1v(12(){11.5o("4v")||11.1W()},11)),11.19.25&&a.1w(11.19.25,a.1v(12(b,c){13 d;1T(c.1g){1h"1D":d=11.1j}d&&11.2D(d,c.2v,c.2v.3e(/^(2B|5k|4o)$/)?11.1I:a.1v(12(){11.6s()},11))},11))}12 o(a,b,c){13 d=u.1t(11.1g);d&&d.5e(a,b,c)}12 p(a){13 b=u.1t(11.1g);b&&b.4n(a)}12 q(){11.4n(11.19.1u.1D)}12 r(){a(11.1j=1x.22("2h")).1Y("3C"),11.80()}12 s(){11.1P();13 a=u.1t(11.1g);a?a.1P():(3q v(11.1g),11.27("4E",!0))}12 t(){11.1F("1P")||(a(1x.3d).1Z(a(11.1j).1q({15:"-5p",17:"-5p",2k:11.2k}).1Z(a(11.4Z=1x.22("2h")).1Y("9D")).1Z(a(11.38=1x.22("2h")).1Y("7O"))),a(11.1j).1Y("9E"+11.19.21),11.19.7H&&(a(11.1g).1Y("81"),11.2D(1x.7x,"2B",a.1v(12(b){1f(11.1L()){13 c=a(b.1C).5f(".3C, .81")[0];(!c||c&&c!=11.1j&&c!=11.1g)&&11.1I()}},11))),1S.2H.48&&(11.19.4w||11.19.3X)&&(11.5q(11.19.4w),a(11.1j).1Y("6u")),11.82(),11.27("1P",!0),B.30(11))}12 w(){13 c;11.2F,11.40&&11.39&&((c=a(11.39).1X("7R"))&&a(11.39).1q({7S:c}),a(11.40).6e(11.39).1z(),11.40=1r)}12 x(){d.44(a.1v(12(){11.83()},11)),11.84(),11.6v(),d.44(a.1v(12(){a(11.1j).67("7T[4m]").7X("9F")},11)),u.1z(11.1g),11.1F("1P")&&11.1j&&(a(11.1j).1z(),11.1j=1r);13 c,b="5z";(c=a(11.1g).1X(b))&&a(11.1g).3g("5y",c).85("5z"),a(11.1g).85("2p-1V")}12 y(b){13 c=a.1k({4x:11.19.4x,1M:!1},20[1]||{});11.1P(),11.1F("1L")&&a(11.1j).1I(),B.53.42(11,b,a.1v(12(){13 b=11.1F("1L");b||11.27("1L",!0),11.86(),b||11.27("1L",!1),11.1F("1L")&&(a(11.1j).1I(),11.1e(),11.5r(),a(11.1j).1W()),11.27("3c",!0),c.4x&&c.4x(11.38.4y,11.1g),c.4z&&c.4z()},11),{1M:c.1M})}12 z(b){13 c,d={47:11.2F,1p:11.19.2c.1p,1X:11.19.2c.1X||{},87:11.19.2c.87||"7U"};1f(!(11.1F("2l")||11.19.2c.3W&&11.1F("3c"))){1f(11.19.2c.3W&&(c=i.1t(d)))1a 11.6w(c,{4z:a.1v(12(){11.1F("1L")&&11.19.43&&11.19.43(11.38.4y,11.1g)},11)}),3t 0;11.27("2l",!0),11.19.1M&&(11.1M?11.1M.6p():(11.1M=11.6o(11.19.1M),11.27("3c",!1)),11.1e(b)),11.1o.2l&&(11.1o.2l.6i(),11.1o.2l=1r),11.1o.2l=a.2c(a.1k({},d,{9G:a.1v(12(b,c,e){0!==e.9H&&(i.4P(d,e.4O),11.6w(e.4O,{4z:a.1v(12(){11.27("2l",!1),11.1F("1L")&&11.19.43&&11.19.43(11.38.4y,11.1g),11.1M&&(11.1M.1z(),11.1M=1r)},11)}))},11)}))}}12 A(b){13 c=a.1k({1M:11.19.1M&&11.1M},20[1]||{});11.42(b,c)}12 C(){13 b=1x.22("2h");a(b).1X("7Q",!0);13 c=6m.4Q(b,a.1k({},20[0]||{})),d=6m.5Y(b);1a a(b).1q(k(d)),11.42(b,{4x:!1,4z:12(){c.6p()}}),c}12 E(){1f(11.1F("1P")&&!11.19.2k){13 b=B.7A();b&&b!=11&&11.2k<=b.2k&&a(11.1j).1q({2k:11.2k=b.2k+1})}}12 F(){13 a=u.1t(11.1g);a&&(a.2P(),11.1L()&&11.1e())}12 G(a){1f(1S.2H.48){a=a||0;13 b=11.1j.9I;b.9J=a+"5s",b.9K=a+"5s",b.9L=a+"5s",b.9M=a+"5s"}}12 H(b){11.2i("1I"),11.2i("4v"),11.1F("1L")||11.5o("1W")||11.41("1W",a.1v(12(){11.2i("1W"),11.1W(b)},11),11.19.7Z||1)}12 I(b){1f(11.2i("1I"),11.2i("4v"),!11.1L()){1f("12"==a.1p(11.2F)||"12"==a.1p(11.1o.5t)){"12"!=a.1p(11.1o.5t)&&(11.1o.5t=11.2F);13 c=11.1o.5t(11.1g)||!1;1f(c!=11.1o.5C&&(11.1o.5C=c,11.27("3c",!1),11.6v()),11.2F=c,!c)1a}11.19.9N&&B.4R(),11.27("1L",!0),11.19.2c?11.88(b):11.1F("3c")||11.42(11.2F),11.1F("4E")&&11.1e(b),11.5r(),11.19.5u&&d.44(a.1v(12(){11.5m()},11)),"12"==a.1p(11.19.43)&&(!11.19.2c||11.19.2c&&11.19.2c.3W&&11.1F("3c"))&&11.19.43(11.38.4y,11.1g),1S.2H.48&&(11.19.4w||11.19.3X)&&(11.5q(11.19.4w),a(11.1j).1Y("89").8a("6u")),a(11.1j).1W()}}12 J(){11.2i("1W"),11.1F("1L")&&(11.27("1L",!1),1S.2H.48&&(11.19.4w||11.19.3X)?(11.5q(11.19.3X),a(11.1j).8a("89").1Y("6u"),11.41("4v",a.1v(11.6x,11),11.19.3X)):11.6x(),11.1o.2l&&(11.1o.2l.6i(),11.1o.2l=1r,11.27("2l",!1)))}12 K(){11.1F("1P")&&(a(11.1j).1q({15:"-5p",17:"-5p"}),B.7B(),"12"!=a.1p(11.19.8b)||11.1M||11.19.8b(11.38.4y,11.1g))}12 L(){11.2i("1W"),!11.5o("1I")&&11.1F("1L")&&11.41("1I",a.1v(12(){11.2i("1I"),11.2i("4v"),11.1I()},11),11.19.9O||1)}12 M(a){11[11.1L()?"1I":"1W"](a)}12 N(){1a 11.1F("1L")}12 O(){11.27("4D",!0),11.1F("1L")&&11.5r(),11.19.5u&&11.2i("6y")}12 P(){11.27("4D",!1),11.19.5u&&11.41("6y",a.1v(12(){11.2i("6y"),11.1F("4D")||11.1I()},11),11.19.5u)}13 D=12(b){1f(11.1L()){13 c;1f("2M"==11.19.1C){13 e=B.2r.6n(b),f=B.2r.4S;1f(e)f.x||f.y?(11.1o.2v={x:f.x,y:f.y},c=1r):c=b;1G{1f(f.x||f.y)11.1o.2v={x:f.x,y:f.y};1G 1f(!11.1o.2v){13 g=B.2r.7N(11.1g);11.1o.2v={x:g.15,y:g.17}}c=1r}}1G c=11.1C;1f(B.2r.4P(11,11.19.1u.1D,c,11.19.1u.1C),b&&B.2r.6n(b)){13 h={14:a(11.1j).7K(),18:a(11.1j).7L()},i=d.5F(b),g=d.1g.4L(11.1j);i.x>=g.15&&i.x<=g.15+h.14&&i.y>=g.17&&i.y<=g.17+h.18&&d.44(a.1v(12(){11.2i("1I")},11))}}};1a{1P:t,6E:r,86:s,80:m,82:n,1W:I,1I:J,6x:K,33:M,1L:N,7Y:H,6s:L,5q:G,27:j,1F:l,5m:O,6r:P,5o:c,41:b,2i:e,84:f,2D:g,83:h,5e:o,4n:p,9P:q,2P:F,42:y,88:z,6w:A,6o:C,1e:D,5r:E,6v:w,1z:x}}()),1S.3p()})(46);`,62,610,"|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||this|function|var|width|left||top|height|options|return|Math|dimensions|lineTo|position|if|element|case|border|container|extend|stem|background|radius|_cache|type|css|null|shadow|get|hook|proxy|each|document|closeButton|remove|offset|break|target|tooltip|ceil|getState|else|bubble|hide|horizontal|opacity|visible|spinner|window|right|build|color|bottom|Tipped|switch|max|uid|show|data|addClass|append|arguments|skin|createElement|round||hideOn|arc|setState|for|_hookPosition|length|vertical|ajax||getTooltip|beginPath|closePath|div|clearTimer|isElement|zIndex|xhr|padding|push|getOrderLayout|tipped|states|Position|string|middle|size|event|px|_globalAlpha|number|box|tooltips|click|Skins|setEvent|180|content|contentDimensions|support|getOrientation|anchor|showOn|globalAlpha|mouse|split|parseInt|refresh|fillStyle|hex2fill|center|iframeShim|closeButtonShadow|abs|bubbleCanvas|blurs|containment|PI|add|blur|scripts|toggle|fill|isCenter|cleanup|cornerOffset|contentElement|inlineContent|_stemCorrection|timers|updated|body|match|canvas|attr|test|maxWidth|shadows|getSkin|_adjustment|IE|indexOf|getContext|init|new|devicePixelRatio|moveTo|void|charAt|toLowerCase|diameter|hookPosition|layout|stemLayout|sides|_corrections|t_Tooltip|constructor|preloading_images|prototype|delete|touch|getVisible|resize|x1|y1|x2|y2|topleft|topright|righttop|lefttop|math|getLayout|bind|defaultSkin|cache|fadeOut|contained|overlap|inlineMarker|setTimer|update|onShow|defer||jQuery|url|cssTransitions|items|createFillStyle|topmiddle|rightmiddle|rightbottom|bottomright|bottommiddle|bottomleft|leftbottom|leftmiddle|regex|getBorderDimensions|correction|src|setHookPosition|mouseenter|getStemLayout|transition|Stem|closeButtonCanvas|boolean|sideOffset|fadeTransition|fadeIn|afterUpdate|firstChild|callback|cos|000|startingZIndex|active|skinned|self|delay|cumulativeScrollOffset|scrollTop|scrollLeft|parentNode|cumulativeOffset|Gecko|Chrome|responseText|set|create|hideAll|mouseBuffer|viewport|min|G_vmlCanvasManager|getCenterBorderDimensions|substring|skins|skinElement||prepare|order|UpdateQueue|mouseleave||rotate|borderRadius|topcenter|rightcenter|bottomcenter|leftcenter|corner|corrections|setHookPositionAndStemCorrection|closest|_resizeTimer|_getTooltip|_remove|selector|mousemove|_updateTooltip|setActive|touchmove|getTimer|10000px|setFadeDuration|raise|ms|contentFunction|hideAfter|console|in|Object|title|tipped_restore_title|events|toggles|fnCallContent|call|apply|pointer|pageX|isAttached|RegExp|parseFloat|Opera|opera|WebKit|required|available|findElement|setDefaultSkin|setStartingZIndex|isVisibleByElement|undefined|clearAjaxCache|innerWidth|innerHeight|getSide|getDimensions|getBubbleLayout|nullifyCornerOffset|replace|100|defaultCloseButton|hoverCloseButton|floor|prepend|find|auto|getMeasureElementDimensions|drawCloseButtonState|default|hover|_drawBackgroundPath|before|dark|getByTooltipElement|clearTimeout|abort|reset|CloseButtons|getInversedPosition|Spinners|isPointerEvent|insertSpinner|play|onload|setIdle|hideDelayed|inArray|t_hidden|_restoreInlineContent|afterAjaxUpdate|_hide|idle|warn|_stemPosition|createOptions|getAttribute|getElementById|_preBuild|Array|concat|pageY|version|AppleWebKit|MobileSafari|check|pow|Za|checked|notified|toUpperCase|param|clear|try|DocumentTouch|catch|ready|startDelegating|removeDetached|drawRoundedRectangle|fillRect|isArray|Gradient|addColorStops|positions|toOrientation|side|toDimension|isCorner|atan|red|green|blue|360|drawBubble|drawCloseButton|createHookCache|t_ContentContainer|first|25000px|setStemCorrection|setAdjustment|t_Close|closeButtonShift|closeButtonMouseover|closeButtonMouseout|CloseButton|stemOffset|backgroundRadius|_drawBorderPath|setGlobalAlpha|drawBackground|getBlurOpacity|documentElement|onWindowResize|is|getHighestTooltip|resetZ|base|getTooltipPositionFromTarget|adjustOffsetBasedOnHooks|closeButtonSkin|flip|hideOnClickOutside|typeof|adjustment|outerWidth|outerHeight|_|getAbsoluteOffset|t_Content|inline|isSpinner|tipped_restore_inline_display|display|img|html|eventName|handler|unbind|showDelayed|showDelay|createPreBuildObservers|t_hideOnClickOutside|createPostBuildObservers|clearEvents|clearTimers|removeData|_buildSkin|dataType|ajaxUpdate|t_visible|removeClass|onHide|log|sqrt|object|setAttribute|slice|wrap|nodeType|setTimeout|do|while|exec|attachEvent|MSIE|KHTML|rv|Apple|Mobile|Safari|navigator|userAgent|fn|jquery|z_|z0|requires|_t_uid_|ontouchstart|instanceof|WebKitTransitionEvent|TransitionEvent|OTransitionEvent|createEvent|scale|initElement|drawPixelArray|createLinearGradient|addColorStop|spacing|rgba|join|fff|255|hue|saturation|brightness|0123456789abcdef|hex2rgb|getSaturatedBW|init_|t_Bubble||iframe|t_iframeShim|frameBorder|javascript|15000px|t_CloseButtonShift|lineCap|t_CloseState|translate|stemCorrection|270|lineWidth|sin|setOpacity|getCenterBorderDimensions2|acos|t_Shadow|t_ShadowBubble|t_CloseButtonShadow|999999|touchstart|delegate|close|preventDefault|stopPropagation|200|getBySelector|outside|move|530|t_UpdateQueue|t_clearfix|t_Content_|filter|8e3|750|Image|fixed|t_Skin|t_Tooltip_|load|success|status|style|MozTransitionDuration|webkitTransitionDuration|OTransitionDuration|transitionDuration|hideOthers|hideDelay|resetHookPosition".split("|"),0,{}));ogame.messagecounter={countData:{chat:0,messages:0,buddy:0},newChats:Array(),type_chat:10,type_message:11,type_buddy:12,currentLinkSelector:null,currentType:0,currentPlayer:null,sumNewChatMessages:0,initialize:function(e,t){var a=ogame.messagecounter;if(typeof t>"u"&&e!==a.type_chat&&(a.currentPlayer=0),typeof t>"u"&&e==a.type_chat)return!1;switch(typeof t<"u"&&(a.currentPlayer=t),a.currentType=e,e){case a.type_chat:a.currentLinkSelector=$("a.comm_menu.chat");break;case a.type_message:a.currentLinkSelector=$("a.comm_menu.messages");break;case a.type_buddy:a.currentLinkSelector=$("a.comm_menu.buddies");break;default:return!1}a.update()},initChatCounter:function(e){var t=ogame.messagecounter;t.currentLinkSelector=$("a.comm_menu.chat"),t.currentType=t.type_chat,t.setCount(e),t.update()},update:function(e){var t=ogame.messagecounter,a;e===void 0?a=chatLoca.X_NEW_CHATS:a=e,changeTooltip(t.currentLinkSelector,a.replace("#+#",t.getCount()))},resetCounterByType:function(e,t){var a=ogame.messagecounter,n=a.getIconSelectorByType(e),r;t===void 0?r=chatLoca.X_NEW_CHATS:r=t,changeTooltip(n,r.replace("#+#",0))},getCountSelectorByType:function(e){var t=ogame.messagecounter,a="";switch(e){case t.type_chat:a=$("a.comm_menu.chat .new_msg_count");break;case t.type_message:a=$("a.comm_menu.messages .new_msg_count");break;case t.type_buddy:a=$("a.comm_menu.buddies .new_msg_count")}return a},getIconSelectorByType:function(e){var t=ogame.messagecounter,a="";switch(e){case t.type_chat:a=$("a.comm_menu.chat");break;case t.type_message:a=$("a.comm_menu.messages");break;case t.type_buddy:a=$("a.comm_menu.buddies")}return a},getCounterHtml:function(e){var t='<span class="new_msg_count">'+e+"</span>";return t},getCount:function(){var e=ogame.messagecounter;switch(e.currentType){case e.type_chat:return e.countData.chat;case e.type_message:return e.countData.messages;case e.type_buddy:return e.countData.buddy}},setCount:function(e){var t=ogame.messagecounter;switch(t.currentType){case t.type_chat:t.countData.chat=e;break;case t.type_message:t.countData.messages=e;break;case t.type_buddy:t.countData.buddy=e;break}},updateCountData:function(){var e=ogame.messagecounter;if(e.isOpen())e.setCount(0);else{if(e.shouldAddCounter())var t=1;else{var a=e.getCountSelectorByType(e.currentType),t=a.html();t=parseInt(t)+1}e.setCount(t)}},shouldAddCounter:function(){var e=ogame.messagecounter,t=e.getCountSelectorByType(e.currentType),a=t.html(),n=!1;return typeof a>"u"&&(n=!0),n},setNewCounter:function(e,t){e.html(t)},isOpen:function(){var e=ogame.messagecounter,t=!1;switch(e.currentType){case e.type_chat:t=ogame.chat.isOpen(e.currentPlayer);break;case e.type_message:t=location.href.indexOf("page=messages")>-1;break;case e.type_buddy:t=location.href.indexOf("page=buddies")>-1;break}return t}};ogame.messagemarker={type_chatbar:10,type_chattab:11,action_remove:20,action_add:21,currentCount:"",currentSelector:"",currentPlayernameObject:"",currentListPlayernameObject:"",currentPartnerId:"",currentListItemSelector:"",totalNewMessages:0,playerlist:new Array,newsInitialized:!1,effect:"none",initialize:function(){$(".new_msg_count[data-playerid]").each(function(){var e=ogame.messagemarker,t=$(this).data("playerid");t&&$.inArray(t,e.playerlist)===-1&&(e.playerlist.push(t),e.setPartnerId(t),e.updateNewMarker())}),ogame.messagemarker.effect="highlight"},initMarker:function(e){var t=ogame.messagemarker,a=0;return $.each(e,function(n,r){t.setPartnerId(r);var s=$('.new_msg_count[data-playerid="'+r+'"]').data("new-messages");s!=null&&s>0&&(t.setSelectorByType(t.type_chatbar),t.mark(t.currentSelector,t.currentPlayernameObject,s),t.mark(t.currentListItemSelector,t.currentListPlayernameObject,s),t.setSelectorByType(t.type_chattab),t.mark(t.currentSelector,t.currentPlayernameObject,s)),a=a+1}),a},setCounter:function(e,t){this.setPartnerId(e),$('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages",t),this.updateNewMarker()},toggle:function(e,t,a,n){this.setPartnerId(a),this.currentCount=parseInt($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages")),e===this.action_add&&this.updateNewMarker(),e===this.action_remove&&this.removeNewMarker()},mark:function(e,t,a){$('.playerlist_item[data-playerid="'+this.currentPartnerId+'"] .playername').css("font-weight","bold"),$('.cb_playername[data-playerid="'+this.currentPartnerId+'"]').css("font-weight","bold")},addNewMarker:function(){var e=!1;$(this.currentSelector).find(".newMsgMarker").length||(this.mark(this.currentSelector,this.currentPlayernameObject,this.currentCount),e=!0),$(this.currentListItemSelector).find(".newMsgMarker").length||(this.mark(this.currentListItemSelector,this.currentListPlayernameObject,this.currentCount),e=!0),e||this.updateNewMarker()},removeNewMarker:function(){$('.playerlist_item[data-playerid="'+this.currentPartnerId+'"] .playername').css("font-weight","normal"),$('.cb_playername[data-playerid="'+this.currentPartnerId+'"]').css("font-weight","normal")},updateNewMarker:function(){var e=parseInt($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages")),t=$(".new_msg_count.totalChatMessages").text(),a=ogame.chat.updateTotalNewChatCounter();e===0?isNaN(this.currentPartnerId)?$(".new_msg_count.totalMessages.news").text(e).addClass("noMessage"):($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').text(e).addClass("noMessage"),a===0?$(".new_msg_count.totalChatMessages").text(a).addClass("noMessage"):t!=a&&$(".new_msg_count.totalChatMessages").text(a).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500)):isNaN(this.currentPartnerId)?isNaN(e)?$(".new_msg_count.totalMessages.news").text(0).addClass("noMessage"):$(".new_msg_count.totalMessages.news").text(e).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500):($('.msg[data-playerid="'+this.currentPartnerId+'"]').addClass("msg_new"),$('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').text(e).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500),t!=a&&$(".new_msg_count.totalChatMessages").text(a).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500))},setSelectorByType:function(e){selector="",e==this.type_chatbar&&(selector='ul.chat_bar_list li.chat_bar_list_item[data-playerid="'+this.currentPartnerId+'"]'),e==this.type_chattab&&(selector='ul#chatMsgList li.msg[data-playerid="'+this.currentPartnerId+'"]'),this.currentListItemSelector='.js_playerlist ul.playerlist li.playerlist_item[data-playerid="'+this.currentPartnerId+'"]',this.currentSelector=selector,this.currentPlayernameObject=$(selector).find(".cb_playername"),this.currentListPlayernameObject=$(this.currentListItemSelector).find(".playername")},setPartnerId:function(e){this.currentPartnerId=e}};ogame.messages={data:{initActions:{"tabs-nfFleets":"initTabFleets","tabs-nfCommunication":"initTabCommunication","subtabs-nfCommunicationMessages":"initSubTabMessages"}},addMessage:function(e,t,a){if(a!==!1&&(a=!0),e.attr("aria-selected")!=="true"){console.warn("addMessage: not correct Tab, aria-selected = ",e.attr("aria-selected"),e);return}if(!t){console.warn("addMessage: msgData is ",t);return}var n=$("#"+e.attr("aria-controls")).find(".tab_inner"),r=!1;a&&(r=!0),ogame.messages.createMessageItem(t,n,r)},createMessageItem:function(e,t,a){var n={};for(var r in e){var s=e[r];n[r]=s.msgID}var d=JSON.stringify(n);$.ajax({url:"?page=messages",type:"POST",dataType:"html",data:{messageId:d,tabid:this.getCurrentMessageTab(),action:121,ajax:1},success:function(c){if(a)t.prepend(c);else{var o=t.find(".favoriteCount");o.length>0?$(c).insertBefore(o):t.append(c)}},error:function(c,o,l){}})},createBroadcastMsgItem:function(e){if(!e){console.warn("createMessageItem: msgData is missing!");return}var t=$('<div class="msg_head"></div>');t.append('<span class="msg_title blue_txt">'+e.title+"</span>"),t.append('<span class="msg_date fright">'+e.date+"</span><br>"),t.append('<span class="msg_sender_label">'+loca.LOCA_WRITE_MSG_FROM+": </span>"),t.append('<span class="msg_sender">'+e.senderName+"</span>");var a=$('<div class="msg_actions clearfix"></div>');a.append('<a class="fright txt_link overlay" href="'+e.detailURL+'" data-overlay-title="'+loca.broadcasts+'">'+loca.details+"</a>"),a.append('<a class="fright txt_link comments_link overlay" href="'+e.commentsURL+'" data-overlay-title="'+loca.broadcasts+'">'+e.commentsCount+' <span class="comments"></span></a></a>');var n=$('<li class="msg '+e.newClass+'" data-msg-id="'+e.msgID+'"></li>');return n.append('<div class="msg_status"></div>'),n.append(t),n.append('<span class="msg_content">'+e.msgContent+"</span>"),n.append(a),n},createRecipient:function(e,t,a){var n,r;if($(".input_replacement").each(function(){r=new RegExp($(this).data("recipient-cat")),r.test(t)&&(n=$(this))}),n!==void 0){var s=n.children(".recipient_txt").filter(function(){return $(this).data("recipient-id")===e});s.length===0&&(n.hasClass("focus")||n.addClass("focus"),n.append('<div class="recipient_txt" data-recipient-id="'+e+'" data-recipient-cat="'+t+'">'+a+'<a role="button" class="remove_recipient"></a></div>'))}},doInitAction:function(e){return typeof ogame.messages[ogame.messages.data.initActions[e]]=="function"?ogame.messages[ogame.messages.data.initActions[e]]():console.warn("These is no function defined for action: ",e)},initCombatReportDetails:function(){$("select").length>0&&$("select").ogameDropDown()},initDetailMessages:function(e){$(".detail_list_el:nth-of-type(4n + 3), .detail_list_el:nth-of-type(4n + 4)").addClass("odd");var t=$(window).height()-200;$(".detail_msg_ctn").css("height",t),$(".detail_msg_ctn").mCustomScrollbar({theme:"ogame"}),e&&($("#scrollToComments").on("click",function(){$(".detail_msg_ctn").mCustomScrollbar("scrollTo","bottom")}),initBBCodeEditor(locaKeys,itemNames,!1,".comment_textarea",2e3)),$("#messages ul.pagination").on("click","li.p_li a",function(){var a=$(this).data("tabid"),n=$(this).data("messageid");console.log("initDetailMessages()"),$.post("?page=messages",{tabid:a,messageId:n,ajax:1},function(r){$(r).find("#messages .ui-dialog"),$(".overlayDiv").html(r)})})},initMessages:function(){$(".js_tabs .tabs_btn_img").each(function(){$(this).attr("rel")&&$(this).attr("href",$(this).attr("rel"))}),ogame.messages.initTabs($(".js_tabs"));var e=ogame.messages.getCurrentMessageTab();$("#contentWrapper #buttonz div.js_tabs.tabs_wrap.ui-tabs").on("click","ul li.list_item",function(){ogame.messages.getCurrentMessageTab()}),$("body").on("click",".msg_actions .icon_not_favorited",function(t){var a=$(this).parents("li.msg").data("msg-id")||$(this).parents("div.detail_msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:e,messageId:a,action:101,ajax:1},success:function(n){if(n[a].result==!0){$(t.target).removeClass("icon_not_favorited").addClass("icon_favorited"),changeTooltip($(t.target),loca.DELETE_FAV);var r=$(".favoriteTabFreeSlotCount");r.html(parseInt(r.html())-1)}else n[a].reason!=="undefined"?fadeBox(n[a].reason,1):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".msg_actions .icon_favorited",function(t){var a=$(this).parents("li.msg").data("msg-id")||$(this).parents("div.detail_msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:e,messageId:a,action:102,ajax:1},success:function(n){if(n[a].result==!0){$(t.target).removeClass("icon_favorited").addClass("icon_not_favorited"),changeTooltip($(t.target),loca.ADD_FAV);var r=$(".favoriteTabFreeSlotCount");r.html(parseInt(r.html())+1)}else n[a].reason!=="undefined"?fadeBox(n[a].reason,1):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".js_actionKill",function(t){var a=$(this).parents("li.msg").data("msg-id");console.log(a),console.log("this is the message id"),$.ajax({type:"POST",url:"",dataType:"json",data:{messageId:a,action:103,ajax:1},success:function(n){n[a]==!0?$(t.target).parents("li.msg").remove():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".js_actionKillAll",function(t){console.log(ogame.messages.getCurrentMessageTab())}).on("click",".js_actionKillDetail",function(t){var a=$(".overlayDiv .detail_msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{messageId:a,action:103,ajax:1},success:function(n){n[a]==!0?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".js_actionRevive",function(t){var a=$(this).parents("li.msg").data("msg-id");a===void 0&&(a=$(this).parents("div.detail_msg").data("msg-id")),$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:e,messageId:a,action:104,ajax:1},success:function(n){n[a]==!0?($(t.target).parents("li.msg").remove(),$(t.target).parents("div.ui-dialog").remove(),$("li.msg[data-msg-id="+a+"]").remove()):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".js_actionReviveAll",function(t){$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,action:104,ajax:1},success:function(a){a.result==!0?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".js_actionDelete",function(t){var a=$(this).parents("li.msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:e,messageId:a,action:105,ajax:1},success:function(n){n[a]==!0?$(t.target).parents("li.msg").remove():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".js_actionDeleteAll",function(t){$(this).parents("li.msg").data("msg-id"),$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,action:105,ajax:1},success:function(a){a.result==!0?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})}).on("click",".paginator",function(t){var a=$(this).data("tab"),n=$(this).data("page"),r=$(this).closest('div[class^="ui-tabs-panel"]');$.ajax({type:"POST",url:"?page=messages",dataType:"html",data:{messageId:-1,tabid:a,action:107,pagination:n,ajax:1},success:function(s){r.html(s)},error:function(){}})}).on("click",".jumpToAllianceApplications",function(t){location.href="index.php?page=alliance&tab=applications"})},selectCurrentMessageTab:function(){var e=$(".subtabs .ui-state-active:visible");return e.length||(e=$(".js_tabs .ui-state-active:visible")),e},getCurrentMessageTab:function(){var e=$(".subtabs .ui-state-active:visible").attr("data-tabid");return e||(e=$(".js_tabs .ui-state-active:visible").attr("data-tabid")),e},getCurrentEarliestMessage:function(){return $(".ui-tabs-panel .tab_inner .msg:visible").last().attr("data-msg-id")},initCommentForm:function(){ogame.messages.initWriteNewMsgBox($("#newCommentForm")),$("#newCommentForm").on("click",".js_send_comment",function(e){e.preventDefault();var t=$(this).closest("form"),a=t.find("input[name=messageId]").val();$.ajax({type:"POST",url:t.attr("action"),dataType:"json",data:{messageId:a,ajax:1,action:108,text:t.find("textarea[name=text]").val()},success:function(n){fadeBox(n.message,n.error),t.find("textarea[name=text]").val(""),t.parent().after('<li class="msg"><div class="msg_status"></div><div class="msg_head">'+n.commentheader+'</div><div class="msg_content">'+n.commentcontent+"</div></li>"),$("#scrollToComments").text(n.commentcount)},error:function(n){}})})},initShareReportOverlay:function(){ogame.messages.initWriteNewMsgBox($("#newSharedReportForm")),$("#newSharedReportForm").on("click",".js_send_msg_share",function(e){e.preventDefault();var t=$(this).closest("form"),a=t.find("input[name=messageId]").val(),n=t.find("li.select2-selection__choice"),r=[];n.each(function(){r.push($(this).attr("title"))}),$.ajax({type:"POST",url:t.attr("action"),dataType:"json",data:{messageId:a,empfaenger:r,ajax:1,action:106,text:t.find("textarea[name=text]").val()},success:function(s){fadeBox(s.message,s.error),t.closest('div[class^="overlayDiv"').remove()},error:function(s){}})})},initSubTabMessages:function(){$(".js_accordion").accordion({collapsible:!0,heightStyle:"content",active:!1}),ogame.messages.initWriteNewMsgBox($("#newMsgForm")),$("html").off(".subtabmessages"),$("#newMsgForm").on("click.subtabmessages",".js_send_msg",function(e){e.preventDefault();var t=$(this).parents("form"),a={};$(".input_replacement").children().each(function(){typeof a[$(this).data("recipient-cat")]>"u"&&(a[$(this).data("recipient-cat")]=[]),a[$(this).data("recipient-cat")].push($(this).data("recipient-id"))}),$.ajax({type:"POST",url:t.attr("action"),dataType:"json",data:{empfaenger:a,text:t.find(".new_msg_textarea").val()},success:function(n){fadeBox(n.message,n.error),n.error||ogame.messages.sendSubtabMsg($(".new_msg_textarea").val(),a)},error:function(){}})})},initTabCommunication:function(){console.info("-------------initTabCommunication"),ogame.messages.initTabs($(".js_subtabs_communication"))},initTabFleets:function(){console.info("-------------initTabFleets"),ogame.messages.initTabs($(".js_subtabs_fleets"),ogame.messages.initTrash)},initTabs:function(e,t){e.tabs({beforeLoad:function(){$(".ajax_load_shadow").show()},load:function(a,n){console.info("load",n.tab.attr("id")),ogame.messages.doInitAction(n.tab.attr("id")),$(".ajax_load_shadow").hide(),typeof t=="function"&&t(n.tab)},create:function(a,n){ogame.messages.doInitAction(n.tab.attr("id"))}})},initTrash:function(e){e&&($(".js_active_tab").html(e.data("subtabname")),e.attr("id")==="subtabs-nfFleetTrash"?($(".trash_box").addClass("trash_open"),$(".in_trash").show(),$(".not_in_trash").hide()):($(".trash_box").removeClass("trash_open"),$(".in_trash").hide(),$(".not_in_trash").show()))},initWriteNewMsgBox:function(e){initBBCodeEditor(locaKeys,itemNames,!1,".new_msg_textarea",2e3),$("html").off(".writeNewMsgBox"),$("html").on("click.writeNewMsgBox",function(t){$(".new_msg_label").hasClass("open")&&$(t.target).parents(".recipient_select_box").length<1&&($(".input_replacement").removeClass("focus"),$(".new_msg_label").removeClass("open"),$(".new_msg_label").siblings(".recipient_select_box").hide())}),e.on("click.writeNewMsgBox",".input_replacement",function(t){t.stopPropagation(),ogame.messages.toggleRecipientSelectBox($(t.target).data("recipient-cat"))}).on("click.writeNewMsgBox",".new_msg_label",function(t){t.stopPropagation(),ogame.messages.toggleRecipientSelectBox($(t.currentTarget).data("recipient-cat"))}).on("click.writeNewMsgBox",".recipient_select_box .ally_rank",function(){ogame.messages.toggleRecipientSelection($(this))}).on("click.writeNewMsgBox",".remove_recipient",function(){ogame.messages.removeRecipient($(this).closest(".recipient_txt").data("recipient-id"))})},removeRecipient:function(e){$(".ally_rank").filter(function(){$(this).data("recipient-id")===e&&$(this).removeClass("selected")}),$(".recipient_txt").filter(function(){$(this).data("recipient-id")===e&&$(this).remove()})},sendSubtabMsg:function(e,t){if(!e){console.warn("sendSubtabMsg: msg was empty");return}if(!t){console.warn("sendSubtabMsg: msg had no recipients");return}var a={};a.date=getFormatedDate(serverTime.getTime(),"[d].[m].[Y] <span>[H]:[i]:[s]</span>"),a.newClass="msg_new",a.title=t,a.senderName="100011",a.msgID="111",a.msgContent=e,a.commentsURL="",a.detailURL="",a.commentsCount=0;var n=array(a);ogame.messages.addMessage($("#subtabs-nfCommunicationMessages"),n)},toggleRecipientSelectBox:function(e){$(".input_replacement").filter(function(){$(this).data("recipient-cat")===e&&!$(this).hasClass("focus")&&$(this).addClass("focus")}),$(".new_msg_label").filter(function(){var t=$(this);if(t.data("recipient-cat")===e)if(t.hasClass("open"))t.removeClass("open").siblings(".recipient_select_box").hide();else{var a=t.siblings(".recipient_select_box"),n=a.find(".scroll_box");$(".new_msg_label").removeClass("open").siblings(".recipient_select_box").hide(),t.addClass("open"),a.show(),n.hasClass("mCustomScrollbar")?n.mCustomScrollbar("update"):n.mCustomScrollbar()}})},toggleRecipientSelection:function(e){var t=e.data("recipient-cat"),a=e.data("recipient-id");if(!e.hasClass("always_selected")){if(e.hasClass("complete_ally")){ogame.messages.toggleSelectAllRecipients(t);return}e.hasClass("selected")?ogame.messages.removeRecipient(a):(ogame.messages.createRecipient(a,t,e.html()),e.addClass("selected"))}},toggleSelectAllRecipients:function(e){var t=$(".complete_ally").hasClass("selected"),a=t?"255":"1",n=t?"loca.founder":"loca.completeAlliance";$(".input_replacement").children().remove(),ogame.messages.createRecipient(a,e,n),$(".recipient_list").filter(function(){$(this).data("recipient-cat")===e&&$(this).find(".ally_rank").each(function(){$(this).hasClass("always_selected")||(t?$(this).removeClass("selected"):$(this).addClass("selected"))})})}};ogame.messages.combatreport={data:[{combatReportId:$(".detailReport").attr("data-combatreportid")}],loca:[{weapon:"",shield:"",cover:""}],getCombatValueByCombatMember:function(){var e=ogame.messages.combatreport,t=e.data.activeMember,a={armorPercentage:0,weaponPercentage:0,shieldPercentage:0},n=0;return $.each(e.data.combatArray,function(r,s){e.check(!0,t,{values:{is:{0:"all"}}})?(a.armorPercentage+=s.armorPercentage,a.weaponPercentage+=s.weaponPercentage,a.shieldPercentage+=s.shieldPercentage,n++):s.ownerName==t&&(a.armorPercentage=s.armorPercentage,a.weaponPercentage=s.weaponPercentage,a.shieldPercentage=s.shieldPercentage,n=1)}),a.armorPercentage=Math.round(a.armorPercentage/n),a.weaponPercentage=Math.round(a.weaponPercentage/n),a.shieldPercentage=Math.round(a.shieldPercentage/n),a},setCombatValue:function(){var e=ogame.messages.combatreport,t=e.getCombatValueByCombatMember();$("."+e.data.combatside+"Weapon").text(e.loca.weapon+" "+t.weaponPercentage+"%"),$("."+e.data.combatside+"Shield").text(e.loca.shield+" "+t.shieldPercentage+"%"),$("."+e.data.combatside+"Cover").text(e.loca.cover+" "+t.armorPercentage+"%")},setCombatLoca:function(e,t,a){var n=ogame.messages.combatreport;n.loca.weapon=e,n.loca.shield=t,n.loca.cover=a},isActive:function(e,t){var a=ogame.messages.combatreport;for(var n in t)if(n!="length"&&a.check(!0,t[n][e]))return"on";return a.check(!0,t[e])?"on":"off"},setActiveFlag4Fleet:function(e,t){var a=ogame.messages.combatreport,n=a.getAllShipClasses(e);$.each(n,function(r,s){var d=a.getShipIdByClass(s),c=a.isActive(d,t),o=a.getShipSelectors(d);if(a.changeShipState(c,o.ship),c=="off"){var l=o.shipCount,f=o.loss,h={ships:{},losses:{}};h.ships[l]=0,h.losses[f]="",a.setShipCount(h)}a.toggleShipShowState(o.ship)})},search4Class:function(e,t){for(var a in e)if($("."+e[a]+t)[0]){var n=e[a]+t;return n}return!1},getShipSelectors:function(e){var t=ogame.messages.combatreport,a=["military","civil","defense"],n=t.search4Class(a,e),r="."+t.data.combatside+" ."+n,s="."+t.data.combatside+" ."+n+" .ecke",d="."+t.data.combatside+" ."+n+" .lost_ships",c={ship:r,shipCount:s,loss:d};return c},getShipIdByClass:function(e){var t=e.length,a=e.substr(t-3);return a},changeShipState:function(e,t){$(t).hasClass("off")&&e!="off"&&$(t).removeClass("off"),$(t).hasClass("on")&&e!="on"&&$(t).removeClass("on"),$(t).hasClass(e)||$(t).addClass(e)},toggleShipShowState:function(e){$(e).hasClass("off")&&$(e).parent().hide(),$(e).hasClass("on")&&$(e).parent().show()},getShipsByMembers:function(e){var t=ogame.messages.combatreport,a=[];return t.check(!0,t.data.combatArray.shipDetails)?typeof a[t.data.combatArray.ownerName]<"u"?$.extend(a[t.data.combatArray.ownerName],t.data.combatArray.shipDetails):a[t.data.combatArray.ownerName]=t.data.combatArray.shipDetails:$.each(t.data.combatArray,function(n,r){typeof r=="object"&&typeof r.shipDetails<"u"?typeof a[r.ownerName]<"u"?$.extend(a[r.ownerName],r.shipDetails):a[r.ownerName]=r.shipDetails:typeof a[r.ownerName]>"u"&&(a[r.ownerName]={})}),e=="all"?a:a[e]},getShipsByMembersAndCoords:function(e,t,a){var n=ogame.messages.combatreport,r=[];return n.check(!0,n.data.combatArray.shipDetails)?typeof r[n.data.combatArray.ownerName]<"u"?$.extend(r[n.data.combatArray.ownerName],n.data.combatArray.shipDetails):r[n.data.combatArray.ownerName]=n.data.combatArray.shipDetails:$.each(n.data.combatArray,function(s,d){t!==0?typeof d=="object"&&typeof d.shipDetails<"u"&&d.ownerCoordinates===t&&d.ownerName==e&&d.ownerPlanetType==a&&(typeof r[d.ownerName]<"u"?$.extend(r[d.ownerName],d.shipDetails):r[d.ownerName]=d.shipDetails):typeof d=="object"&&typeof d.shipDetails<"u"&&(typeof r[d.ownerName]<"u"?$.extend(r[d.ownerName],d.shipDetails):r[d.ownerName]=d.shipDetails)}),e=="all"?r:r[e]},getShipCountArray:function(e,t){var a=ogame.messages.combatreport,n=!a.check(!0,t,{types:{0:"isEmpty"}}),r={},s={};for(var d in e){var c=a.getShipSelectors(d),o=c.shipCount;if(r[o]=parseInt(e[d]),!n){var l=c.loss;a.check(!0,t[d])&&(s[l]=parseInt(t[d]))}}var f={ships:r,losses:s};return f},setShipCount4All:function(e){var t=ogame.messages.combatreport,a=e.ships,n=t.check(!0,e.losses)?e.losses:{},r={};for(var s in a){var d=a[s],c=t.check(!0,n,{types:{0:"isEmpty"}})&&t.check(!0,n[s])?n[s]:{};r[s]=t.getShipCountArray(d,c)}var o={},l={};for(var f in r){var h=r[f].ships,u=r[f].losses;for(var p in h)t.check(!0,o[p])?o[p]=o[p]+h[p]:o[p]=h[p];for(var p in u)t.check(!0,l[p])?l[p]=l[p]+u[p]:l[p]=u[p]}var m={ships:o,losses:l};t.setShipCount(m)},setShipCountByActiveMember:function(e,t,a,n,r){n=n||0,r=r||1;var s=ogame.messages.combatreport,d={},c={};for(var o in t){var l=t[o].ownerName,f=t[o].ownerCoordinates,h=t[o].ownerPlanetType;if(l==a){for(var u in e.ships[o])n!==0?n==f&&r==h&&(d.hasOwnProperty(u)?d[u]=d[u]+e.ships[o][u]:d[u]=e.ships[o][u]):d.hasOwnProperty(u)?d[u]=d[u]+e.ships[o][u]:d[u]=e.ships[o][u];if(s.check(!0,e.losses))for(var u in e.losses[o])n!==0?n==f&&r==h&&(c.hasOwnProperty(u)?c[u]=c[u]+parseInt(e.losses[o][u]):c[u]=parseInt(e.losses[o][u])):c.hasOwnProperty(u)?c[u]=c[u]+parseInt(e.losses[o][u]):c[u]=parseInt(e.losses[o][u])}}if(s.check(!0,d,{types:{0:"isEmpty"}})){var p=s.getShipCountArray(d,c);s.setShipCount(p)}},setShipCount:function(e){var t=ogame.messages.combatreport.data.combatside,a=e.ships,n=e.losses;if($.isEmptyObject(a))$("."+t+" .ecke").text("0");else for(var r in a)$(r).text(a[r].toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."));if($.isEmptyObject(n))$("."+t+" .lost_ships").text("-");else for(var r in n)$(r).text("-"+n[r].toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))},getAllShipClasses:function(e){var t=e.map(function(){var n=$(this).attr("class");return n}).get().join(),a=[];return $.each(t.split(","),function(n,r){var s=r.split(" ");a.push(s[1])}),a},displayShipData:function(e,t,a,n,r,s){r=typeof r<"u"?r:0;var d=ogame.messages.combatreport;d.check(!0,e,{values:{isNot:{0:"all"}}})?d.setShipCountByActiveMember(a,n,e,r,s):d.setShipCount4All(d.data.combatRounds[t][d.data.combatRounds[t].length-1])},initCombatText:function(e){var t=ogame.messages.combatreport,a=e.combatRounds.length-1;$(".combat_round_list .round_id").find("a").removeClass("active"),$(".combat_round_list .round_id[data-round="+a+"]").find("a").addClass("active"),t.loadDataBySelectedRound(e.attackerJSON,e.defenderJSON,a)},setCombatText:function(e,t,a){var n=ogame.messages.combatreport,r=".statistic_attacker",s=".statistic_defender",d=".hits",c=".strength",o=".absorbed",l=0,f=0,h=0,u=0,p=0,m=0;if(n.check(!0,e,{length:a}))for(var g in e)l=l+parseInt(e[g].statistic.hits),f=f+parseInt(e[g].statistic.absorbedDamage),h=h+parseInt(e[g].statistic.fullStrength),u=u+parseInt(t[g].statistic.hits),p=p+parseInt(t[g].statistic.absorbedDamage),m=m+parseInt(t[g].statistic.fullStrength);else l=parseInt(e[a].statistic.hits),f=parseInt(e[a].statistic.absorbedDamage),h=parseInt(e[a].statistic.fullStrength),u=parseInt(t[a].statistic.hits),p=parseInt(t[a].statistic.absorbedDamage),m=parseInt(t[a].statistic.fullStrength);$(r+d).text(l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(r+o).text(f.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(r+c).text(h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(s+d).text(u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(s+o).text(p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(s+c).text(m.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))},setCombatArray:function(e,t){var a=jQuery.extend(!0,{},e),n=ogame.messages.combatreport;n.data.combatside=t,n.data.memberSelection=!1,$("#"+n.data.combatside+"_select_combatreport").find(":selected").length>0&&(n.data.memberSelection=!0),n.data.memberSelection?n.data.activeMember=""+$("#"+n.data.combatside+"_select_combatreport").find(":selected").val():n.data.activeMember=""+$("#"+n.data.combatside+"_select_combatreport").data("memberName"),n.data.activeMember=n.data.activeMember.split("|",1)[0],n.data.combatArray=a.member,n.data.combatRounds=[],n.data.combatRounds[t]=a.combatRounds},setCombatside:function(e){var t=ogame.messages.combatreport;t.data.combatside=e},check:function(e,t,n){var n=n!=null&&typeof n<"u"&&typeof n=="object"?n:!1,r=!1,s=0,d=0,c=0,o=0,l=!1;if(n!=!1){var f=n.values!=null&&typeof n.values<"u"&&typeof n.values=="object"?n.values:{},h=n.types!=null&&typeof n.types<"u"&&typeof n.types=="object"?n.types:{},u=n.length!=null&&typeof n.length<"u"?n.length:!1;if(!jQuery.isEmptyObject(f))for(b in f){var p=f[b];if(b=="is"&&!jQuery.isEmptyObject(p))for(var m in p)t!=p[m]&&(s=s+1);if(b=="isNot"&&!jQuery.isEmptyObject(p))for(var g in p)t==p[g]&&(s=s+1)}if(!jQuery.isEmptyObject(h)){h.isEmpty&&jQuery.isEmptyObject(t)&&(d=d+1);for(var b in h)typeof t==h[b]&&(d=d+1)}if(typeof t=="object")for(var b in t)typeof t[b]<"u"&&(o=o+1);else{var v=t+"";o=v.length}u!==!1&&typeof u=="number"&&typeof o=="number"&&(o!=u&&(c=c+1),l=!0)}(typeof t>"u"||t==null)&&(d=d+1);var _=s+d;l!=!1&&(_=_+c),_==0&&(r=!0);var C={success:r,allErrors:_,valueErrors:s,typeErrors:d,type:typeof t,length:o,lengthChecked:l,lengthError:c};return e?r:C},loadData:function(e,t){var a=ogame.messages.combatreport;a.setCombatArray(e,t),a.loadDataBySelectedCombatMember(e,t),a.setCombatValue()},loadDataBySelectedRound:function(e,t,a){var n=ogame.messages.combatreport,r=parseInt(a),s=$(".attacker .participant_select option:selected").val(),d=$(".defender .participant_select option:selected").val(),c=$(".attacker .participant_select option:selected").data("coords"),o=$(".defender .participant_select option:selected").data("coords"),l=[],f=[];if(typeof c<"u"?(ids=s.split("|")[1].split(":"),l.push(ids),s=s.split("|")[0]):s!="all"&&typeof s<"u"?(c=0,$(".attacker .participant_select option").each(function(){s==$(this).val().split("|")[0]&&typeof $(this).val().split("|")[1]<"u"&&l.push($(this).val().split("|")[1].split(":"))})):l=[],typeof o<"u"?(ids=d.split("|")[1].split(":"),f.push(ids),d=d.split("|")[0]):d!="all"&&typeof d<"u"?(o=0,$(".defender .participant_select option").each(function(){d==$(this).val().split("|")[0]&&typeof $(this).val().split("|")[1]<"u"&&f.push($(this).val().split("|")[1].split(":"))})):f=[],l.length>0){for(var h in e)if(h=="combatRounds"){for(var u in e[h][r])if(u=="ships")for(var p in e[h][r][u]){var m=$.inArray(p,l[0]);m==-1&&delete e[h][r][u][p]}}}if(f.length>0){for(var h in t)if(h=="combatRounds"){for(var u in t[h][r])if(u=="ships")for(var p in t[h][r][u]){var m=$.inArray(p,f[0]);m==-1&&delete t[h][r][u][p]}}}var g=e.combatRounds,b=t.combatRounds;n.check(!0,g,{length:a})&&(r=r-1),r=r+"",n.setCombatside("attacker"),n.setShipCount4All(g[r]),n.setCombatside("defender"),n.setShipCount4All(b[r]),n.data.memberSelection,n.setCombatText(g,b,a)},resetDropDowns:function(){$("#attacker_select_combatreport").val("all").ogameDropDown("refresh"),$("#defender_select_combatreport").val("all").ogameDropDown("refresh")},loadDataBySelectedCombatMember:function(e,t,a,n){var r=jQuery.extend(!0,{},e);a=a||0,n=n||1;var s=ogame.messages.combatreport;s.setCombatArray(r,t);var d=$("."+s.data.combatside+" .buildingimg"),c=$("."+s.data.combatside+" .defenseimg");d=$.merge(d,c);var o=s.getShipsByMembersAndCoords(s.data.activeMember,a,n);s.setActiveFlag4Fleet(d,o),s.displayShipData(s.data.activeMember,s.data.combatside,r.combatRounds[r.combatRounds.length-1],r.member,a,n),s.setCombatValue()}};function removeTooltip(e){var t=$(e);t.each(function(){$(this).data("tooltipLoaded")&&($(this).data("tooltipLoaded",!1),Tipped.remove($(this)[0]))})}function getTooltipOptions(e){var t=$(e),a={skin:"cloud",maxWidth:400,closeButton:!1,hideOn:[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseenter"}]};return window.location.href.indexOf("galaxy")!==-1&&(a.maxWidth=400),t.hasClass("tooltipPremium")&&(a.skin="premium"),t.hasClass("tooltipLeft")?a.hook={target:"leftmiddle",tooltip:"righttop"}:t.hasClass("tooltipRight")?a.hook={target:"rightmiddle",tooltip:"lefttop"}:t.hasClass("tooltipBottom")&&(a.hook={target:"bottommiddle",tooltip:"topmiddle"}),t.data("tooltip-width")&&(a.maxWidth=t.data("tooltip-width")),(isMobile||t.hasClass("tooltipClose"))&&(a.hideOthers=!0,a.hideOn=!1),a.afterUpdate=function(n,r){if(isMobile&&t.data("tooltip-button")){var s=$(document.createElement("div")).addClass("tooltipButton");$(document.createElement("a")).addClass("btn_blue").attr("href","javascript:void(0);").html(t.data("tooltip-button")).bind("click",function(c){$(r).not("a")&&$(r).find("a").length&&(r=$(r).find("a")[0]);var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(o)}).appendTo(s),$(n).append(s)}if(isMobile||t.hasClass("tooltipClose")){var d=$(document.createElement("div")).addClass("close-tooltip");$(n).prepend(d)}Tipped.refresh(r)},a}function getTooltipSelector(e){var t=".tooltipPremium, .tooltip, .tooltipRight, .tooltipLeft, .tooltipBottom, .tooltipClose, .tooltipHTML, .tooltipRel, .tooltipAJAX, .tooltipCustom, .markItUpButton a";if(typeof e>"u")e=t;else if(typeof e=="string"&&!e.match(/\.tooltip/)){var a=t.split(", "),n=e;for(i in a)e+=", "+n+" "+a[i]}return e}function sanitizeTooltip(e){return e.replace(/<\s*script/g,"&lt;script")}function initTooltips(e){initTooltipSkins(),e=getTooltipSelector(e);function t(n){var r={},s=n.split("|"),d=$(document.createElement("h1")).html(s[0]),c=$(document.createElement("div")).addClass("splitLine");if(typeof s[2]<"u"&&typeof s[3]<"u"){var o=$(document.createElement("h1")).html(s[2]),l=$(document.createElement("div")).addClass("splitLine");r=$(document.createElement("div")).css("display","none").addClass("htmlTooltip").append(d).append(c).append(s[1]+"</br>").append(o).append(l).append(s[3])}else r=$(document.createElement("div")).css("display","none").addClass("htmlTooltip").append(d).append(c).append(s[1]);return r[0]}removeTooltip(e);function a(n){var r=$(n);if(!r.data("tooltipLoaded")){if(r.data("tooltipLoaded",!0),isMobile&&r.hasClass("js_hideTipOnMobile")){r.attr("title","");return}var s=getTooltipOptions(r);if(r.hasClass("tooltipCustom")&&(s.hideOn!=!1&&(s.hideOn=[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseleave"}]),s.afterUpdate=function(d){$(d).find(".tooltipCustom").each(function(c,o){var l=getTooltipOptions(r);$(this).hasClass("tooltipHTML")?(l.inline=!0,l.hideOthers=!1,Tipped.create(this,t(sanitizeTooltip($(this).attr("title"))),l)):(l.hideOthers=!1,Tipped.create(this,sanitizeTooltip($(this).attr("title")),l))})}),r.hasClass("tooltipHTML")){if(typeof r.attr("title")>"u"||r.attr("title").trim().length==0)return;Tipped.create(r[0],t(sanitizeTooltip(r.attr("title"))),s);return}if(r.hasClass("tooltipRel")){s.inline=!0,Tipped.create(r[0],r.attr("rel"),s);return}if(r.hasClass("tooltipAJAX")){$.get(r.attr("rel"),{},function(d){Tipped.create(r[0],d,s)});return}typeof r.attr("title")>"u"||r.attr("title").trim().length==0||Tipped.create(r[0],sanitizeTooltip(r.attr("title")),s)}}$(document).undelegate(e,"touchstart.tooltipClick").delegate(e,"touchstart.tooltipClick",function(n){if(Tipped.visible(this)){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(r),n.preventDefault(),n.stopPropagation()}}),typeof e=="string"?$(document).undelegate(e,"mouseenter.tooltipLoad touchstart.tooltipLoad").delegate(e,"mouseenter.tooltipLoad touchstart.tooltipLoad",function(n){a(this)}):$(e).each(function(){a(this)})}$(function(){initTooltips()});function initTooltipSkins(){jQuery.extend(Tipped.Skins,{cloud:{border:{size:1,color:[{position:0,color:"#44576b"},{position:1,color:"#2f3b47"}]},background:{color:[{position:0,color:"#303a46"},{position:.49,color:"#242d38"},{position:.81,color:"#10181f"},{position:1,color:"#0d1014"}]},offset:{x:0,y:-1,mouse:{x:-12,y:-12}},stem:{height:6,width:11,offset:{x:5,y:5},spacing:0}},premium:{border:{size:1,color:[{position:0,color:"#000"},{position:1,color:"#000"}]},background:{color:[{position:0,color:"#a3e4f0"},{position:.15,color:"#1cbad7"},{position:1,color:"#0f78b1"}]},offset:{x:0,y:-1,mouse:{x:-12,y:-12}},stem:{height:6,width:11,offset:{x:5,y:5},spacing:0}}})}$(function(){$(".percentSelector").each(function(){PercentSelector.initBar(this)})});var PercentSelector={};PercentSelector.fallbackMode=!1;PercentSelector.initBar=function(bar){if(bar){var $bar=$(bar),height=$bar.innerHeight();$bar.children(".PBcolorGrad").remove(),$bar.children(".PBoverlay").remove();var opcAttr=$bar.attr("onpercentchange");if(opcAttr&&(typeof opcAttr=="function"?$bar.get(0).onpercentchange=opcAttr:typeof opcAttr=="string"&&(/^function/.test(opcAttr)?eval("$bar.get(0).onpercentchange = "+opcAttr):eval("$bar.get(0).onpercentchange = function() {"+opcAttr+"}"))),PercentSelector.fallbackMode?($bar.addClass("fallback"),$bar.append($("<div class='PBfallbackColor'></div>").css("height",height).css("width",$bar.innerWidth()))):($bar.append($("<canvas class='PBoverlay'></canvas>").css("height",height).css("width",$bar.innerWidth())),$bar.append($("<div class='PBcolorGrad'></div>").css("height",height*20).css("top",-(2*height))),PercentSelector.createOverlay($bar)),$bar.attr("percent")!=null){var percent=parseInt($bar.attr("percent"));$bar.attr("percent",100),PercentSelector.setPercent($bar,percent,!0)}if(!bar.isBound){if(!($bar.attr("enabled")&&$bar.attr("enabled").toLowerCase()=="false")){var $bindBar=$bar;document.createTouch==null?($bindBar.bind("mousedown",PercentSelector.handlers.mouseDown),$bindBar.bind("mousemove",PercentSelector.handlers.mouseMove),$bindBar.bind("mouseup",PercentSelector.handlers.mouseUp),$bindBar.bind("mouseout",PercentSelector.handlers.mouseOut)):($bindBar.bind("touchstart",PercentSelector.handlers.touchStart),$bindBar.bind("touchmove",PercentSelector.handlers.touchMove),$bindBar.bind("touchend",PercentSelector.handlers.touchEnd))}bar.isBound=!0}}};PercentSelector.setPercent=function(e,t,a){var n=$(e),r=n.attr("step");if(r?r=parseInt(r):r=1,t=Math.round(t/r)*r,t!=parseInt(n.attr("percent")))if(n.attr("percent",t),PercentSelector.fallbackMode)n.children(".PBfallbackColor").css("width",n.innerWidth()*t/100);else{a?(n.children(".PBcolorGrad").css("-webkit-transition","-webkit-transform 0.6s ease-in"),n.children(".PBcolorGrad").css("-moz-transition","-moz-transform 0.6s ease-in")):(n.children(".PBcolorGrad").css("-webkit-transition","-webkit-transform 0.1s ease-in"),n.children(".PBcolorGrad").css("-moz-transition","-moz-transform 0.1s ease-in"));var s=Math.round(n.children(".PBcolorGrad").outerHeight()*.9*(100-t)/100),d=Math.round(n.children(".PBcolorGrad").innerWidth()*((100-t)/100));a?setTimeout(function(){n.children(".PBcolorGrad").css("-webkit-transform","translate(-"+d+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-moz-transform","translate(-"+d+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-ms-transform","translate(-"+d+"px, -"+s+"px)")},1):(n.children(".PBcolorGrad").css("-webkit-transform","translate(-"+d+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-moz-transform","translate(-"+d+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-ms-transform","translate(-"+d+"px, -"+s+"px)"))}};PercentSelector.setPercentFromPageX=function(e,t,a){var n=$(e),r=t-n.offset().left,s=n.outerWidth(),d=100*r/s;d>100&&(d=100),d<10&&(d=10),d=Math.round(d),PercentSelector.setPercent(e,d,a)};PercentSelector.createOverlay=function(e){var t=$(e);$overlay=t.children(".PBoverlay");var a=$overlay.innerWidth(),n=$overlay.innerHeight(),r=$overlay.get(0);r.width=a,r.height=n;var s=r.getContext("2d"),d=s.createLinearGradient(0,0,0,n);d.addColorStop(0,"rgba(0,0,0,0.05)"),d.addColorStop(1,"rgba(0,0,0,0.3)"),s.fillStyle=d,s.fillRect(0,0,a,n),s.clearRect(3,3,a-6,n-6),d=s.createLinearGradient(0,0,0,n),d.addColorStop(0,"rgba(0,0,0,0.2)"),d.addColorStop(1,"rgba(0,0,0,0.05)"),s.fillStyle=d,s.fillRect(3,3,a-6,n-6);var c=t.attr("step");c||(c=100),s.lineWidth=1;for(var o=a/c,l=a/c,f=0;f*c<100;f+=1){var h=Math.floor(f*c*a/100)-.5;s.beginPath(),s.font="12px serif",s.fillStyle="white",s.strokeStyle="black",s.textAlign="center",s.textBaseline="middle",s.fillText(((f+1)*10).toString(),h+l/2,n/2,o),s.moveTo(h,n),s.lineTo(h,n*.75),s.closePath(),s.stroke()}};PercentSelector.handlers={};PercentSelector.handlers.touchDragging=!1;PercentSelector.handlers.touchStart=function(e){var t=e.originalEvent.touches;t.length>1||(e.preventDefault(),PercentSelector.handlers.touchDragging=!1)};PercentSelector.handlers.touchEnd=function(e){if(touches=e.originalEvent.touches,touches.length==0&&(touches=e.originalEvent.changedTouches),!(touches.length>1)){var t=touches[0].target.parentNode;PercentSelector.setPercentFromPageX(t,touches[0].pageX,!0),t.onpercentchange!=null&&t.onpercentchange($(t).attr("percent")),e.preventDefault()}};PercentSelector.handlers.touchMove=function(e){PercentSelector.handlers.touchDragging=!0;var t=e.originalEvent.touches;t.length>1||(e.preventDefault(),PercentSelector.setPercentFromPageX(t[0].target.parentNode,t[0].pageX))};PercentSelector.handlers.mouseDragging=!1;PercentSelector.handlers.mouseDown=function(e){PercentSelector.handlers.mouseDragging=!0};PercentSelector.handlers.mouseOut=function(e){PercentSelector.handlers.mouseDragging&&(PercentSelector.fallbackMode?e.currentTarget:e.originalEvent.target.parentNode),PercentSelector.handlers.mouseDragging=!1};PercentSelector.handlers.mouseUp=function(e){PercentSelector.handlers.mouseDragging=!1;var t=PercentSelector.fallbackMode?e.currentTarget:e.originalEvent.target.parentNode;PercentSelector.setPercentFromPageX(t,e.pageX,!0)};PercentSelector.handlers.mouseMove=function(e){if(PercentSelector.handlers.mouseDragging){e.preventDefault();var t=PercentSelector.fallbackMode?e.currentTarget:e.originalEvent.target.parentNode;PercentSelector.setPercentFromPageX(t,e.pageX)}};ogame.buddies={initBuddyList:function(){$.tablesorter.addParser({id:"coordinates",is:function(e){return!1},format:function(e){var t=$.trim(e).slice(1,-1).split(":"),a=t[0]*16384+t[1]*32+t[2]*1;return a},type:"numeric"}),$.tablesorter.addParser({id:"commaDigit",is:function(e,t){var a=t.config;return jQuery.tablesorter.isDigit(e.replace(/\./g,""),a)},format:function(e){return jQuery.tablesorter.formatFloat(e.replace(/\./g,""))},type:"numeric"}),$(".content_table").tablesorter({widgets:["zebra"],headers:{0:{sorter:!1},2:{sorter:"commaDigit"},5:{sorter:"coordinates"},6:{sorter:!1}},cssHeader:"ct_sortable_title",cssAsc:"ct_sort_asc",cssDesc:"ct_sort_desc"}),$("#buddylist").off(".buddyList"),$("#buddylist").on("click.buddyList",".deleteBuddy",deleteBuddy),$("#chatContent").on("click.chat_info",".deleteBuddy",deleteBuddy)},initBuddies:function(){$(".zebra tr").mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")}),$(".js_accordion").accordion({collapsible:!0,heightStyle:"content"}),$(".js_tabs").tabs(),$(".js_scrollbar").mCustomScrollbar({theme:"ogame"})}};function countdown(e,t,a){(t==null||t=="")&&(t=2);var n=this;n.countValue=parseInt(a)||-1,n.timestamp=0,n.maxDigits=parseInt(t),n.delimiter=" ",n.approx="",n.showunits=!0,n.zerofill=!1;var r=new Date;n.startTime=r.getTime(),n.startLeftoverTime=parseInt(e),this.getCurrentTimestring=function(){return n.formatTime(n.getLeftoverTime())},this.getLeftoverTime=function(){var s=new Date;return Math.round(n.startLeftoverTime+(s.getTime()-n.startTime)*n.countValue/1e3)},this.formatTime=function(s){return formatTimeWrapper(s,n.maxDigits,n.showunits,n.delimiter,n.zerofill,n.approx)}}function formatTimeWrapper(e,t,a,n,r,s){var d=[];d.week=604800,d.day=86400,d.hour=3600,d.minute=60,d.second=1;var c="";for(var o in d){var l=Math.floor(e/d[o]);t>0&&(l>0||r&&c!="")&&(e=e-l*d[o],c!=""&&(c+=n,l<10&&l>0&&r&&(l="0"+l),l==0&&(l="00")),c+=l+(a?LocalizationStrings.timeunits.short[o]:""),t--)}return e>0&&(c=s+c),c}function simpleCountdown(e,t,a,n){if(typeof e=="object"){var r=this;r.timeHtmlObj=$(e)[0],this.updateCountdown=function(){var s=r.countdownObject.getLeftoverTime(),d=r.countdownObject.getCurrentTimestring();s>0?($("#"+r.timeHtmlObj.id).text(d),typeof n=="string"&&$.isFunction(window[n])?window[n]():$.isFunction(n)&&n()):(timerHandler.removeCallback(r.timer),$("#"+r.timeHtmlObj.id).text(LocalizationStrings.status.ready),typeof a=="string"&&$.isFunction(window[a])?window[a]():$.isFunction(a)&&a())},typeof r.timer<"u"&&timerHandler.removeCallback(r.timer),r.timeHtmlObj&&(r.countdownObject=new countdown(t,3),r.timer=timerHandler.appendCallback(r.updateCountdown),r.updateCountdown())}}function fadeBox$1(e,t,a){t?$("#fadeBoxStyle").attr("class","failed"):$("#fadeBoxStyle").attr("class","success"),$("#fadeBoxContent").html(e),$("#fadeBox").stop(!1,!0).show().fadeOut(1e4,a)}function errorBoxDecision$1(e,t,a,n,r,s,d){var c=getIEVersion()<=9&&(d||!1),o=$("#errorBoxDecision");o.find("#errorBoxDecisionHead").html(e),o.find("#errorBoxDecisionContent").html(t);var l=function(h){h.stopPropagation(),typeof o.data("uiDialog")<"u"&&o.dialog("destroy"),typeof r=="function"&&r(),r=="submit_form"&&$("#planetMaintenanceDelete").submit()},f=function(h){h.stopPropagation(),typeof o.data("uiDialog")<"u"&&o.dialog("destroy"),s=="checkPassword"&&location.reload(),typeof s=="function"&&s()};o.find(".yes, .no").unbind("click"),o.unbind("keydown.yesHandler"),setTimeout(function(){var h=o.find(".yes"),u=o.find(".no");h.unbind("click").bind("click",l).focus().find("#errorBoxDecisionYes").html(a),u.unbind("click").bind("click",f).find("#errorBoxDecisionNo").html(n),c?(h.attr("href","#"),u.attr("href","#")):(h.attr("href","javascript:void(0);"),u.attr("href","javascript:void(0);")),o.bind("keydown.yesHandler",function(p){p.which==KeyEvent.DOM_VK_RETURN&&o.find(".yes").trigger("click")})},100),Tipped.hideAll(),o.dialog({resizable:!1,modal:!0,title:e,close:f,width:400,dialogClass:"errorBox"})}typeof Object.assign!="function"&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var a=arguments[t];if(a!=null)for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e});typeof Number.isInteger!="function"&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&e>-9007199254740992&&e<9007199254740992&&Math.floor(e)===e});if(typeof KeyEvent>"u")var KeyEvent={DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_SEMICOLON:59,DOM_VK_EQUALS:61,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_COMMA:188,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224};(function(e){e.fn.extend({ogameDropDown:function(t){if(e("body.showOldDropdowns").length)return this;function a(c){var o=c.outerHeight(),l=e('.dropdown.currentlySelected[rel="'+c.attr("id")+'"]');if(l.length){var f=Math.min(e(window).innerWidth()+e(window).scrollLeft()-c.width()-3,l.offset().left),h,u=Math.ceil(l.offset().top);u+l.height()+o+e("#siteFooter").outerHeight()>=e(window).innerHeight()+e(window).scrollTop()?h=u-o+1:h=u+l.height()+1,c.css("left",f).css("top",h).css("min-width",l.width())}}var n={destroy:function(){e(this).filter("select.dropdownInitialized").each(function(){var c=e(this);e('.dropdown[rel="'+c.data("dropdownId")+'"]').remove(),e("ul#"+c.data("dropdownId")).remove(),c.removeClass("dropdownInitialized").data("dropdownId","").show()})},hide:function(){e(this).filter("select.dropdownInitialized").each(function(){var c=e('.currentlySelected[rel="'+e(this).data("dropdownId")+'"]');c.find("a").removeClass("hover"),e(".dropdownList#"+c.attr("rel")).hide()})},reposition:function(){e(this).filter("select.dropdownInitialized").each(function(){a(e("#"+e(this).data("dropdownId")))})},refresh:function(){var c=e(this).find("option[selected]");getIEVersion()<999,e('a[class="'+c.attr("class")+'"][rel="'+e(this).data("dropdownId")+'"]').text(c.text())}};if(typeof t=="string")return typeof n[t]=="function"&&n[t].call(this),this;e(this).filter("select:not(.dropdownInitialized)").each(function(){var c=e(this),o="dropdown"+Math.floor(Math.random()*1e3),l=c.find("option[selected]");l.length==0&&(l=c.find("option:first-child"));var f=getIEVersion()<999?"#":"javascript:void(0);",h=e('<a class="'+l.attr("class")+'" data-value="'+l.val()+'" rel="'+o+'" href="'+f+'">'+l.text()+"</a>"),u=e('<span class="dropdown currentlySelected '+c.attr("class")+'" rel="'+o+'"></span>').append(h).width(c.css("width").length?c.css("width"):c.width()).data("selectElement",c);(c.is("[readonly]")||c.is(":disabled"))&&u.addClass("disabled"),c.after(u).hide().addClass("dropdownInitialized").data("dropdownId",o);var p=e('<ul class="dropdown dropdownList" id="'+o+'"></ul>').delegate("a","click",function(g){g.stopPropagation(),h.html(e(this).html()).attr("class",e(this).attr("class")).attr("data-value",e(this).attr("data-value")),p.hide().find("a").removeClass("focus"),e(this).addClass("focus");var b=e(this).attr("data-value");c.val(e(this).attr("data-value")).trigger("change").find('option[value="'+b+'"], option:contains("'+b+'")').trigger("click")});function m(){c.is(c.is("[readonly]")||":disabled")||p.hasClass("initialized")||(p.addClass("initialized"),c.find("option").each(function(){var g=e(this).html();typeof e(this).attr("data-html")<"u"&&(g=e(this).attr("data-html")),typeof e(this).attr("data-html-prepend")<"u"&&(g=e(this).attr("data-html-prepend")+g),typeof e(this).attr("data-html-append")<"u"&&(g+=e(this).attr("data-html-append")),$li=e('<li><a class="'+e(this).attr("class")+'" data-value="'+e(this).val()+'">'+g+"</a></li>"),p.append($li),e(this).is(":selected")&&$li.find("a").addClass("focus")}))}h.bind("focus",function(g){e(".dropdownList").not(p).hide(),e(".dropdown.currentlySelected").removeClass("focus"),e(this).addClass("hover"),u.addClass("focus"),m()}).bind("mousewheel",function(g){m(),e(this).unbind("mousewheel")}).bind("click",function(g){g.preventDefault(),!c.is(c.is("[readonly]")||":disabled")&&(e(".dropdownList").not(p).hide(),e(".dropdown.currentlySelected").removeClass("focus"),u.addClass("focus"),p.is(":hidden")?(e(this).addClass("hover"),m(),a(p),e(window).unbind("resize.dropdown"+o).bind("resize.dropdown"+o,function(){a(p)}),p.show(),p.hasScrollbar()&&p.find("a").css("padding-right",22)):(e(this).removeClass("hover"),e(window).unbind("resize.dropdown"+o),p.hide()))}),e("body").append(p)});var r="",s;function d(c,o){r=c,clearTimeout(s),s=setTimeout(function(){r=""},1500);var l=e(".dropdownList:visible"),f=!1;if(l.length==0){var h=e(".dropdown.currentlySelected.focus");if(h.length)l=e("#"+h.attr("rel")),f=!0;else return}var u=r.toLowerCase(),p=l.find("a").filter(function(){return e(this).attr("data-value").toLowerCase().indexOf(u)==0?!0:e(this).text().trim().toLowerCase().indexOf(u)==0});p.length?(o.preventDefault(),l.find("a").removeClass("focus"),e(p.get(0)).addClass("focus").focus(),f&&p.click()):(clearTimeout(s),r="")}return e(document).undelegate("html","touchstart.dropdown click.dropdown").delegate("html","touchstart.dropdown click.dropdown",function(c){e(c.target).closest(".dropdown").length==0&&(e(".dropdownList").hide(),e(".currentlySelected a").removeClass("hover"),e(".currentlySelected").removeClass("focus"))}).undelegate(".dropdown","mousewheel.dropdown").delegate(".dropdown","mousewheel.dropdown",function(c,o){c.preventDefault();var l=e(c.target).closest(".dropdown"),f;l.hasClass("currentlySelected")?f=e("#"+l.attr("rel")):f=l;var h=e('[rel="'+f.attr("id")+'"] a'),u=f.find("a:focus");u.length==0&&(u=f.find("a.focus")),u.length==0&&(u=f.find('a[data-value="'+h.attr("data-value")+'"]'));var p=u.parent(),m=null,g=Math.abs(o);if(o>0)for(var b=0;b<g;b++){if(p.is(":first-child")){m=p.find("a");break}else m=p.prev().find("a");p=m.parent()}else for(var b=0;b<g;b++){if(p.is(":last-child")){m=p.find("a");break}else m=p.next().find("a");p=m.parent()}if(m!=null)if(p=m.parent(),f.find("a").removeClass("focus"),m.addClass("focus").focus(),f.is(":hidden"))m.click();else{var v=p.position().top;v<0?f.scrollTop(f.scrollTop()+v):v+p.outerHeight()>f.innerHeight()&&f.scrollTop(f.scrollTop()+v+p.outerHeight()-f.innerHeight())}}).undelegate("*","focus.dropdown").delegate("*","focus.dropdown",function(c){e(c.target).closest(".dropdown").length==0&&(e(".currentlySelected a").removeClass("hover"),e(".currentlySelected").removeClass("focus"))}).unbind("keydown.dropdown").bind("keydown.dropdown ",function(c){if(!(e(":focus").length>0&&e(":focus").parents(".dropdown").length==0)){var o=!1,l=e(".dropdownList:visible");if(l.length==0){var f=e(".dropdown.currentlySelected.focus");if(f.length)l=e("#"+f.attr("rel")),o=!0;else return}var h=e('[rel="'+l.attr("id")+'"] a'),u=l.find("a:focus");u.length==0&&(u=l.find("a.focus")),u.length==0&&(u=l.find('a[data-value="'+h.attr("data-value")+'"]'));var p=u.parent(),m=null;if(c.keyCode==KeyEvent.DOM_VK_UP||c.keyCode==KeyEvent.DOM_VK_DOWN||typeof delta<"u")c.keyCode==KeyEvent.DOM_VK_UP?(p.is(":first-child")?m=p.find("a"):m=p.prev().find("a"),p=m.parent()):(p.is(":last-child")?m=p.find("a"):m=p.next().find("a"),p=m.parent()),c.preventDefault();else if(c.keyCode==KeyEvent.DOM_VK_BACK_SPACE)d(r.substring(0,r.length-1),c);else if(c.keyCode==KeyEvent.DOM_VK_RETURN)if(c.preventDefault(),o){h.parents("form").submit();return}else o=!0,m=u;else c.keyCode==KeyEvent.DOM_VK_ESCAPE&&(m=l.find('[data-value="'+h.attr("data-value")+'"]'),o=!0);if(m!=null)if(p=m.parent(),l.find("a").removeClass("focus"),m.addClass("focus").focus(),o)m.click();else{var g=p.position().top;g<0?l.scrollTop(l.scrollTop()+g):g+p.outerHeight()>l.innerHeight()&&l.scrollTop(l.scrollTop()+g+p.outerHeight()-l.innerHeight())}}}).unbind("keypress.dropdown").bind("keypress.dropdown",function(c){e(":focus").length>0&&e(":focus").parents(".dropdown").length==0||c.charCode==0||d(r+String.fromCharCode(c.charCode),c)}),e(this)},selectText:function(){var t,a,n=this[0],r={func:"function",obj:"object"},s=function(d,c){return typeof c===d};return s(r.obj,n.ownerDocument)&&s(r.obj,n.ownerDocument.defaultView)&&s(r.func,n.ownerDocument.defaultView.getSelection)?(a=n.ownerDocument.defaultView.getSelection(),s(r.func,a.setBaseAndExtent)?a.setBaseAndExtent(n,0,n,e(n).contents().size()):s(r.func,n.ownerDocument.createRange)&&(t=n.ownerDocument.createRange(),s(r.func,t.selectNodeContents)&&s(r.func,a.removeAllRanges)&&s(r.func,a.addRange)&&(t.selectNodeContents(n),a.removeAllRanges(),a.addRange(t)))):s(r.obj,document.body)&&s(r.obj,document.body.createTextRange)&&(t=document.body.createTextRange(),s(r.obj,t.moveToElementText)&&s(r.obj,t.select)&&(t.moveToElementText(n),t.select())),this},hasScrollbar:function(){return this.get(0).scrollHeight>this.innerHeight()}})})(jQuery);var TECHID_REPAIR_DOCK=36,burnUpCountDownForStationScreen={},repairTimeDownForStationScreen={};function displayBurnUpEnquiry(){var e=$("input.burnUpButton");errorBoxDecision$1(e.data("loca_box_text"),e.data("loca_decision_text"),e.data("loca_yes"),e.data("loca_no"),function(){$.ajax({url:e.data("url"),success:function(t){var a=jQuery.parseJSON(t);a.success?(fadeBox$1(a.reason,!1,function(){}),redirectSpaceDock()):fadeBox$1(a.reason,!0,function(){})}})},function(){})}function startWreckFieldRepairs(){var e=$("input.startRepairsButton");$.ajax({url:e.data("url"),success:function(t){var a=jQuery.parseJSON(t);a.success?(fadeBox$1(a.reason,!1,function(){}),redirectSpaceDock()):fadeBox$1(a.reason,!0,function(){})}})}function reCommissionShips(){var e=$("input.reCommissionButton");$.ajax({url:e.data("url"),success:function(t){var a=jQuery.parseJSON(t);a.success?(fadeBox$1(a.reason,!1,function(){}),redirectSpaceDock()):fadeBox$1(a.reason,!0,function(){})}})}function registerBurnUpCountDown(e){var t=$(e),a=$(e).data("duration");a>0&&(burnUpCountDownForStationScreen[e]||(burnUpCountDownForStationScreen[e]=new simpleCountdown(t,a,function(){location.reload()})))}function registerRepairTimeCountDown(e){var t=$(e),a=$(e).data("duration");a>0&&(repairTimeDownForStationScreen[e]||(repairTimeDownForStationScreen[e]=new simpleCountdown(t,a,function(){location.reload()})))}$(document).on("click","input.burnUpButton",displayBurnUpEnquiry);$(document).on("click","input.startRepairsButton",startWreckFieldRepairs);$(document).on("click","input.reCommissionButton",reCommissionShips);$(document).on("ajaxShowElement",function(e,t){t==TECHID_REPAIR_DOCK&&(registerBurnUpCountDown("#burnUpCountDownForStationScreen"),registerRepairTimeCountDown("#repairTimeCountDownForStationScreen"))});$(document).on("ajaxShowOverlay",function(e){registerBurnUpCountDown("#burnUpCountDownForRepairOverlay"),registerRepairTimeCountDown("#repairTimeCountDownForRepairOverlay")});new Array("Mon","Tus","Wed","Thu","Fri","Sat","Sun");new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Number.prototype.isBetween=function(e,t){return this>=e&&this<=t};Function.prototype.clone=function(){var e=this,t=function(){return e.apply(this,arguments)};t.prototype=e.prototype;for(var a in e)e.hasOwnProperty(a)&&a!=="prototype"&&(t[a]=e[a]);return t};jQuery.fn.slideFadeToggle=function(e,t,a){return this.animate({opacity:"toggle",width:"toggle"},e,t,a)};function getIEVersion(){var e=999;return navigator.appVersion.indexOf("MSIE")!=-1&&(e=parseFloat(navigator.appVersion.split("MSIE")[1])),e}ogame.tools={addHover:function(e){$(e).on({mouseenter:function(){$(this).addClass("over")},mouseleave:function(){$(this).removeClass("over")}})},scrollToTop:function(){var e=$(".scroll_to_top");$(window).on("scroll.scrollToTop",function(){$(".scroll_to_top").css({visibility:e.offset().top>window.innerHeight?"visible":"hidden"},600)}),e.on("click.scrollToTop",function(){$("body, html").animate({scrollTop:0},600)})}};
